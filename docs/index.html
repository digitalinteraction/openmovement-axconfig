<!doctype html><html lang="en" UNUSED_manifest="cache.appcache"><head><meta charset="utf-8"><title>AX Configure</title><link rel="shortcut icon" type="image/x-icon" href="data:image/x-icon;," _href="icon.ico"><style type="text/css">body,html{height:100%;width:100%}html{font-family:sans-serif;background:#f5f5f5}body{margin:0;display:grid;grid-template-rows:auto fit-content(35vh)}.main{overflow:auto;margin:.5em}fieldset{max-width:40em;margin:.5em auto}.status{font-size:150%;font-weight:700;margin-bottom:1em}#warnings,.main_button,.status,h1{text-align:center}#output::-webkit-scrollbar{width:.5em}#output::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.3)}#output::-webkit-scrollbar-thumb{background-color:#a9a9a9;outline:1px solid #708090}#output{box-shadow:inset 4px 4px 10px #aaa;background:#fff;color:#000;margin-top:1em;font-family:monospace;overflow-y:auto;padding:.3em 0 .3em .3em;border-radius:4px;height:35vh;display:none}body.console #output{display:block}#output p{font-size:14px;font-weight:700;padding:.2em;margin:0}#output p:nth-child(odd){background:linear-gradient(180deg,rgba(51,238,238,.13),rgba(51,238,238,.13) 50%,rgba(51,153,153,.13) 0,rgba(51,153,85,.13));background-size:100% 2px}.button{box-shadow:inset 0 1px 0 0 #bbdaf7;background:linear-gradient(180deg,#79bbff 5%,#378de5);background-color:#79bbff;border-radius:6px;border:1px solid #84bbf3;color:#fff;font-size:15px;padding:10px 20px;text-decoration:none;text-shadow:0 1px 0 #528ecc}.button:hover{background:linear-gradient(180deg,#378de5 5%,#79bbff);background-color:#378de5}.button:active{position:relative;top:2px}.button,.secondary,input[type=file]{display:inline-block;cursor:pointer}.secondary{background-color:initial;border:1px solid transparent;border-radius:5px;color:#000}.secondary:hover{border:1px solid #000}.secondary:active{position:relative;top:2px}.button:disabled,.secondary:disabled,input[type=button]:disabled,input[type=submit]:disabled{background:#ddd;cursor:not-allowed}.button:disabled:hover{background:#ddd}.button:disabled:active{top:0}.link{border:0;color:#000;text-shadow:none;box-shadow:none;text-decoration:underline}.link,.link:active,.link:hover{background:0 0}fieldset,form{margin-bottom:6pt}fieldset{border-radius:6pt}fieldset div{display:flex;vertical-align:bottom;margin-top:.2em;margin-bottom:.2em}fieldset label{margin-left:.5em;width:6em}fieldset input[type=datetime-local],fieldset input[type=file],fieldset input[type=number],fieldset input[type=text],fieldset meter,fieldset output,fieldset select{width:5em;flex-grow:1}#code{font-size:150%}fieldset #battery{flex-grow:1;margin-left:.5em}summary{font-size:small;cursor:pointer}summary:after{content:"..."}footer{color:#777;margin-top:1em}footer div{color:#333;font-size:small;text-align:center}footer a{color:#777;text-decoration:none}.version{color:#777;font-size:small;white-space:nowrap}.link:active,.link:hover,footer a:active,footer a:hover{text-decoration:underline}.disconnected{display:block}.connected,.connected-valid,.device-connected .disconnected{display:none}.device-connected .connected,.device-connected.config-valid .connected-valid,.incomplete{display:block}.complete,.completed .incomplete,.hidden,body.no-configure .complete .main_button,body.no-configure .incomplete,body.nolog .log-span,body.nologclear .log-clear-span{display:none}.completed .complete,body.allow-scan .scan-controls,body.diagnostics-open .diagnostics{display:block}#duration_days,#duration_hours,#duration_minutes,#duration_seconds,.scan-controls{text-align:right}.scan-controls{margin-left:10px;display:none}.scan-controls #start-scan{display:inline}.scan-controls #stop-scan,body .diagnostics,body.scanning .scan-controls #start-scan{display:none}body.scanning .scan-controls #stop-scan{display:inline}#interactive.viewport{position:relative;height:0;transition:height .5s ease-out}body.scanning #interactive.viewport{height:480px}#interactive.viewport>video{max-width:100%;width:100%;z-index:-2}#interactive.viewport>canvas.drawingBuffer{position:absolute;left:0;top:0;z-index:-1;pointer-events:none;display:none}.device-fieldset{display:flex}.device-fieldset .device-status{display:block;flex-grow:1}.diagnostic-controls .button{margin-right:1em}.diagnostic-fieldset textarea{width:100%;height:10em;border:1px solid #000;border-radius:10px;background:0 0}#diagnostic-file-selection{text-wrap:none;word-break:keep-all;width:auto}#diagnostic-file{width:10em}#diagnostic-file::file-selector-button{display:none}</style><link rel="manifest" href="manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="AX Config"><meta name="apple-mobile-web-app-title" content="AX Config"><meta name="msapplication-starturl" content="/"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><script __not__type="module">parcelRequire=function(t,e,n,r){var o,i="function"==typeof parcelRequire&&parcelRequire,a="function"==typeof require&&require;function s(n,r){if(!e[n]){if(!t[n]){var o="function"==typeof parcelRequire&&parcelRequire;if(!r&&o)return o(n,!0);if(i)return i(n,!0);if(a&&"string"==typeof n)return a(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}l.resolve=function(e){return t[n][1][e]||e},l.cache={};var u=e[n]=new s.Module(n);t[n][0].call(u.exports,l,u,u.exports,this)}return e[n].exports;function l(t){return s(l.resolve(t))}}s.isParcelRequire=!0,s.Module=function(t){this.id=t,this.bundle=s,this.exports={}},s.modules=t,s.cache=e,s.parent=i,s.register=function(e,n){t[e]=[function(t,e){e.exports=n},{}]};for(var c=0;c<n.length;c++)try{s(n[c])}catch(t){o||(o=t)}if(n.length){var u=s(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd&&define(function(){return u})}if(parcelRequire=s,o)throw o;return s}({x7XL:[function(t,e,n){"use strict";function r(t){if("object"!=typeof t)return null;const e=60*(new Date).getTimezoneOffset()*1e3;return new Date(t.getTime()-e)}Object.defineProperty(n,"__esModule",{value:!0}),n.sleep=async function(t){return new Promise(e=>setTimeout(e,t))},n.localTime=r,n.localTimeString=function(t,e){const n=r(t);if(null===n)return null;const o=n.toISOString().slice(0,-1);return"d"==e?o.slice(0,-13):"m"==e?o.slice(0,-7):"s"==e?o.slice(0,-4):"S"==e?o.slice(0,-4).replace("T"," "):o},n.localTimeValue=function(t){if("string"!=typeof t||0===t.length)return null;16==t.length&&(t+=":00"),19==t.length&&(t+=".000"),23==t.length&&(t+="Z");const e=60*(new Date).getTimezoneOffset()*1e3;return new Date(new Date(t).getTime()+e)},n.watchParameters=function(t){function e(){const e=new URL(window.location.href),n=e.searchParams,r=new URLSearchParams(e.hash.replace(/^#/,"")),o=[];for(let t of[n,r])for(let e of t.entries())o.push(e);const i={};for(let t of o)i[t[0].toLowerCase()]=t[1];t(i,o)}window.onhashchange=e,e()},n.redirectConsole=function(t,e="P"){function n(t,n,...r){const o=document.querySelector(t),i=r.join(" ");if(!o)return"[pre-DOM] "+i;const a=document.createTextNode(i),s=document.createElement(e);return s.appendChild(a),o.appendChild(s),s.scrollIntoView(!1),i}for(let e of["log","warn","error"]){const r=console[e];console[e]=function(){const o=n(t,e,...arguments);r(o)}}},n.download=function(t,e,n){n=n||"application/octet-binary";const r=document.createElement("A");let o;(e instanceof ArrayBuffer||"string"==typeof e)&&(e=[e]),Array.isArray(e)&&(e=new Blob(e,{type:n})),o=e instanceof Blob?URL.createObjectURL(e):"data:"+n+","+encodeURIComponent(e),r.setAttribute("href",o),r.setAttribute("download",t),r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r)}},{}],yzmp:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=class{constructor(t){this.inputSelector=t,this.inputBuffer="",this.timeoutId=null,this.autoSubmit=!1}setAutoSubmit(t){this.autoSubmit=t}start(t=null,e=null){this.changeCallback=t,document.onkeydown=this.keydown.bind(this);const n=()=>{const e=document.querySelector(this.inputSelector);if(t){const n=e.value;t(n)}},r=document.querySelector(this.inputSelector);r.addEventListener("input",n),r.addEventListener("change",n),r.addEventListener("focus",function(){this.select()}),r.form.onsubmit=t=>{const n=document.querySelector(this.inputSelector);if(t.preventDefault(),n.blur(),!n.form.querySelector("input[type=submit]").disabled&&e){const t=n.value;e(t)}return!1},n()}setValue(t,e=!1){this.inputBuffer="";const n=document.querySelector(this.inputSelector);if(n){if(arguments.length>0&&(console.log("KEYINPUT: "+t),n.value=t),n.dispatchEvent(new Event("change",{bubbles:!0})),e){const t=n.form.querySelector('input[type="submit"]');t&&t.click()}}else console.log("KEYINPUT: Error: element not found: "+this.inputSelector)}submitEnabled(t){document.querySelector(this.inputSelector).form.querySelector("input[type=submit]").disabled=!t}keydown(t){let e=!0;t=t||window.event,this.inputSelector||(e=!1),document.activeElement&&("INPUT"==document.activeElement.tagName&&["text","password","date","email","number","search"].indexOf(document.activeElement.type)>=0&&(e=!1),"TEXTAREA"==document.activeElement.tagName&&(e=!1)),(t.altKey||t.ctrlKey)&&(e=!1),t.which<32&&(this.inputBuffer.length>0&&13==t.which&&(t.preventDefault(),this.setValue(this.inputBuffer,this.autoSubmit)),e=!1),t.key&&1==t.key.length||(e=!1),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),e?(t.preventDefault(),this.inputBuffer+=t.key,this.timeoutId=setTimeout(function(){this.inputBuffer=""}.bind(this),2e3)):this.inputBuffer=""}}},{}],anNG:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;const r=new TextEncoder("windows-1252"),o=new TextDecoder("windows-1252"),i=2,a=10;function s(t){let e=null,n=null;for(let r of t.interfaces)r.alternates[0].interfaceClass==i?e=r.interfaceNumber:r.alternates[0].interfaceClass==a&&(n=r.interfaceNumber);if(null===e)return console.log("WARNING: CDC control interface not found in configuration "+t.configurationValue),null;null===n&&(console.log("NOTE: CDC data interface not found in configuration "+t.configurationValue+" -- will continue and assume malformed CDC using a single interface"),n=e);let r=null;for(let n of t.interfaces[e].alternates[0].endpoints)"in"===n.direction&&"interrupt"===n.type&&(r=n.endpointNumber);if(null===r)return console.log("WARNING: CDC control endpoint not found in configuration "+t.configurationValue),null;let o=null,s=null;for(let i of t.interfaces[n].alternates[0].endpoints)n==e&&i.endpointNumber==r||("in"===i.direction&&"bulk"===i.type?o=i.endpointNumber:"out"===i.direction&&"bulk"===i.type?s=i.endpointNumber:console.log("NOTE: Data endpoint ignored "+i.endpointNumber));return null===o||null===s?(console.log("WARNING: CDC data read/write endpoints not found in configuration "+t.configurationValue),null):{configurationValue:t.configurationValue,control:{interface:e,endpoint:r},data:{interface:n,endpointRead:o,endpointWrite:s}}}function c(t){let e=null;for(let n of t.interfaces)255==n.alternates[0].interfaceClass&&(console.log(JSON.stringify({interfaceClass:n.alternates[0].interfaceClass,interfaceSubclass:n.alternates[0].interfaceSubclass,interfaceProtocol:n.alternates[0].interfaceProtocol,interfaceName:n.alternates[0].interfaceName})),e=n.interfaceNumber);if(null===e)return null;let n=null,r=null;for(let o of t.interfaces[e].alternates[0].endpoints)"in"===o.direction&&"bulk"===o.type&&(n=o.endpointNumber),"out"===o.direction&&"bulk"===o.type&&(r=o.endpointNumber);return null===n||null===r?(console.log("WARNING: Generic data read/write endpoints not found in configuration "+t.configurationValue),null):{configurationValue:t.configurationValue,data:{interface:e,endpointRead:n,endpointWrite:r}}}n.default=class{constructor(t){this.device=t,this.type="usb",this.productName=this.device.productName,this.manufacturerName=this.device.manufacturerName,this.serialNumber=this.device.serialNumber,this.io=null}async open(){try{await this.device.open()}catch(t){throw console.log("ERROR: Problem opening device: "+t,t.name+" -- "+t.message),"file:"==location.protocol&&console.log("NOTE: Hosting from a file: protocol may cause this. Try serving over HTTP."),"SecurityError"==t.name&&navigator.appVersion.indexOf("(Windows")>=0&&console.log('NOTE: The "new" Windows WebUSB back-end may have this issue.'),t}console.log("Determine I/O..."),this.io=null;for(let t of this.device.configurations){if(this.io=c(t),null!==this.io)break;if(this.io=s(t),null!==this.io)break}if(null===this.io)throw console.log("ERROR: No matching configuration found."),"No matching configuration found";console.log("IO FOUND, selecting configuration: "+JSON.stringify(this.io));try{await this.device.selectConfiguration(this.io.configurationValue)}catch(t){throw console.log("ERROR: Problem selecting configuration: "+this.io.configurationValue+" -- "+t),t}console.log("...claiming interfaces...");try{await this.device.claimInterface(this.io.data.interface)}catch(t){throw console.log("ERROR: Problem claiming data interface (could it already be claimed by a driver?): "+this.io.data.interface+" -- "+t),"Could not claim interface (could it already be claimed by a driver?) Please try connecting to serial device instead. Issue: "+this.io.data.interface+" -- "+t}console.log("...USB opened")}async close(){try{await this.device.releaseInterface(this.io.data.interface)}catch(t){console.log("WARNING: Problem releasing data interface: "+this.io.data.interface+" -- "+t)}finally{try{return console.log("...close..."),await this.device.close(),console.log("...closed"),!0}catch(t){return console.log("WARNING: Problem closing device -- "+t),!1}}}async write(t){t.trim().length>0&&(t=("\r"+t.trim()+"\r").padEnd(64,"\r")),console.log("SEND: "+t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"));let e=r.encode(t);console.log("===: "+e);try{await this.device.transferOut(this.io.data.endpointWrite,e)}catch(t){throw console.log("WARNING: Problem writing data: "+this.io.data.endpointWrite+" -- "+e+" -- "+t),t}}async read(){console.log("Read...");let t=null;try{console.log(`...transferIn(${this.io.data.endpointRead})`);let e=await this.device.transferIn(this.io.data.endpointRead,64);if(console.log(`...transferIn() - done (${e.status}): `+e),"stall"===e.status&&(console.log("Endpoint stalled. Clearing."),await this.device.clearHalt("in",this.io.data.endpointRead)),"ok"===e.status)if(e.data&&e.data.byteLength>0){let n=[];for(let t=0;t<e.data.byteLength;t++){let r=e.data.getUint8(t);(r>=128||r<32&&13!=r&&10!=r)&&(e.data.setUint8(t,32),n.push(r))}n.length>0&&console.log(`NOTE: Replaced ${n.length} of ${e.data.byteLength} bytes: ${JSON.stringify(n)}`),t=o.decode(e.data)}else console.log("WARNING: Transfer was ok but no data: "+e.data.byteLength);else console.log("WARNING: Transfer result: "+e.status)}catch(t){return console.log("WARNING: Problem reading data: "+this.io.data.endpointRead+" -- "+t),null}return console.log("RECV: "+(null===t?"<null>":t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"))),t}async cancelRead(){try{return console.log("cancelRead() - "+this.io.data.endpointRead),await this.device.clearHalt("in",this.io.data.endpointRead),console.log("cancelRead() - done"),!0}catch(t){return console.log("WARNING: Problem cancelling read: "+this.io.data.endpointRead+" -- "+t),!1}}isBusy(){return this.device.opened}}},{}],Lo8Z:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;t("./util.mjs");n.default=class{constructor(t){console.dir(t),this.port=t,this.type="serial",console.log("PORT: "+JSON.stringify(this.port)),console.log("PORT properties: "+JSON.stringify(Object.getOwnPropertyNames(this.port))),this.portInfo={},this.port.getInfo?this.portInfo=this.port.getInfo():console.log("WARNING: No .portInfo()"),console.log("PORT INFO: "+JSON.stringify(this.portInfo)),this.productName=this.portInfo.product,this.manufacturerName=this.portInfo.manufacturer,this.serialNumber=this.portInfo.serialNumber,this.openFlag=!1,this.unopenable=!1,this.buffer=[]}internalStartRead(){try{this.reader.read().then(this.internalRead.bind(this))}catch(t){console.log("ERROR: Problem in reader while starting read -- reader may be broken now: "+t)}}internalRead({done:t,value:e}){try{if(console.log("*** "+JSON.stringify({value:e,done:t})),null!=e&&e.length>0&&(console.log("<<< ["+this.buffer.length+"] "+e),this.buffer.push(e)),t)return console.log("READER: Stream end"),this.reader.releaseLock(),void(this.reader=null)}catch(t){console.log("ERROR: Problem in reader while completing read -- reader may be broken now: "+t)}setTimeout(this.internalStartRead.bind(this),0)}async open(){try{if(this.openFlag)throw"Port already open";const t={baudRate:9600};t.baudrate=t.baudRate,await this.port.open(t),this.encoder=new TextEncoderStream,this.outputDone=this.encoder.readable.pipeTo(this.port.writable),this.outputStream=this.encoder.writable,this.writer=null,this.decoder=new TextDecoderStream,this.inputDone=this.port.readable.pipeTo(this.decoder.writable),this.inputStream=this.decoder.readable,this.reader=this.inputStream.getReader(),this.internalStartRead(),this.openFlag=!0,this.unopenable=!1}catch(t){throw this.unopenable=!0,console.log("ERROR: Problem opening serial device: "+t,t.name+" -- "+t.message),t}console.log("...serial opened")}async close(){try{console.log("CLOSE: reader="+(this.reader?JSON.stringify(this.reader):"n/a"));try{this.reader&&await this.reader.cancel()}catch(t){console.log("ERROR: Problem cancelling reader: "+t)}try{await this.inputDone.catch(()=>{})}catch(t){console.log("ERROR: Problem waiting for inputDone: "+t)}this.port.readable.locked&&(console.log("!!! UNEXPECTED: Port readable was still locked -- expected to be released when stream flagged done."),this.reader&&this.reader.releaseLock()),this.reader=null;try{await this.outputStream.getWriter().close(),this.outputStream=null}catch(t){console.log("ERROR: Problem closing writer: "+t)}try{await this.outputDone,this.outputDone=null}catch(t){console.log("ERROR: Problem waiting for outputDone: "+t)}}catch(t){console.log("WARNING: Problem cancelling/unlocking: "+t)}finally{try{return console.log("...close..."),this.port.writable.locked&&console.error("WARNING: Port writable is still locked (will not close)."),await this.port.close(),console.log("...closed"),this.openFlag=!1,!0}catch(t){return console.log("WARNING: Problem closing port -- "+t),!1}}}async write(t){t.trim().length>0&&(t=("\r"+t.trim()+"\r").padEnd(64,"\r")),console.log("SEND: "+t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"));try{this.writer&&console.log("UNEXPECTED: Writer already exists"),this.writer=this.outputStream.getWriter(),await this.writer.write(t)}catch(t){throw console.log("WARNING: Problem writing data: "+t),t}finally{if(this.writer){try{this.writer.releaseLock()}catch(t){console.log("WARNING: "+t)}this.writer=null}}}async read(){console.log("Read... "+this.buffer.length);let t=null;try{for(;this.buffer.length>0;)null===t&&(t=""),t+=this.buffer.shift()}catch(t){return console.log("WARNING: Problem reading serial data: "+t),null}return console.log("RECV: "+(null===t?"<null>":t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"))),t}async cancelRead(){}isBusy(){return!1}}},{"./util.mjs":"x7XL"}],bBqM:[function(t,e,n){"use strict";function r(t){if(0==t)return 0;if(4294967295==t)return-1;const e=2e3+(t>>26&63),n=t>>22&15,r=t>>17&31,o=t>>12&31,i=t>>6&63,a=t>>0&63;try{return new Date(Date.UTC(e,n-1,r,o,i,a))}catch(t){return console.log("WARNING: Invalid date: "+t),null}}function o(t){return(t+32768&65535)-32768}Object.defineProperty(n,"__esModule",{value:!0}),n.parseHeader=function(t){const e={};if(t.byteLength<512)throw new Error("Data too short: "+t.byteLength+" (expected >= 512)");if(t.getUint8(0)!="M".charCodeAt(0)||t.getUint8(1)!="D".charCodeAt(0))throw new Error("Invalid header: "+String.fromCharCode(t.getUint8(0))+String.fromCharCode(t.getUint8(1)));if(e.length=t.getUint16(2,!0),e.length<508)throw new Error("Invalid header length: "+e.length+" (expected >= 512-4)");e.hardwareType=t.getUint8(4),0==e.hardwareType||23==e.hardwareType?e.deviceType="AX3":100==e.hardwareType?e.deviceType="AX6":e.deviceType="?",e.deviceId=t.getUint16(5,!0);const n=t.getUint16(11,!0);65535!=n&&(e.deviceId|=n<<16),e.sessionId=t.getUint32(7,!0),e.loggingStart=r(t.getUint32(13,!0)),e.loggingEnd=r(t.getUint32(17,!0)),e.loggingCapacity=t.getUint32(21,!0),e.flashLed=t.getUint8(26,!0),e.sensorConfig=t.getUint8(35,!0),0!=e.sensorConfig&&255!=e.sensorConfig?e.gyroRange=8e3/2**(15&e.sensorConfig):e.gyroRange=null,e.rateCode=t.getUint8(36,!0),e.frequency=3200/(1<<15-(15&e.rateCode)),e.range=16>>(e.rateCode>>6),e.lastChange=r(t.getUint32(37,!0)),e.firmwareRevision=t.getUint8(41,!0),e.metadataRaw=new TextDecoder("utf-8").decode(t.buffer.slice(64,512));for(let t=e.metadataRaw.length-1;t>=0;t--){const n=e.metadataRaw.charCodeAt(t);if(0!=n&&32!=n&&255!=n){e.metadataRaw=e.metadataRaw.slice(0,t+1);break}if(0==t){e.metadataRaw="";break}}return e},n.parseData=function(t){const e={};if(t.byteLength<512)throw new Error("Data too short: "+t.byteLength+" (expected >= 512)");if(t.getUint8(0)!="A".charCodeAt(0)||t.getUint8(1)!="X".charCodeAt(0))throw new Error("Invalid data header: "+String.fromCharCode(t.getUint8(0))+String.fromCharCode(t.getUint8(1)));if(e.length=t.getUint16(2,!0),508!=e.length)throw new Error("Invalid data length: "+e.length+" (expected >= 512-4)");e.deviceFractional=t.getUint16(4,!0),e.sessionId=t.getUint32(6,!0),e.sequenceId=t.getUint32(10,!0),e.timestampRaw=r(t.getUint32(14,!0)),e.lightRaw=t.getUint16(18,!0),e.light=1023&e.lightRaw,e.temperatureRaw=t.getUint16(20,!0),e.temperature=75*(1023&e.temperatureRaw)/256-50,e.events=t.getUint8(22,!0),e.batteryStored=t.getUint8(23,!0),e.batteryRaw=e.batteryStored+512,e.battery=6e3*e.batteryRaw/1024/1e3,e.rateCode=t.getUint8(24,!0),e.numAxesBPS=t.getUint8(25,!0),e.timestampOffsetRaw=t.getInt16(26,!0),e.sampleCount=t.getUint16(28,!0),e.frequency=3200/(1<<15-(15&e.rateCode)),e.channels=e.numAxesBPS>>4&15,e.bytesPerAxis=15&e.numAxesBPS,0==e.bytesPerAxis&&3==e.channels?e.bytesPerSample=4:e.bytesPerAxis>0&&e.channels>0&&(e.bytesPerSample=e.bytesPerAxis*e.channels),e.samplesPerSector=480/e.bytesPerSample;let n=-1,i=-1,a=-1;e.channels>=6?(i=0,n=3,e.channels>=9&&(a=6)):e.channels>=3&&(n=0);let s=256,c=2e3;s=1<<8+(e.lightRaw>>13&7),e.lightRaw>>10&!0&&(c=Math.floor(8e3/(1<<(e.lightRaw>>10&7))));let u=16;0!=e.rateCode&&(u=16>>(e.rateCode>>6));let l=32768/c;n>=0&&(e.accelAxis=n,e.accelRange=u,e.accelUnit=s),i>=0&&(e.gyroAxis=i,e.gyroRange=c,e.gyroUnit=l),a>=0&&(e.magAxis=a,e.magRange=magRange,e.magUnit=16);let f=0;if(e.timestampOffset=e.timestampOffsetRaw,!0&e.deviceFractional&&(f=(32767&e.deviceFractional)<<1,e.timestampOffset+=f*e.frequency>>16),e.timestamp=new Date(e.timestampRaw.getTime()+f/65536*1e3),e.samples=[],4==e.bytesPerSample&&3==e.channels)for(let n=0;n<e.sampleCount;n++){const r=30+4*n,i=t.getUint32(r,!0),a=6-(i>>30&3);e.samples.push([(o(65472&i<<6)>>a)/s,(o(65472&i>>4)>>a)/s,(o(65472&i>>14)>>a)/s])}else if(2==e.bytesPerAxis){for(let r=0;r<e.sampleCount;r++){const o=30+2*r*e.channels+2*n;e.samples.push([t.getInt16(o+0,!0)/s,t.getInt16(o+2,!0)/s,t.getInt16(o+4,!0)/s])}if(i>=0){e.samplesGyro=[];for(let n=0;n<e.sampleCount;n++){const r=30+2*n*e.channels+2*i;e.samplesGyro.push([t.getInt16(r+0,!0)/l,t.getInt16(r+2,!0)/l,t.getInt16(r+4,!0)/l])}}}else console.log("ERROR: Unsupported bytes-per-sample: "+e.bytesPerSample);return e}},{}],sLgq:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=t("./util.mjs"),o=t("./cwa_parse.mjs");class i{constructor(t,e,n){this.output=t,this.prefix=e,this.timeout=n}isTerminal(t){return!(!this.prefix&&""!==this.prefix||!t.startsWith(this.prefix))}}class a{constructor(t){this.started=(new Date).getTime(),this.command=t,this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e}),this.lines=[],this.completed=!1,this.error=null}addResponse(t){this.lines.push(t);const e=this.command.isTerminal(t);return console.log(`...now have ${this.lines.length} line(s) (terminal=${e})`),!!e}lastLine(){return this.completed&&this.lines.length>0?this.lines[this.lines.length-1]:null}complete(t=null){null!=t?(console.log("COMMAND-REJECT: "+t),this.error=t,this.reject(this)):(console.log("COMMAND-RESOLVE"),this.completed=!0,this.resolve(this))}checkTimeout(){const t=(new Date).getTime()-this.started;return!(this.completed||this.error||!this.command.timeout||!(t>=this.command.timeout))}}class s{constructor(t){if(this.device=t,console.log("--- COMMS ---"),console.log(this.device.productName),console.log(this.device.manufacturerName),console.log(this.device.serialNumber),this.serial=function(t){if(null==t)return null;if(!(t=t.trim()).startsWith("AX")&&!t.startsWith("CWA"))return null;for(let e=t.length-1;;e--)if(e<0||!(t.charCodeAt(e)>=48&&t.charCodeAt(e)<=57))return e+1>=t.length?null:parseInt(t.substring(e+1))}(this.device.serialNumber),console.log("SERIAL: "+this.serial),this.deviceType=null,this.device.serialNumber){const t=this.device.serialNumber.trim();t.startsWith("CWA")?this.deviceType="AX3":t.startsWith("AX")&&(this.deviceType=t.substring(0,3))}this.hasGyro="AX6"===this.deviceType,this.commandQueue=[],this.currentCommand=null,this.currentTimeout=null,this.rejectRead=null,this.nextTick=null,this.receiveBuffer="",this.statusHandler=null,this.status={id:{deviceId:null},battery:{percent:null,time:null},start:null,stop:null,state:null,errorState:null},this.recalculateRecordingStatus()}setStatusHandler(t){this.statusHandler=t}statusChanged(){this.statusHandler&&this.statusHandler(this,this.status)}updateState(t,e){console.log("STATE: "+t+" / "+e),this.status.state=t,this.status.errorState=e,this.statusChanged()}async exec(t){console.log(`exec() command=${t.output.replace(/[\r\n]/g,"|")} commandQueue.length=${this.commandQueue.length} currentCommand=${this.currentCommand} nextTick=${this.nextTick}`);const e=new a(t);return this.commandQueue.push(e),null==this.currentCommand&&null==this.nextTick&&(console.log("exec(): bootstrap"),this.nextTick=setTimeout(async()=>{console.log("exec(): bootstrap..."),await this.execNext(),console.log("exec(): bootstrap... done")},0)),console.log("exec(): return"),e.promise}async execNext(){try{if(this.nextTick=!0,console.log("execNext()"),null==this.currentCommand){if(console.log("execNext(): no command..."),this.commandQueue.length<=0)return console.log("execNext(): no more commands"),void(this.nextTick=null);console.log("execNext(): getting next command..."),this.currentCommand=this.commandQueue.shift(),this.currentCommand.command.timeout?(console.log("execNext(): setting up new timeout: "+this.currentCommand.command.timeout),this.currentTimeout=setTimeout(this.timeout.bind(this),this.currentCommand.command.timeout)):console.log("execNext(): command has no timeout");try{console.log("execNext(): write: "+this.currentCommand.command.output.replace(/[\r\n]/g,"|")),await this.write(this.currentCommand.command.output),console.log("execNext(): write: (done)")}catch(t){console.log("execNext(): write: exception: "+t),this.commandComplete(t)}}if(this.currentCommand){let t=null;try{this.currentCommand&&this.currentCommand.checkTimeout()?(console.log("execNext(): timeout before read"),this.commandComplete("Timeout before read")):(console.log("execNext(): read"),t=await this.read())}catch(t){console.log("execNext(): read exception: "+t),this.commandComplete(t)}if(null===t&&"serial"===this.device.type&&null===t&&(await this.write("\r"),await(0,r.sleep)(100)),this.currentCommand&&null!==t)for(console.log("execNext(): adding data "+t.length),this.receiveBuffer+=t;;){const t=this.receiveBuffer.indexOf("\n");if(t<0)break;const e=this.receiveBuffer.slice(0,t).trim();if(console.log("LINE: "+e),this.receiveBuffer=this.receiveBuffer.slice(t+1),this.currentCommand.addResponse(e)){console.log("execNext(): end"),this.commandComplete();break}}else console.log("execNext(): (no command or no data) ")}}catch(t){console.log("execNext(): Exception during processing: "+t)}this.nextTick=setTimeout(async()=>{console.log("execNext(): ..."),await this.execNext(),console.log("execNext(): ... done")},0),console.log("execNext(): end")}async timeout(){try{console.log("timeout(): ..."),this.currentTimeout=null,this.rejectRead&&(console.log("timeout(): ...reject read..."),this.rejectRead(null)),this.currentCommand?(console.log("timeout(): ...cancel read..."),await this.device.cancelRead(),this.commandComplete("Timeout")):console.log("timeout(): no current command"),console.log("timeout(): ...done")}catch(t){console.log("timeout(): ERROR: "+t)}}commandComplete(t=null){if(null!==t?console.log("commandComplete(): FAILED "+t+" -- "+(this.currentCommand?this.currentCommand.command.output:"-")):console.log("commandComplete(): SUCCESS -- "+(this.currentCommand?this.currentCommand.command.output:"-")),this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentCommand){const e=this.currentCommand;this.currentCommand=null,e.complete(t)}}async open(){this.receiveBuffer="",await this.device.open(),console.log("...opened")}async close(){return await this.device.close()}async write(t){await this.device.write(t)}async read(){const t=new Promise((t,e)=>{this.rejectRead=e});return Promise.race([t,this.device.read()])}parseDateTime(t){if("0"==t)return 0;if("-1"==t)return-1;const e=parseInt(t.substring(0,4),10),n=parseInt(t.substring(5,7),10),r=parseInt(t.substring(8,10),10),o=parseInt(t.substring(11,13),10),i=parseInt(t.substring(14,16),10),a=parseInt(t.substring(17,19),10),s=new Date(e,n-1,r,o,i,a,0);return s.getFullYear()<2e3?0:s.getFullYear()>=2064?-1:s}packDateTime(t=null){if(null===t&&(t=new Date),0==t)return"0";if(-1==t)return"-1";let e=t.getFullYear()+"/";return(e=(e=(e=(e=e+(t.getMonth()+1<10?"0":"")+(t.getMonth()+1)+"/")+(t.getDate()<10?"0":"")+t.getDate()+",")+(t.getHours()<10?"0":"")+t.getHours()+":")+(t.getMinutes()<10?"0":"")+t.getMinutes()+":")+(t.getSeconds()<10?"0":"")+t.getSeconds()}async getConfigOptions(){const t={accelRate:[6.25,12.5,25,50,100,200,400,800,1600,3200],accelRange:[2,4,8,16]};return this.hasGyro&&(t.gyroRange=[0,250,500,1e3,2e3]),t}async setId(t){const e=new i(`\r\nDEVICE=${t}\r\n`,"DEVICE=",2e3);console.log(">>> "+e.output);const n=(await this.exec(e)).lastLine();console.log("<<< "+n);const r=n.substring(n.indexOf("=")+1).split(",").map(t=>parseInt(t,10));if(r[0]!=t||r[1]!=t)throw`DEVICE value unexpected: was ${r[0]} / ${r[1]}, expected ${t}`}async getId(){const t=new i("\r\nID\r\n","ID=",2e3);console.log(">>> "+t.output);const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const n=e.substring(e.indexOf("=")+1).split(",");return this.hasGyro="AX6"===n[0],{deviceType:"CWA"==n[0]?"AX3":n[0],deviceId:parseInt(n[3],10),firmwareVersion:parseInt(n[2],10)}}async getBattery(){const t=new i("\r\nSAMPLE 1\r\n","$BATT=",2e3);console.log(">>> "+t.output);const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const n=e.substring(e.indexOf("=")+1).split(",").map(t=>parseInt(t,10));return{voltage:n[1]/1e3,percent:n[3],charging:n[4],time:new Date}}async setLed(t){const e=new i(`\r\nLED ${t}\r\n`,"LED=",2e3);console.log(">>> "+e.output);const n=(await this.exec(e)).lastLine();console.log("<<< "+n);const r=n.substring(n.indexOf("=")+1).split(",").map(t=>parseInt(t,10));if(r[0]!=t)throw`LED value unexpected: was ${r[0]}, expected ${t}`}async getTime(){const t=new i("\r\nTIME\r\n","$TIME=",2e3);console.log(">>> "+t.output);const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const n=e.substring(e.indexOf("=")+1);return this.parseDateTime(n)}async setTime(t=null){this.updateState("Configuring: Setting time");let e=t;null===e&&(e=new Date);const n=this.packDateTime(e),r=new i(`\r\nTIME ${n}\r\n`,"$TIME=",2e3);console.log(">>> "+r.output);const o=(await this.exec(r)).lastLine();console.log("<<< "+o);const a=this.parseDateTime(o.substring(o.indexOf("=")+1)),s=a.getTime()-e.getTime();if(Math.abs(s)>2e3)throw`Time value difference too large: received ${a.toISOString()}, expected closer to ${e.toISOString()}`}async getSession(){const t=new i("\r\nSESSION\r\n","SESSION=",2e3);console.log(">>> "+t.output);const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const n=e.substring(e.indexOf("=")+1).split(",").map(t=>parseInt(t,10));return parseInt(n[0])}async setSession(t){const e=parseInt(t);if(this.updateState("Configuring: Setting session ID"),"number"!=typeof e||isNaN(e)||e<0||e>2147483647)throw"Session ID invalid value";const n=new i(`\r\nSESSION ${e}\r\n`,"SESSION=",2e3);console.log(">>> "+n.output);const r=(await this.exec(n)).lastLine();console.log("<<< "+r);const o=r.substring(r.indexOf("=")+1).split(",").map(t=>parseInt(t,10));if(o[0]!=e)throw`SESSION value unexpected: was ${o[0]}, expected ${e}`}async getMaxSamples(){const t=new i("\r\nMAXSAMPLES\r\n","MAXSAMPLES=",2e3);console.log(">>> "+t.output);const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const n=e.substring(e.indexOf("=")+1).split(",").map(t=>parseInt(t,10));return parseInt(n[0])}async setMaxSamples(t){this.updateState("Configuring: Setting max. samples");const e=new i(`\r\nMAXSAMPLES ${t}\r\n`,"MAXSAMPLES=",2e3);console.log(">>> "+e.output);const n=(await this.exec(e)).lastLine();console.log("<<< "+n);const r=n.substring(n.indexOf("=")+1).split(",").map(t=>parseInt(t,10));if(r[0]!=t)throw`MAXSAMPLES value unexpected: was ${r[0]}, expected ${t}`}async getHibernate(t){const e=new i("\r\nHIBERNATE\r\n","HIBERNATE=",2e3);console.log(">>> "+e.output);const n=(await this.exec(e)).lastLine();console.log("<<< "+n);const r=n.substring(n.indexOf("=")+1);return this.parseDateTime(r)}async setHibernate(t){this.updateState("Configuring: Setting start");const e=this.packDateTime(t),n=new i(`\r\nHIBERNATE ${e}\r\n`,"HIBERNATE=",2e3);console.log(">>> "+n.output);const r=(await this.exec(n)).lastLine();console.log("<<< "+r);const o=r.substring(r.indexOf("=")+1);if(e!=o)throw`HIBERNATE value unexpected: was ${o}, expected ${e}`}async getStop(t){const e=new i("\r\nSTOP\r\n","STOP=",2e3);console.log(">>> "+e.output);const n=(await this.exec(e)).lastLine();console.log("<<< "+n);const r=n.substring(n.indexOf("=")+1);return this.parseDateTime(r)}async setStop(t){this.updateState("Configuring: Setting stop");const e=this.packDateTime(t),n=new i(`\r\nSTOP ${e}\r\n`,"STOP=",2e3);console.log(">>> "+n.output);const r=(await this.exec(n)).lastLine();console.log("<<< "+r);const o=r.substring(r.indexOf("=")+1);if(o.indexOf(e)<0)throw`STOP value unexpected: was ${o}, expected ${e}`}async getRate(){const t=new i("\r\nRATE\r\n","RATE=",2e3);console.log(">>> "+t.output);const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const n=e.substring(e.indexOf("=")+1).split(",").map(t=>parseInt(t,10)),r=parseInt(n[0]);let o=0;return 0==(192&r)?o=16:64==(192&r)?o=8:128==(192&r)?o=4:192==(192&r)&&(o=2),{rateCode:r,rate:n.length>1?parseInt(n[1]):null,accelRange:o,gyroRange:n.length>2?parseInt(n[2]):null}}async setRate(t,e,n,r){this.updateState("Configuring: Setting rate");let o=0;switch(parseFloat(t)){case 3200:o|=15;break;case 1600:o|=14;break;case 800:o|=13;break;case 400:o|=12;break;case 200:o|=11;break;case 100:o|=10;break;case 50:o|=9;break;case 25:o|=8;break;case 12.5:case 12:o|=7;break;case 6.25:case 6:o|=6;break;default:throw"Invalid accelerometer frequency."}if(this.hasGyro&&parseFloat(t)>1600)throw"This device has a maximum rate of 1600Hz.";if(!this.hasGyro&&r&&parseFloat(t)<12)throw"This device has a minimum rate of 12.5Hz in packed mode.";if(this.hasGyro&&n&&parseFloat(t)<25)throw"This device has a minimum rate of 25Hz with the gyroscope enabled.";switch(parseInt(e)){case 16:o|=0;break;case 8:o|=64;break;case 4:o|=128;break;case 2:o|=192;break;default:throw"Invalid accelerometer sensitivity."}let a=null;if(n){if(!this.hasGyro)throw"Cannot configure gyroscope on device without gyroscope.";switch(parseInt(n)){case 2e3:case 1e3:case 500:case 250:a=parseInt(n);break;default:throw"Invalid gyro range: "+parseInt(n)}}const s=new i(a?`\r\nRATE ${o},${a}\r\n`:`\r\nRATE ${o}\r\n`,"RATE=",2e3);console.log(">>> "+s.output);const c=(await this.exec(s)).lastLine();console.log("<<< "+c);const u=c.substring(c.indexOf("=")+1).split(",").map(t=>parseInt(t,10));if(u[0]!=o)throw`RATE value unexpected: was ${u[0]}, expected ${o}`;if(u[1]!=Math.floor(t))throw`RATE frequency unexpected: was ${u[1]}, expected ${Math.floor(t)}`;if(a&&u[2]!=a)throw`RATE gyro range unexpected: was ${u[2]}, expected ${a}`}async getStatus(){const t={ftl:null,restart:null,nandid:null},e=new i("\r\nSTATUS\r\nECHO\r\n","ECHO=",2e3);console.log(">>> "+e.output);const n=await this.exec(e);for(let e of n.lines)e.startsWith("FTL=")?t.ftl=e.substring(e.indexOf("=")+1):e.startsWith("RESTART=")?t.restart=e.substring(e.indexOf("=")+1):e.startsWith("NANDID=")&&(t.nandid=e.substring(e.indexOf("=")+1));return t}async getLog(){const t=[],e=new i("\r\nLOG\r\n","LOG,0",2e3);console.log(">>> "+e.output);const n=await this.exec(e);for(let e of n.lines){const n=e.split(",");if("LOG"!=n[0])continue;const r=parseInt(n[1]),o={index:r,time:this.parseDateTime(n[3]+" "+n[4]),code:n[2],status:/[_A-Z]*/.exec(n[5])[0]};t[r]=o}return t}async setDebug(t){let e=!0===t?3:+t;this.updateState("Configuring: Setting flash status");const n=new i(`\rDEBUG ${e}\r\n`,"DEBUG=",2e3);console.log(">>> "+n.output);const r=(await this.exec(n)).lastLine();console.log("<<< "+r);const o=r.substring(r.indexOf("=")+1).split(",").map(t=>parseInt(t,10));if(o[0]!=e)throw`DEBUG value unexpected: was ${o[0]}, expected ${e}`}async readSector(t,e=null,n=0,r=null){const o=new i(`\r\nREADL ${t}\r\nECHO\r\n`,"ECHO=",1e4);console.log(">>> "+o.output);const a=await this.exec(o);e||(e=new ArrayBuffer(512)),null===r&&(r=512);const s=new DataView(e,n,r);let c=0;for(let t of a.lines){if(t.startsWith("READL="))continue;if(t.startsWith("OK"))continue;if(t.startsWith("ECHO="))continue;const e=(t=t.trim()).split(":",1)[0],n=parseInt(e,16);if(n!=c)throw`Unexpected sector offset ${n}, expected ${c}`;const o=t.replace(/\ /g,"").slice(e.length+1,e.length+1+32),i=o.length/2;if(16!=i)throw`Unexpected sector line length ${o.length} -> ${i}, expected 32 -> 16`;for(let t=0;t<i;t++){if(c<r){const e=parseInt(o.slice(2*t,2*t+2),16);s.setUint8(c,e)}else console.log("WARNING: Ignoring sector contents beyond end of read extent: "+c);c++}}if(512!=c)throw console.dir(a.lines),`Unexpected sector data of size ${c}, expected size 512, from ${a.lines.length} lines`;return s}fileTell(t,e){return e.sectorWithinFile*t.sectorSize+e.offsetWithinSector}fileReset(t,e){e.currentCluster=e.dataFirstCluster,e.currentSectorWithinFile=0,e.offsetWithinSector=0,e.currentSectorBuffer=null}async fileSeek(t,e,n){console.log("READ-FILE: Seeking @"+n);const r=Math.floor(n/t.sectorSize);if(r==e.currentSectorWithinFile)return console.log("READ-FILE: seeking within current sector"),!0;console.log("READ-FILE: seeking outside current sector"),e.currentSectorBuffer=null;let o=Math.floor(e.currentSectorWithinFile/t.sectorsPerCluster);const i=Math.floor(r/t.sectorsPerCluster);for(i<o&&(console.log("READ-FILE: seeking before current cluster, starting at beginning of chain"),o=0,e.currentCluster=e.dataFirstCluster),i==o&&console.log("READ-FILE: seeking within current cluster");o!=i;){let n=null;const r=8*t.sectorSize/t.type,i=Math.floor(e.currentCluster/r);if(t.allocationTable||(console.log("READ-FILE: creating new allocation table"),t.allocationTable=[]),console.log("READ-FILE: Requesting FAT page "+i),!t.allocationTable[i]){const e=t.firstFatSector+i;console.log("READ-FILE: Cache miss, reading FAT page "+i+" at sector "+e);const n=await this.readSector(e);t.allocationTable[i]=n}const a=e.currentCluster%r;if(12==t.type)throw"FAT12 not supported";if(16==t.type)n=t.allocationTable[i].getUint16(2*a,!0);else{if(32!=t.type)throw"Filesystem type not supported: "+t.type;n=t.allocationTable[i].getUint32(4*a,!0)}console.log("READ-FILE: seeking after current cluster, following chain: #"+o+" "+e.currentCluster+" -> "+n),e.currentCluster=n,o++}return e.currentSectorWithinFile=r,e.offsetWithinSector=n%t.sectorSize,console.log("READ-FILE: seeking complete, sector "+e.currentSectorWithinFile+", offset "+e.offsetWithinSector+", clusterIndex="+o),!0}async fileRead(t,e,n,r,o){if(console.log("READ-FILE: @maxSize="+n+", current-offset="+e.offsetWithinSector+" / "+t.sectorSize),n<=0)return 0;if(e.offsetWithinSector>=t.sectorSize){const n=(e.currentSectorWithinFile+1)*t.sectorSize;await this.fileSeek(t,e,n),console.log("READ-FILE: ...seek result @"+e.currentSectorWithinFile)}if(null==e.currentSectorBuffer){const n=t.firstSectorOfFileArea+(e.currentCluster-2)*t.sectorsPerCluster+e.currentSectorWithinFile%t.sectorsPerCluster;e.currentSectorBuffer=new ArrayBuffer(t.sectorSize),console.log("READ-SECTOR: "+n),await this.readSector(n,e.currentSectorBuffer,0,t.sectorSize)}n>t.sectorSize-e.offsetWithinSector&&(n=t.sectorSize-e.offsetWithinSector),console.log("READ-FILE: Sub-reading @offset="+e.offsetWithinSector+" @index="+o+" sector #"+t.firstSectorOfFileArea+(e.currentCluster-2)*t.sectorsPerCluster+e.currentSectorWithinFile%t.sectorsPerCluster+" maxSize="+n+"...");const i=new DataView(e.currentSectorBuffer,e.offsetWithinSector,n),a=new DataView(r,o,n);for(let t=0;t<n;t++){const e=i.getUint8(t);a.setUint8(t,e)}return e.offsetWithinSector+=n,console.log("READ-FILE: Sub-reading finished @offset="+e.offsetWithinSector),n}async findFileEntry(t,e){t.rootSector||(t.rootSector=await this.readSector(t.rootSectorNumber));const n=e.split("."),r=(n.length<=1?"":n.pop()).trim().toUpperCase().slice(0,3).padEnd(3," "),o=n.join("").trim().toUpperCase().replace(/ /g,"").slice(0,8).padEnd(8," ")+r,i={};i.filename=e,i.entry=o,i.exists=!1,i.dataLength=null,i.dataFirstCluster=null;for(let e=0;e<16;e++){const n=32*e;let r=!0;for(let e=0;e<o.length;e++)if(t.rootSector.getUint8(n+e)!=o.charCodeAt(e)){r=!1;break}if(r){i.exists=!0,i.dataFirstCluster=t.rootSector.getUint16(n+26,!0),i.dataLength=t.rootSector.getUint32(n+28,!0);break}}return this.fileReset(t,i),i}async readFile(t,e,n,r){if(!e.exists)return null;if(!await this.fileSeek(t,e,n))throw"Cannot seek to offset: "+n;null===r&&(r=e.dataLength-n),r>e.dataLength-n&&(r=e.dataLength-n),console.log("READ-FILE: Maximum read: "+r+" / "+e.dataLength);const o=new ArrayBuffer(r);let i=0;for(;;){console.log("READ-FILE: Reading @index="+i+"...");const n=await this.fileRead(t,e,r-i,o,i);if(n<=0)break;i+=n}return i<r&&console.log("READ-FILE WARNING: Short read: "+i+" / "+r),o}async readFilesystem(){this.updateState("Reading filesystem");const t={};if(t.mbrSector=await this.readSector(0),85!=t.mbrSector.getUint8(510)||170!=t.mbrSector.getUint8(511))throw"Invalid MBR signature";if(t.firstSectorNumber=t.mbrSector.getUint32(454,!0),t.sectorCount=t.mbrSector.getUint32(458,!0),t.bootSector=await this.readSector(t.firstSectorNumber),t.sectorSize=t.bootSector.getUint16(11,!0),512!=t.sectorSize)throw"Invalid sectorSize: "+t.sectorSize;if(t.sectorsPerCluster=t.bootSector.getUint8(13),t.sectorsPerCluster&t.sectorsPerCluster-1!=0)throw"Invalid sectorsPerCluster: "+t.sectorsPerCluster;if(t.clusterSize=t.sectorsPerCluster*t.sectorSize,t.clusterSize&t.clusterSize-1!=0)throw"Invalid clusterSize: "+t.clusterSize;if(t.numReservedSectors=t.bootSector.getUint16(14,!0),t.numFATs=t.bootSector.getUint8(16),t.numFATs<1||t.numFATs>2)throw"Invalid numFATs: "+t.numFATs;if(t.firstFatSector=t.firstSectorNumber+t.numReservedSectors,t.numRootDirectoryEntries=t.bootSector.getUint16(17,!0),0==t.numRootDirectoryEntries)throw"Invalid numRootDirectoryEntries: "+t.numRootDirectoryEntries;return t.sectorsPerFAT=t.bootSector.getUint16(22,!0),t.rootSectorNumber=t.firstSectorNumber+t.numReservedSectors+t.numFATs*t.sectorsPerFAT,t.firstSectorOfFileArea=t.rootSectorNumber+Math.floor(32*t.numRootDirectoryEntries/512),t.sectorCapacity=t.sectorCount-t.firstSectorNumber,t.clusterCapacity=Math.ceil(t.sectorCapacity/t.sectorsPerCluster),t.clusterCapacity<4085?t.type=12:t.clusterCapacity<65525?t.type=16:t.type=32,32==t.type&&(t.rootSectorNumber=t.firstSectorOfFileArea),console.log("Filesystem: "+t.type+"-bit, "+t.sectorCapacity+" sectors, "+t.clusterCapacity+" clusters, "+t.sectorsPerCluster+" sectors per cluster, "+t.clusterSize+" bytes per cluster, "+t.numRootDirectoryEntries+" root directory entries, "+t.firstSectorOfFileArea+" first sector of file area, "+t.rootSectorNumber+" first sector of root directory"),t.fileEntry=await this.findFileEntry(t,"CWA-DATA.CWA"),t.fileEntry.dataContents=await this.readFile(t,t.fileEntry,0,1536),t.fileEntry.readLength=t.fileEntry.dataContents.byteLength,t.fileEntry.dataLength>=1536&&(t.fileEntry.lastDataContents=await this.readFile(t,t.fileEntry,t.fileEntry.dataLength-512,512)),t}async setMetadata(t){for(let e=0;e<14;e++){this.updateState(`Configuring: Setting metadata (${e+1} / 14)`);let n="";const r=32*e;let o=32*(e+1);r<t.length&&(o>t.length&&(o=t.length),n=t.substring(r,o));const a="Annotate"+(e<10?"0":"")+e+"="+n+"\r\n",s="ANNOTATE"+(e<10?"0":"")+e+"=";await this.tryAndRetry(async()=>{const t=new i(`\r\n${a}\r\n`,s,1e3);console.log(">>> "+t.output+"|");const e=(await this.exec(t)).lastLine();console.log("<<< "+e);const r=e.substring(e.indexOf("=")+1);if(r.trim()!=n.trim())throw`${s} unexpected value, received "${r.trim()}", expected "${n.trim()}"`})}}async commit(t){let e;if(!0===t)this.updateState("Configuring: Wiping and committing"),e=new i("\r\nFORMAT WC\r\n","COMMIT",1e4);else if(!1===t)this.updateState("Configuring: Erasing and committing"),e=new i("\r\nFORMAT QC\r\n","COMMIT",8e3);else{if(null!==t)throw"ERROR: Unknown commit type.";this.updateState("Configuring: Committing"),e=new i("\r\nCommit\r\n","COMMIT",5e3)}console.log(">>> "+e.output);const n=(await this.exec(e)).lastLine();console.log("<<< "+n)}async tryAndRetry(t,e=3,n=1e3){let o="Unexpected failure in retry logic.";for(let i=0;i<e;i++)try{return n&&i>0&&(console.log(`Retrying in ${n/1e3}s...`),await(0,r.sleep)(n)),await t()}catch(t){o=t,console.log(`WARNING: Failed attempt (${i+1}/${e}): `+(t.error?t.error:t))}throw o}async updateStatus(){if(this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{if(this.updateState("Querying status"),await this.tryAndRetry(()=>this.open()),null===this.status.id||null===this.status.id.deviceId){if(this.status.id=await this.tryAndRetry(()=>this.getId()),this.status.id.deviceId!=this.serial){if(null!==this.serial||"serial"!==this.device.type)throw`ERROR: Device id mismatch: reported ID=${this.status.id.deviceId} but serial number was ${this.serial}.`;console.log(`WARNING: Serial API did not return serial number, so not verifying reported: ID=${this.status.id.deviceId}`)}console.log("ID="+JSON.stringify(this.status.id))}const t=new Date;return(null===this.status.battery||null===this.status.battery.percent||null===this.status.battery.time||t.getTime()-this.status.battery.time.getTime()>=3e4)&&(this.status.battery=await this.tryAndRetry(()=>this.getBattery()),console.log("BATTERY="+JSON.stringify(this.status.battery))),null===this.status.start&&(this.status.start=await this.tryAndRetry(()=>this.getHibernate())),null===this.status.stop&&(this.status.stop=await this.tryAndRetry(()=>this.getStop())),this.recalculateRecordingStatus(),this.status}catch(t){throw t.error?(this.updateState(null,`Error getting status: ${t.error}`),console.log("ERROR: Problem during status update: "+t.error)):(this.updateState(null,`Error getting status: ${t}`),console.log("ERROR: Problem during status update: "+t)),t}finally{await this.close()}}recalculateRecordingStatus(t=!1){const e=Date.UTC(-271821,3,20),n=Date.UTC(275760,8,13),r=new Date;let o=this.status.start;-1===o&&(o=n),0===o&&(o=e);let i=this.status.stop;-1===i&&(o=n),0===i&&(o=e),this.status.recordingConfigured=o<i,this.status.recordingFinished=this.status.recordingConfigured&&r>=i,this.status.recordingStarted=this.status.recordingConfigured&&r>=o&&!this.status.recordingFinished,this.status.recordingIncomplete=this.status.recordingConfigured&&!this.status.recordingFinished;let a=t?"Configured: ":"";this.status.recordingConfigured?this.status.recordingFinished?a+="Recording complete":this.status.recordingStarted?a+="Recording started":a+="Configured":a=t?"Settings cleared":"Ready",this.updateState(a)}async configure(t){if(this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{this.updateState("Configuring..."),await this.tryAndRetry(()=>this.open());const e={resetDeviceId:null,minbattery:null,configLed:s.LED_BLUE,time:null,session:0,maxSamples:0,rate:100,range:8,gyro:0,start:-1,stop:0,metadata:"",led:s.LED_MAGENTA,wipe:!0,noData:!1,debug:!1};for(let n of Object.keys(t))if(!(n in e))throw`ERROR: Unknown configuration value: ${n}`;const n=Object.assign(e,t);if(console.log("ID="+JSON.stringify(this.status.id)),this.status.id.deviceId!=this.serial){if(null!==this.serial||"serial"!==this.device.type)throw`ERROR: Device id mismatch (was status updated first?): reported ID=${this.status.id.deviceId} but USB serial number was ${this.serial}.`;console.log(`WARNING: Serial API did not return serial number, so not verifying reported: ID=${this.status.id.deviceId}`)}if(await this.tryAndRetry(()=>this.setLed(n.configLed)),console.log("BATTERY="+JSON.stringify(this.status.battery)),this.status.battery.percent<n.minbattery)throw`ERROR: Device battery level too low: ${this.status.battery.percent}% (required ${n.minbattery}%).`;if(n.noData){const t=await this.tryAndRetry(()=>this.readFilesystem());if(console.log("FILESYSTEM="+JSON.stringify(t)),t.fileEntry&&t.fileEntry.dataLength&&t.fileEntry.dataLength>1024)throw"ERROR: Device has data on it."}return n.time||(n.time=new Date),n.resetDeviceId&&this.setId(n.resetDeviceId),await this.tryAndRetry(()=>this.setTime(n.time)),await this.tryAndRetry(()=>this.setRate(n.rate,n.range,n.gyro,!0)),await this.tryAndRetry(()=>this.setSession(n.session)),await this.tryAndRetry(()=>this.setMaxSamples(n.maxSamples)),await this.tryAndRetry(()=>this.setDebug(n.debug?3:0)),await this.tryAndRetry(()=>this.setHibernate(n.start)),await this.tryAndRetry(()=>this.setStop(n.stop)),await this.tryAndRetry(()=>this.setMetadata(n.metadata)),await this.tryAndRetry(()=>this.commit(n.wipe)),this.status.start=n.start,this.status.stop=n.stop,this.recalculateRecordingStatus(!0),await this.tryAndRetry(()=>this.setLed(n.led)),{time:n.time,timeDevice:(0,r.localTimeString)(n.time,"S"),deviceId:this.status.id.deviceId,battery:battery.percent,start:n.start,startDevice:(0,r.localTimeString)(n.start,"S"),stop:n.stop,stopDevice:(0,r.localTimeString)(n.stop,"S"),session:n.session,rate:n.rate,range:n.range,gyro:n.gyro,metadata:n.metadata}}catch(t){throw t.error?(this.updateState(null,`Error: ${t.error}`),console.log("ERROR: Problem during configuration: "+t.error)):(this.updateState(null,`Error: ${t}`),console.log("ERROR: Problem during configuration: "+t)),t}finally{await this.close()}}async runReset(t){let e={time:new Date,session:0,rate:100,range:8,gyro:0,start:-1,stop:0,metadata:"",maxSamples:0,debug:0,wipe:!0,minbattery:0,noData:!1};t&&(e.resetDeviceId=t),this.configure(e)}async runDiagnostic(){if(this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{this.updateState("Running diagnostic..."),await this.tryAndRetry(()=>this.open()),this.diagnostic={},this.diagnostic.errors=[],this.diagnostic.time=new Date,this.diagnostic.id=this.status.id,this.diagnostic.battery=this.status.battery,this.diagnostic.start=this.status.start,this.diagnostic.stop=this.status.stop;try{this.diagnostic.rate=await this.getRate(),this.diagnostic.deviceTime=await this.getTime(),this.diagnostic.sessionId=await this.getSession(),this.diagnostic.maxSamples=await this.getMaxSamples(),this.diagnostic.status=await this.getStatus(),this.diagnostic.log=await this.getLog()}catch(t){this.diagnostic.errors.push("Problem while getting additional information: "+JSON.stringify(t))}try{this.diagnostic.filesystem=await this.readFilesystem()}catch(t){this.diagnostic.errors.push("Problem while getting filesystem information: "+JSON.stringify(t))}if(this.diagnostic.filesystem&&this.diagnostic.filesystem.fileEntry&&this.diagnostic.filesystem.fileEntry.dataLength>0&&this.diagnostic.filesystem.fileEntry.dataContents){let t=null,e=null;try{this.diagnostic.file={filename:this.diagnostic.filesystem.fileEntry.filename,length:this.diagnostic.filesystem.fileEntry.dataLength,source:"serial"},t=this.diagnostic.filesystem.fileEntry.dataContents,e=this.diagnostic.filesystem.fileEntry.lastDataContents}catch(t){this.diagnostic.errors.push("Problem while reading data file: "+JSON.stringify(t))}if(t&&this.diagnostic.filesystem.fileEntry.dataLength>=512)try{this.diagnostic.header=(0,o.parseHeader)(new DataView(t,0,512))}catch(t){this.diagnostic.errors.push("Problem while parsing file header: "+JSON.stringify(t))}if(t&&this.diagnostic.filesystem.fileEntry.dataLength>=1536)try{this.diagnostic.first=(0,o.parseData)(new DataView(t,1024,512))}catch(t){this.diagnostic.errors.push("Problem while parsing file data (first): "+JSON.stringify(t))}if(e&&this.diagnostic.filesystem.fileEntry.dataLength>=512)try{this.diagnostic.last=(0,o.parseData)(new DataView(e,0,512))}catch(t){this.diagnostic.errors.push("Problem while parsing file data (last): "+JSON.stringify(t))}}return this.recalculateRecordingStatus(),this.diagnostic.filesystem.allocationTable&&delete this.diagnostic.filesystem.allocationTable,this.diagnostic}catch(t){throw t.error?(this.updateState(null,`Error running diagnostic: ${t.error}`),console.log("ERROR: Problem during diagnostic: "+t.error)):(this.updateState(null,`Error running diagnostic: ${t}`),console.log("ERROR: Problem during diagnostic: "+t)),t}finally{await this.close()}}}n.default=s,s.USB_DEVICE_VID=1240,s.USB_DEVICE_PID=87,s.LED_OFF=0,s.LED_BLUE=1,s.LED_GREEN=2,s.LED_CYAN=3,s.LED_RED=4,s.LED_MAGENTA=5,s.LED_YELLOW=6,s.LED_WHITE=7},{"./util.mjs":"x7XL","./cwa_parse.mjs":"bBqM"}],bqdr:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=a(t("./usb_device.mjs")),o=a(t("./serial_device.mjs")),i=a(t("./ax3device.mjs"));function a(t){return t&&t.__esModule?t:{default:t}}n.default=class{constructor(t,e){this.enableSerial=e,this.lastAdd=null,this.usbDevices={},this.serialDevices={},this.warnings=[],"file:"===location.protocol&&this.warnings.push("WARNING: Features may not work over the file: protocol (try via an HTTP web server)."),"https:"!==location.protocol&&"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&"::1"!==location.hostname&&this.warnings.push("WARNING: Features may require secure HTTPS on non-loopback connections."),navigator.usb||navigator.serial||this.warnings.push("WARNING: This browser configuration does not support device connection (WebUSB or Web Serial API)."),!(t&&navigator.usb&&navigator.appVersion.indexOf("(Windows")>=0)||e&&navigator.serial||this.warnings.push("WARNING: WebUSB will not work on Windows as standard (CDC devices claimed by the driver). "+(e?" You can try enabling the experimental Web Serial API at: chrome://flags#enable-experimental-web-platform-features and/or see Help for experimental firmware with WinUSB and Generic interface support.":""));for(let t of this.warnings)console.log(t)}async startup(t){return this.changedHandler=t,navigator.usb&&(navigator.usb.addEventListener("disconnect",t=>{const e=t.device;console.log("DEVICEMANAGER: USB Disconnect "+e);const n=this.usbDevices[e];delete this.usbDevices[e],this.changedHandler&&this.changedHandler(n,e,"disconnect")}),navigator.usb.addEventListener("connect",t=>{const e=t.device;console.log("DEVICEMANAGER: USB Connect "+e);const n=new i.default(new r.default(e));this.usbDevices[e]=n,this.changedHandler&&this.changedHandler(n,e,"connect")})),await this.refreshDevices(),!0}async refreshDevices(){if(navigator.serial){const t={};if(navigator.serial.getPorts){let e=[];try{e=await navigator.serial.getPorts()}catch(t){this.firstSerialEnumerateError||(this.firstSerialEnumerateError=!0,console.log("ERROR: Problem enumerating serial devices: "+t+" -- "+JSON.stringify(t)))}for(let n of e)if(t[n]=n,!(n in this.serialDevices)){console.log("DEVICEMANAGER: Serial Enumerate "+n);const t=new i.default(new o.default(n));this.serialDevices[n]=t,this.changedHandler&&this.changedHandler(t,n,"get")}}for(let e of Object.keys(this.serialDevices))if(!(e in t)){console.log("DEVICEMANAGER: Serial Enumerate device lost "+e);const t=this.serialDevices[e];this.changedHandler&&this.changedHandler(t,e,"disconnect"),delete this.serialDevices[e]}}}async userAddUsbDevice(){if(this.lastAdd="usb",!navigator.usb)throw"ERROR: WebUSB is not supported in this browser configuration.";try{const t=await navigator.usb.requestDevice({filters:[{vendorId:i.default.USB_DEVICE_VID,productId:i.default.USB_DEVICE_PID}]});if(console.log("DEVICEMANAGER: Request USB "+t),!(t in this.usbDevices)){const e=new i.default(new r.default(t));this.usbDevices[t]=e}return this.changedHandler&&this.changedHandler(this.usbDevices[t],t,"request"),!0}catch(t){throw"NotFoundError"==t.name?(console.log("NOTE: User did not select a device: "+t.name+" -- "+t.message),"No device chosen."):(console.log("ERROR: "+t+" -- "+t.name+" -- "+t.message),"ERROR: "+t+" -- "+t.name+" -- "+t.message)}}async userAddSerialDevice(){if(this.lastAdd="serial",!("serial"in navigator))throw"ERROR: Web Serial API is not supported in this browser configuration.";try{const t={filters:[{usbVendorId:i.default.USB_DEVICE_VID,usbProductId:i.default.USB_DEVICE_PID,vendorId:i.default.USB_DEVICE_VID,productId:i.default.USB_DEVICE_PID}]},e=await navigator.serial.requestPort(t);if(console.log("DEVICEMANAGER: Request serial "+e),!(e in this.serialDevices)){if(this.serialDevices.length>0){console.log("WARNING: Only one serial device is supported at a time, but about to add another -- removing old.");const t=Object.keys(this.serialDevices)[0],e=this.serialDevices[t];this.changedHandler&&this.changedHandler(e,t,"disconnect"),delete this.serialDevices[t]}const t=new i.default(new o.default(e));this.serialDevices[e]=t}return this.changedHandler&&this.changedHandler(this.serialDevices[e],e,"request"),!0}catch(t){throw"NotFoundError"==t.name?(console.log("NOTE: User did not select a device: "+t.name+" -- "+t.message),"No device chosen."):(console.log("ERROR: "+t+" -- "+t.name+" -- "+t.message),"ERROR: "+t+" -- "+t.name+" -- "+t.message)}}getSingleDevice(){const t=Object.keys(this.usbDevices).length,e=Object.keys(this.serialDevices).length;return 0==t&&0==e?(console.log("ERROR: DeviceManager has no devices -- this will only work for a single device."),null):t+e!==1?(console.log("WARNING: DeviceManager has "+t+" USB device(s) and "+e+" serial device(s)."),console.log("USB: "+JSON.stringify(this.usbDevices)),console.log("SERIAL: "+JSON.stringify(this.serialDevices)),"usb"==this.lastAdd&&t>0?(console.log("NOTE: Choosing USB..."),t>1?(console.log("ERROR: Multiple USB, but this will only work with a single device."),null):Object.values(this.usbDevices)[0]):e>1?(console.log("ERROR: Multiple Serial, but this will only work with a single device."),null):1==e?Object.values(this.serialDevices)[0]:(console.log("ERROR: DeviceManager had an unexpected issue trying to resolve a single device."),null)):e>0?Object.values(this.serialDevices)[0]:t>0?Object.values(this.usbDevices)[0]:(console.log("ERROR: DeviceManager had an unexpected issue trying to resolve a single device."),null)}}},{"./usb_device.mjs":"anNG","./serial_device.mjs":"Lo8Z","./ax3device.mjs":"sLgq"}],yh9p:[function(t,e,n){"use strict";n.byteLength=function(t){var e=u(t),n=e[0],r=e[1];return 3*(n+r)/4-r},n.toByteArray=function(t){var e,n,r=u(t),a=r[0],s=r[1],c=new i(function(t,e,n){return 3*(e+n)/4-n}(0,a,s)),l=0,f=s>0?a-4:a;for(n=0;n<f;n+=4)e=o[t.charCodeAt(n)]<<18|o[t.charCodeAt(n+1)]<<12|o[t.charCodeAt(n+2)]<<6|o[t.charCodeAt(n+3)],c[l++]=e>>16&255,c[l++]=e>>8&255,c[l++]=255&e;return 2===s&&(e=o[t.charCodeAt(n)]<<2|o[t.charCodeAt(n+1)]>>4,c[l++]=255&e),1===s&&(e=o[t.charCodeAt(n)]<<10|o[t.charCodeAt(n+1)]<<4|o[t.charCodeAt(n+2)]>>2,c[l++]=e>>8&255,c[l++]=255&e),c},n.fromByteArray=function(t){for(var e,n=t.length,o=n%3,i=[],a=0,s=n-o;a<s;a+=16383)i.push(f(t,a,a+16383>s?s:a+16383));return 1===o?(e=t[n-1],i.push(r[e>>2]+r[e<<4&63]+"==")):2===o&&(e=(t[n-2]<<8)+t[n-1],i.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),i.join("")};for(var r=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)r[s]=a[s],o[a.charCodeAt(s)]=s;function u(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function f(t,e,n){for(var r,o=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(255&t[i+2]),o.push(l(r));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],JgNJ:[function(t,e,n){n.read=function(t,e,n,r,o){var i,a,s=8*o-r-1,c=(1<<s)-1,u=c>>1,l=-7,f=n?o-1:0,d=n?-1:1,h=t[e+f];for(f+=d,i=h&(1<<-l)-1,h>>=-l,l+=s;l>0;i=256*i+t[e+f],f+=d,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=r;l>0;a=256*a+t[e+f],f+=d,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,r),i-=u}return(h?-1:1)*a*Math.pow(2,i-r)},n.write=function(t,e,n,r,o,i){var a,s,c,u=8*i-o-1,l=(1<<u)-1,f=l>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:i-1,g=r?1:-1,p=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(s=isNaN(e)?1:0,a=l):(a=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-a))<1&&(a--,c*=2),(e+=a+f>=1?d/c:d*Math.pow(2,1-f))*c>=2&&(a++,c/=2),a+f>=l?(s=0,a=l):a+f>=1?(s=(e*c-1)*Math.pow(2,o),a+=f):(s=e*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;t[n+h]=255&s,h+=g,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;t[n+h]=255&a,h+=g,a/=256,u-=8);t[n+h-g]|=128*p}},{}],REa7:[function(t,e,n){var r={}.toString;e.exports=Array.isArray||function(t){return"[object Array]"==r.call(t)}},{}],dskh:[function(t,e,n){arguments[3];var r=arguments[3],o=t("base64-js"),i=t("ieee754"),a=t("isarray");function s(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}function c(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(t,e){if(c()<e)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=l.prototype:(null===t&&(t=new l(e)),t.length=e),t}function l(t,e,n){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(t,e,n);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return g(this,t)}return f(this,t,e,n)}function f(t,e,n,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?y(t,e,n,r):"string"==typeof e?p(t,e,n):m(t,e)}function d(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function h(t,e,n,r){return d(e),e<=0?u(t,e):void 0!==n?"string"==typeof r?u(t,e).fill(n,r):u(t,e).fill(n):u(t,e)}function g(t,e){if(d(e),t=u(t,e<0?0:0|b(e)),!l.TYPED_ARRAY_SUPPORT)for(var n=0;n<e;++n)t[n]=0;return t}function p(t,e,n){if("string"==typeof n&&""!==n||(n="utf8"),!l.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|x(e,n),o=(t=u(t,r)).write(e,n);return o!==r&&(t=t.slice(0,o)),t}function v(t,e){var n=e.length<0?0:0|b(e.length);t=u(t,n);for(var r=0;r<n;r+=1)t[r]=255&e[r];return t}function y(t,e,n,r){if(e.byteLength,n<0||e.byteLength<n)throw new RangeError("'offset' is out of bounds");if(e.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");return e=void 0===n&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,n):new Uint8Array(e,n,r),l.TYPED_ARRAY_SUPPORT?(t=e).__proto__=l.prototype:t=v(t,e),t}function m(t,e){if(l.isBuffer(e)){var n=0|b(e.length);return 0===(t=u(t,n)).length?t:(e.copy(t,0,0,n),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||nt(e.length)?u(t,0):v(t,e);if("Buffer"===e.type&&a(e.data))return v(t,e.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(t){if(t>=c())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c().toString(16)+" bytes");return 0|t}function w(t){return+t!=t&&(t=0),l.alloc(+t)}function x(t,e){if(l.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var n=t.length;if(0===n)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return Q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return tt(t).length;default:if(r)return Q(t).length;e=(""+e).toLowerCase(),r=!0}}function S(t,e,n){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return j(this,e,n);case"utf8":case"utf-8":return k(this,e,n);case"ascii":return L(this,e,n);case"latin1":case"binary":return U(this,e,n);case"base64":return P(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return q(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function R(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function _(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:E(t,e,n,r,o);if("number"==typeof e)return e&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):E(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function E(t,e,n,r,o){var i,a=1,s=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,s/=2,c/=2,n/=2}function u(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(o){var l=-1;for(i=n;i<s;i++)if(u(t,i)===u(e,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(n+c>s&&(n=s-c),i=n;i>=0;i--){for(var f=!0,d=0;d<c;d++)if(u(t,i+d)!==u(e,d)){f=!1;break}if(f)return i}return-1}function A(t,e,n,r){n=Number(n)||0;var o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;var i=e.length;if(i%2!=0)throw new TypeError("Invalid hex string");r>i/2&&(r=i/2);for(var a=0;a<r;++a){var s=parseInt(e.substr(2*a,2),16);if(isNaN(s))return a;t[n+a]=s}return a}function C(t,e,n,r){return et(Q(e,t.length-n),t,n,r)}function O(t,e,n,r){return et(K(e),t,n,r)}function D(t,e,n,r){return O(t,e,n,r)}function T(t,e,n,r){return et(tt(e),t,n,r)}function I(t,e,n,r){return et(Z(e,t.length-n),t,n,r)}function P(t,e,n){return 0===e&&n===t.length?o.fromByteArray(t):o.fromByteArray(t.slice(e,n))}function k(t,e,n){n=Math.min(t.length,n);for(var r=[],o=e;o<n;){var i,a,s,c,u=t[o],l=null,f=u>239?4:u>223?3:u>191?2:1;if(o+f<=n)switch(f){case 1:u<128&&(l=u);break;case 2:128==(192&(i=t[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=t[o+1],a=t[o+2],128==(192&i)&&128==(192&a)&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=t[o+1],a=t[o+2],s=t[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,f=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),o+=f}return M(r)}n.Buffer=l,n.SlowBuffer=w,n.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==r.TYPED_ARRAY_SUPPORT?r.TYPED_ARRAY_SUPPORT:s(),n.kMaxLength=c(),l.poolSize=8192,l._augment=function(t){return t.__proto__=l.prototype,t},l.from=function(t,e,n){return f(null,t,e,n)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(t,e,n){return h(null,t,e,n)},l.allocUnsafe=function(t){return g(null,t)},l.allocUnsafeSlow=function(t){return g(null,t)},l.isBuffer=function(t){return!(null==t||!t._isBuffer)},l.compare=function(t,e){if(!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var n=t.length,r=e.length,o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!a(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);var n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;var r=l.allocUnsafe(e),o=0;for(n=0;n<t.length;++n){var i=t[n];if(!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(r,o),o+=i.length}return r},l.byteLength=x,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)R(this,e,e+1);return this},l.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)R(this,e,e+3),R(this,e+1,e+2);return this},l.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)R(this,e,e+7),R(this,e+1,e+6),R(this,e+2,e+5),R(this,e+3,e+4);return this},l.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?k(this,0,t):S.apply(this,arguments)},l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){var t="",e=n.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},l.prototype.compare=function(t,e,n,r,o){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;for(var i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0),s=Math.min(i,a),c=this.slice(r,o),u=t.slice(e,n),f=0;f<s;++f)if(c[f]!==u[f]){i=c[f],a=u[f];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return _(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return _(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var i=!1;;)switch(r){case"hex":return A(this,t,e,n);case"utf8":case"utf-8":return C(this,t,e,n);case"ascii":return O(this,t,e,n);case"latin1":case"binary":return D(this,t,e,n);case"base64":return T(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var N=4096;function M(t){var e=t.length;if(e<=N)return String.fromCharCode.apply(String,t);for(var n="",r=0;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=N));return n}function L(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function U(t,e,n){var r="";n=Math.min(t.length,n);for(var o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function j(t,e,n){var r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);for(var o="",i=e;i<n;++i)o+=J(t[i]);return o}function q(t,e,n){for(var r=t.slice(e,n),o="",i=0;i<r.length;i+=2)o+=String.fromCharCode(r[i]+256*r[i+1]);return o}function B(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function F(t,e,n,r,o,i){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function W(t,e,n,r){e<0&&(e=65535+e+1);for(var o=0,i=Math.min(t.length-n,2);o<i;++o)t[n+o]=(e&255<<8*(r?o:1-o))>>>8*(r?o:1-o)}function z(t,e,n,r){e<0&&(e=4294967295+e+1);for(var o=0,i=Math.min(t.length-n,4);o<i;++o)t[n+o]=e>>>8*(r?o:3-o)&255}function V(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function G(t,e,n,r,o){return o||V(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function $(t,e,n,r,o){return o||V(t,0,n,8),i.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){var n,r=this.length;if((t=~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),(e=void 0===e?r:~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),l.TYPED_ARRAY_SUPPORT)(n=this.subarray(t,e)).__proto__=l.prototype;else{var o=e-t;n=new l(o,void 0);for(var i=0;i<o;++i)n[i]=this[i+t]}return n},l.prototype.readUIntLE=function(t,e,n){t|=0,e|=0,n||B(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r},l.prototype.readUIntBE=function(t,e,n){t|=0,e|=0,n||B(t,e,this.length);for(var r=this[t+--e],o=1;e>0&&(o*=256);)r+=this[t+--e]*o;return r},l.prototype.readUInt8=function(t,e){return e||B(t,1,this.length),this[t]},l.prototype.readUInt16LE=function(t,e){return e||B(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUInt16BE=function(t,e){return e||B(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUInt32LE=function(t,e){return e||B(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUInt32BE=function(t,e){return e||B(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readIntLE=function(t,e,n){t|=0,e|=0,n||B(t,e,this.length);for(var r=this[t],o=1,i=0;++i<e&&(o*=256);)r+=this[t+i]*o;return r>=(o*=128)&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t|=0,e|=0,n||B(t,e,this.length);for(var r=e,o=1,i=this[t+--r];r>0&&(o*=256);)i+=this[t+--r]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*e)),i},l.prototype.readInt8=function(t,e){return e||B(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){e||B(t,2,this.length);var n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){e||B(t,2,this.length);var n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return e||B(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return e||B(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readFloatLE=function(t,e){return e||B(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return e||B(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return e||B(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return e||B(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e|=0,n|=0,r||F(this,t,e,n,Math.pow(2,8*n)-1,0);var o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e|=0,n|=0,r||F(this,t,e,n,Math.pow(2,8*n)-1,0);var o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},l.prototype.writeUInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,255,0),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):W(this,t,e,!0),e+2},l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):W(this,t,e,!1),e+2},l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):z(this,t,e,!0),e+4},l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):z(this,t,e,!1),e+4},l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);F(this,t,e,n,o-1,-o)}var i=0,a=1,s=0;for(this[e]=255&t;++i<n&&(a*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e|=0,!r){var o=Math.pow(2,8*n-1);F(this,t,e,n,o-1,-o)}var i=n-1,a=1,s=0;for(this[e+i]=255&t;--i>=0&&(a*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/a>>0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,1,127,-128),l.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):W(this,t,e,!0),e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):W(this,t,e,!1),e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):z(this,t,e,!0),e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e|=0,n||F(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),l.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):z(this,t,e,!1),e+4},l.prototype.writeFloatLE=function(t,e,n){return G(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return G(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return $(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return $(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);var o,i=r-n;if(this===t&&n<e&&e<r)for(o=i-1;o>=0;--o)t[o+e]=this[o+n];else if(i<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)t[o+e]=this[o+n];else Uint8Array.prototype.set.call(t,this.subarray(n,n+i),e);return i},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),1===t.length){var o=t.charCodeAt(0);o<256&&(t=o)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;var i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{var a=l.isBuffer(t)?t:Q(new l(t,r).toString()),s=a.length;for(i=0;i<n-e;++i)this[i+e]=a[i%s]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function Y(t){if((t=X(t).replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}function X(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function J(t){return t<16?"0"+t.toString(16):t.toString(16)}function Q(t,e){var n;e=e||1/0;for(var r=t.length,o=null,i=[],a=0;a<r;++a){if((n=t.charCodeAt(a))>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function K(t){for(var e=[],n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}function Z(t,e){for(var n,r,o,i=[],a=0;a<t.length&&!((e-=2)<0);++a)r=(n=t.charCodeAt(a))>>8,o=n%256,i.push(o),i.push(r);return i}function tt(t){return o.toByteArray(Y(t))}function et(t,e,n,r){for(var o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function nt(t){return t!=t}},{"base64-js":"yh9p",ieee754:"JgNJ",isarray:"REa7",buffer:"dskh"}],g3U2:[function(t,e,n){var r;arguments[3],t("buffer").Buffer,arguments[3],t("buffer").Buffer;!function(t,o){"object"==typeof n&&"object"==typeof e?e.exports=o():"function"==typeof r&&r.amd?r([],o):"object"==typeof n?n.Quagga=o():t.Quagga=o()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var o=e[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)n.d(r,o,function(e){return t[e]}.bind(null,o));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=87)}([function(t,e){t.exports=function(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}},function(t,e){t.exports=function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}},function(t,e){function n(e){return t.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},n(e)}t.exports=n},function(t,e){t.exports=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}},function(t,e){function n(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}t.exports=function(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),t}},function(t,e,n){var r=n(19),o=n(1);t.exports=function(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?o(t):e}},function(t,e,n){var r=n(222);t.exports=function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&r(t,e)}},function(t,e,n){t.exports={EPSILON:n(61),create:n(62),clone:n(154),fromValues:n(155),copy:n(156),set:n(157),equals:n(158),exactEquals:n(159),add:n(160),subtract:n(63),sub:n(161),multiply:n(64),mul:n(162),divide:n(65),div:n(163),inverse:n(164),min:n(165),max:n(166),rotate:n(167),floor:n(168),ceil:n(169),round:n(170),scale:n(171),scaleAndAdd:n(172),distance:n(66),dist:n(173),squaredDistance:n(67),sqrDist:n(174),length:n(68),len:n(175),squaredLength:n(69),sqrLen:n(176),negate:n(177),normalize:n(178),dot:n(179),cross:n(180),lerp:n(181),random:n(182),transformMat2:n(183),transformMat2d:n(184),transformMat3:n(185),transformMat4:n(186),forEach:n(187),limit:n(188)}},function(t,e,n){"use strict";n.d(e,"h",function(){return l}),n.d(e,"i",function(){return f}),n.d(e,"b",function(){return d}),n.d(e,"j",function(){return h}),n.d(e,"e",function(){return g}),n.d(e,"c",function(){return p}),n.d(e,"f",function(){return v}),n.d(e,"g",function(){return y}),n.d(e,"a",function(){return b}),n.d(e,"d",function(){return x});var r=n(7),o=n(83),i={clone:r.clone,dot:r.dot},a={create:function(t,e){var n=[],r={rad:0,vec:i.clone([0,0])},o={};function a(t){o[t.id]=t,n.push(t)}function s(){var t,e=0;for(t=0;t<n.length;t++)e+=n[t].rad;r.rad=e/n.length,r.vec=i.clone([Math.cos(r.rad),Math.sin(r.rad)])}return a(t),s(),{add:function(t){o[t.id]||(a(t),s())},fits:function(t){return Math.abs(i.dot(t.point.vec,r.vec))>e},getPoints:function(){return n},getCenter:function(){return r}}},createPoint:function(t,e,n){return{rad:t[n],point:t,id:e}}},s=n(10),c={clone:r.clone},u={clone:o.clone};function l(t,e){return{x:t,y:e,toVec2:function(){return c.clone([this.x,this.y])},toVec3:function(){return u.clone([this.x,this.y,1])},round:function(){return this.x=this.x>0?Math.floor(this.x+.5):Math.floor(this.x-.5),this.y=this.y>0?Math.floor(this.y+.5):Math.floor(this.y-.5),this}}}function f(t,e){var n=function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,r=8-n;function o(t,n){for(var r=0,o=t;o<=n;o++)r+=e[o];return r}function i(t,n){for(var r=0,o=t;o<=n;o++)r+=o*e[o];return r}return function(){var r,a,c,u,l=[0],f=(1<<n)-1;e=function(t,e){e||(e=8);for(var n=t.data,r=n.length,o=8-e,i=new Int32Array(1<<e);r--;)i[n[r]>>o]++;return i}(t,n);for(var d=1;d<f;d++)0==(c=(r=o(0,d))*(a=o(d+1,f)))&&(c=1),u=i(0,d)*a-i(d+1,f)*r,l[d]=u*u/c;return s.a.maxIndex(l)}()<<r}(t);return function(t,e,n){n||(n=t);for(var r=t.data,o=r.length,i=n.data;o--;)i[o]=r[o]<e?1:0}(t,n,e),n}function d(t,e,n){var r,o,i,s,c=[];function u(t){var e=!1;for(o=0;o<c.length;o++)(i=c[o]).fits(t)&&(i.add(t),e=!0);return e}for(n||(n="rad"),r=0;r<t.length;r++)u(s=a.createPoint(t[r],r,n))||c.push(a.create(s,e));return c}function h(t,e,n){var r,o,i,a,s=0,c=0,u=[];for(r=0;r<e;r++)u[r]={score:0,item:null};for(r=0;r<t.length;r++)if((o=n.apply(this,[t[r]]))>c)for((i=u[s]).score=o,i.item=t[r],c=Number.MAX_VALUE,a=0;a<e;a++)u[a].score<c&&(c=u[a].score,s=a);return u}function g(t,e,n){for(var r,o=0,i=e.x,a=Math.floor(t.length/4),s=e.x/2,c=0,u=e.x;i<a;){for(r=0;r<s;r++)n[c]=(.299*t[4*o+0]+.587*t[4*o+1]+.114*t[4*o+2]+(.299*t[4*(o+1)+0]+.587*t[4*(o+1)+1]+.114*t[4*(o+1)+2])+(.299*t[4*i+0]+.587*t[4*i+1]+.114*t[4*i+2])+(.299*t[4*(i+1)+0]+.587*t[4*(i+1)+1]+.114*t[4*(i+1)+2]))/4,c++,o+=2,i+=2;o+=u,i+=u}}function p(t,e,n){var r=t.length/4|0;if(n&&!0===n.singleChannel)for(var o=0;o<r;o++)e[o]=t[4*o+0];else for(var i=0;i<r;i++)e[i]=.299*t[4*i+0]+.587*t[4*i+1]+.114*t[4*i+2]}function v(t,e){for(var n=t.data,r=t.size.x,o=e.data,i=0,a=r,s=n.length,c=r/2,u=0;a<s;){for(var l=0;l<c;l++)o[u]=Math.floor((n[i]+n[i+1]+n[a]+n[a+1])/4),u++,i+=2,a+=2;i+=r,a+=r}}function y(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],n=t[0],r=t[1],o=t[2],i=o*r,a=i*(1-Math.abs(n/60%2-1)),s=o-i,c=0,u=0,l=0;return n<60?(c=i,u=a):n<120?(c=a,u=i):n<180?(u=i,l=a):n<240?(u=a,l=i):n<300?(c=a,l=i):n<360&&(c=i,l=a),e[0]=255*(c+s)|0,e[1]=255*(u+s)|0,e[2]=255*(l+s)|0,e}function m(t){for(var e=[],n=[],r=1;r<Math.sqrt(t)+1;r++)t%r==0&&(n.push(r),r!==t/r&&e.unshift(Math.floor(t/r)));return n.concat(e)}function b(t,e){var n,r=m(e.x),o=m(e.y),i=Math.max(e.x,e.y),a=function(t,e){for(var n=0,r=0,o=[];n<t.length&&r<e.length;)t[n]===e[r]?(o.push(t[n]),n++,r++):t[n]>e[r]?r++:n++;return o}(r,o),s=[8,10,15,20,32,60,80],c={"x-small":5,small:4,medium:3,large:2,"x-large":1},u=c[t]||c.medium,l=s[u],f=Math.floor(i/l);function d(t){for(var e=0,n=t[Math.floor(t.length/2)];e<t.length-1&&t[e]<f;)e++;return e>0&&(n=Math.abs(t[e]-f)>Math.abs(t[e-1]-f)?t[e-1]:t[e]),f/n<s[u+1]/s[u]&&f/n>s[u-1]/s[u]?{x:n,y:n}:null}return(n=d(a))||(n=d(m(i)))||(n=d(m(f*l))),n}var w={top:function(t,e){return"%"===t.unit?Math.floor(e.height*(t.value/100)):null},right:function(t,e){return"%"===t.unit?Math.floor(e.width-e.width*(t.value/100)):null},bottom:function(t,e){return"%"===t.unit?Math.floor(e.height-e.height*(t.value/100)):null},left:function(t,e){return"%"===t.unit?Math.floor(e.width*(t.value/100)):null}};function x(t,e,n){var r={width:t,height:e},o=Object.keys(n).reduce(function(t,e){var o=function(t){return{value:parseFloat(t),unit:(t.indexOf("%"),t.length,"%")}}(n[e]),i=w[e](o,r);return t[e]=i,t},{});return{sx:o.left,sy:o.top,sw:o.right-o.left,sh:o.bottom-o.top}}},function(t,e,n){"use strict";e.a={drawRect:function(t,e,n,r){n.strokeStyle=r.color,n.fillStyle=r.color,n.lineWidth=r.lineWidth||1,n.beginPath(),n.strokeRect(t.x,t.y,e.x,e.y)},drawPath:function(t,e,n,r){n.strokeStyle=r.color,n.fillStyle=r.color,n.lineWidth=r.lineWidth,n.beginPath(),n.moveTo(t[0][e.x],t[0][e.y]);for(var o=1;o<t.length;o++)n.lineTo(t[o][e.x],t[o][e.y]);n.closePath(),n.stroke()},drawImage:function(t,e,n){var r=n.getImageData(0,0,e.x,e.y),o=r.data,i=o.length,a=t.length;if(i/a!=4)return!1;for(;a--;){var s=t[a];o[--i]=255,o[--i]=s,o[--i]=s,o[--i]=s}return n.putImageData(r,0,0),!0}}},function(t,e,n){"use strict";e.a={init:function(t,e){for(var n=t.length;n--;)t[n]=e},shuffle:function(t){for(var e=t.length-1;e>=0;e--){var n=Math.floor(Math.random()*e),r=t[e];t[e]=t[n],t[n]=r}return t},toPointList:function(t){var e=t.reduce(function(t,e){var n="[".concat(e.join(","),"]");return t.push(n),t},[]);return"[".concat(e.join(",\r\n"),"]")},threshold:function(t,e,n){return t.reduce(function(r,o){return n.apply(t,[o])>=e&&r.push(o),r},[])},maxIndex:function(t){for(var e=0,n=0;n<t.length;n++)t[n]>t[e]&&(e=n);return e},max:function(t){for(var e=0,n=0;n<t.length;n++)t[n]>e&&(e=t[n]);return e},sum:function(t){for(var e=t.length,n=0;e--;)n+=t[e];return n}}},function(t,e,n){"use strict";var r=n(82),o=n.n(r),i=n(3),a=n.n(i),s=n(4),c=n.n(s),u=n(0),l=n.n(u),f=n(7),d=n(8),h=n(10),g={clone:f.clone};function p(t){if(t<0)throw new Error("expected positive number, received ".concat(t))}var v=function(){function t(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,o=arguments.length>3?arguments[3]:void 0;a()(this,t),l()(this,"data",void 0),l()(this,"size",void 0),l()(this,"indexMapping",void 0),n?this.data=n:(this.data=new r(e.x*e.y),o&&h.a.init(this.data,0)),this.size=e}return c()(t,[{key:"inImageWithBorder",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return p(e),t.x>=0&&t.y>=0&&t.x<this.size.x+2*e&&t.y<this.size.y+2*e}},{key:"subImageAsCopy",value:function(t,e){p(e.x),p(e.y);for(var n=t.size,r=n.x,o=n.y,i=0;i<r;i++)for(var a=0;a<o;a++)t.data[a*r+i]=this.data[(e.y+a)*this.size.x+e.x+i];return t}},{key:"get",value:function(t,e){return this.data[e*this.size.x+t]}},{key:"getSafe",value:function(t,e){if(!this.indexMapping){this.indexMapping={x:[],y:[]};for(var n=0;n<this.size.x;n++)this.indexMapping.x[n]=n,this.indexMapping.x[n+this.size.x]=n;for(var r=0;r<this.size.y;r++)this.indexMapping.y[r]=r,this.indexMapping.y[r+this.size.y]=r}return this.data[this.indexMapping.y[e+this.size.y]*this.size.x+this.indexMapping.x[t+this.size.x]]}},{key:"set",value:function(t,e,n){return this.data[e*this.size.x+t]=n,delete this.indexMapping,this}},{key:"zeroBorder",value:function(){for(var t=this.size,e=t.x,n=t.y,r=0;r<e;r++)this.data[r]=this.data[(n-1)*e+r]=0;for(var o=1;o<n-1;o++)this.data[o*e]=this.data[o*e+(e-1)]=0;return delete this.indexMapping,this}},{key:"moments",value:function(t){var e,n,r,o,i,a,s,c,u,l,f=this.data,d=this.size.y,h=this.size.x,p=[],v=[],y=Math.PI,m=y/4;if(t<=0)return v;for(i=0;i<t;i++)p[i]={m00:0,m01:0,m10:0,m11:0,m02:0,m20:0,theta:0,rad:0};for(n=0;n<d;n++)for(o=n*n,e=0;e<h;e++)(r=f[n*h+e])>0&&((a=p[r-1]).m00+=1,a.m01+=n,a.m10+=e,a.m11+=e*n,a.m02+=o,a.m20+=e*e);for(i=0;i<t;i++)a=p[i],isNaN(a.m00)||0===a.m00||(c=a.m10/a.m00,u=a.m01/a.m00,s=a.m11/a.m00-c*u,l=(a.m02/a.m00-u*u-(a.m20/a.m00-c*c))/(2*s),l=.5*Math.atan(l)+(s>=0?m:-m)+y,a.theta=(180*l/y+90)%180-90,a.theta<0&&(a.theta+=180),a.rad=l>y?l-y:l,a.vec=g.clone([Math.cos(l),Math.sin(l)]),v.push(a));return v}},{key:"getAsRGBA",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=new Uint8ClampedArray(4*this.size.x*this.size.y),n=0;n<this.size.y;n++)for(var r=0;r<this.size.x;r++){var o=n*this.size.x+r,i=this.get(r,n)*t;e[4*o+0]=i,e[4*o+1]=i,e[4*o+2]=i,e[4*o+3]=255}return e}},{key:"show",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=t.getContext("2d");if(!n)throw new Error("Unable to get canvas context");var r=n.getImageData(0,0,t.width,t.height),o=this.getAsRGBA(e);t.width=this.size.x,t.height=this.size.y;var i=new ImageData(o,r.width,r.height);n.putImageData(i,0,0)}},{key:"overlay",value:function(t,e,n){var r=e<0||e>360?360:e,i=[0,1,1],a=[0,0,0],s=[255,255,255],c=[0,0,0],u=t.getContext("2d");if(!u)throw new Error("Unable to get canvas context");for(var l=u.getImageData(n.x,n.y,this.size.x,this.size.y),f=l.data,h=this.data.length;h--;){i[0]=this.data[h]*r;var g=4*h,p=i[0]<=0?s:i[0]>=360?c:Object(d.g)(i,a),v=o()(p,3);f[g]=v[0],f[g+1]=v[1],f[g+2]=v[2],f[g+3]=255}u.putImageData(l,n.x,n.y)}}]),t}();e.a=v},function(t,e,n){t.exports=n(227)},function(t,e){t.exports=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},function(t,e){var n=Array.isArray;t.exports=n},function(t,e,n){var r=n(88),o=n(143)(function(t,e,n){r(t,e,n)});t.exports=o},function(t,e,n){var r=n(226);function o(e,n,i){return"undefined"!=typeof Reflect&&Reflect.get?t.exports=o=Reflect.get:t.exports=o=function(t,e,n){var o=r(t,e);if(o){var i=Object.getOwnPropertyDescriptor(o,e);return i.get?i.get.call(n):i.value}},o(e,n,i||e)}t.exports=o},function(t,e,n){var r=n(44),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();t.exports=i},function(t,e){t.exports=function(t){return null!=t&&"object"==typeof t}},function(t,e){function n(e){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?t.exports=n=function(t){return typeof t}:t.exports=n=function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(e)}t.exports=n},function(t,e){function n(t,e,n,r,o,i,a){try{var s=t[i](a),c=s.value}catch(t){return void n(t)}s.done?e(c):Promise.resolve(c).then(r,o)}t.exports=function(t){return function(){var e=this,r=arguments;return new Promise(function(o,i){var a=t.apply(e,r);function s(t){n(a,o,i,s,c,"next",t)}function c(t){n(a,o,i,s,c,"throw",t)}s(void 0)})}}},function(t,e,n){"use strict";e.a={searchDirections:[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],create:function(t,e){var n,r=t.data,o=e.data,i=this.searchDirections,a=t.size.x;function s(t,e,s,c){var u,l,f;for(u=0;u<7;u++){if(l=t.cy+i[t.dir][0],f=t.cx+i[t.dir][1],r[n=l*a+f]===e&&(0===o[n]||o[n]===s))return o[n]=s,t.cy=l,t.cx=f,!0;0===o[n]&&(o[n]=c),t.dir=(t.dir+1)%8}return!1}function c(t,e,n){return{dir:n,x:t,y:e,next:null,prev:null}}return{trace:function(t,e,n,r){return s(t,e,n,r)},contourTracing:function(t,e,n,r,o){return function(t,e,n,r,o){var i,a,u,l=null,f={cx:e,cy:t,dir:0};if(s(f,r,n,o)){i=l=c(e,t,f.dir),u=f.dir,(a=c(f.cx,f.cy,0)).prev=i,i.next=a,a.next=null,i=a;do{f.dir=(f.dir+6)%8,s(f,r,n,o),u!==f.dir?(i.dir=f.dir,(a=c(f.cx,f.cy,0)).prev=i,i.next=a,a.next=null,i=a):(i.dir=u,i.x=f.cx,i.y=f.cy),u=f.dir}while(f.cx!==e||f.cy!==t);l.prev=i.prev,i.prev.next=l}return l}(t,e,n,r,o)}}}}},function(t,e,n){var r=n(27),o=n(101),i=n(102),a=r?r.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?o(t):i(t)}},function(t,e,n){"use strict";(function(t){var r,o,i,a,s,c,u,l,f,d,h,g,p=n(7),v=n(34),y=n(11),m=n(8),b=n(10),w=n(9),x=n(85),S=n(21),R=n(86),_={ctx:{binary:null},dom:{binary:null}},E={x:0,y:0};function A(t){var e,n,o,i,s,c,u,l=f.size.x,d=f.size.y,h=-f.size.x,g=-f.size.y;for(e=0,n=0;n<t.length;n++)e+=(i=t[n]).rad,r.debug.showPatches&&w.a.drawRect(i.pos,a.size,_.ctx.binary,{color:"red"});for((e=(180*(e/=t.length)/Math.PI+90)%180-90)<0&&(e+=180),e=(180-e)*Math.PI/180,s=v.copy(v.create(),[Math.cos(e),Math.sin(e),-Math.sin(e),Math.cos(e)]),n=0;n<t.length;n++){for(i=t[n],o=0;o<4;o++)p.transformMat2(i.box[o],i.box[o],s);r.debug.boxFromPatches.showTransformed&&w.a.drawPath(i.box,{x:0,y:1},_.ctx.binary,{color:"#99ff00",lineWidth:2})}for(n=0;n<t.length;n++)for(i=t[n],o=0;o<4;o++)i.box[o][0]<l&&(l=i.box[o][0]),i.box[o][0]>h&&(h=i.box[o][0]),i.box[o][1]<d&&(d=i.box[o][1]),i.box[o][1]>g&&(g=i.box[o][1]);for(c=[[l,d],[h,d],[h,g],[l,g]],r.debug.boxFromPatches.showTransformedBox&&w.a.drawPath(c,{x:0,y:1},_.ctx.binary,{color:"#ff0000",lineWidth:2}),u=r.halfSample?2:1,s=v.invert(s,s),o=0;o<4;o++)p.transformMat2(c[o],c[o],s);for(r.debug.boxFromPatches.showBB&&w.a.drawPath(c,{x:0,y:1},_.ctx.binary,{color:"#ff0000",lineWidth:2}),o=0;o<4;o++)p.scale(c[o],c[o],u);return c}function C(t,e){f.subImageAsCopy(a,Object(m.h)(t,e)),g.skeletonize(),r.debug.showSkeleton&&i.overlay(_.dom.binary,360,Object(m.h)(t,e))}function O(t,e,n,r){var o,i,s,c,u=[],l=[],f=Math.ceil(d.x/3);if(t.length>=2){for(o=0;o<t.length;o++)t[o].m00>f&&u.push(t[o]);if(u.length>=2){for(s=function(t){var e=Object(m.b)(t,.9),n=Object(m.j)(e,1,function(t){return t.getPoints().length}),r=[],o=[];if(1===n.length){r=n[0].item.getPoints();for(var i=0;i<r.length;i++)o.push(r[i].point)}return o}(u),i=0,o=0;o<s.length;o++)i+=s[o].rad;s.length>1&&s.length>=u.length/4*3&&s.length>t.length/4&&(i/=s.length,c={index:e[1]*E.x+e[0],pos:{x:n,y:r},box:[p.clone([n,r]),p.clone([n+a.size.x,r]),p.clone([n+a.size.x,r+a.size.y]),p.clone([n,r+a.size.y])],moments:s,rad:i,vec:p.clone([Math.cos(i),Math.sin(i)])},l.push(c))}}return l}e.a={init:function(e,n){r=n,h=e,function(){o=r.halfSample?new y.a({x:h.size.x/2|0,y:h.size.y/2|0}):h,d=Object(m.a)(r.patchSize,o.size),E.x=o.size.x/d.x|0,E.y=o.size.y/d.y|0,f=new y.a(o.size,void 0,Uint8Array,!1),s=new y.a(d,void 0,Array,!0);var e=new ArrayBuffer(65536);a=new y.a(d,new Uint8Array(e,0,d.x*d.y)),i=new y.a(d,new Uint8Array(e,d.x*d.y*3,d.x*d.y),void 0,!0),g=Object(R.a)("undefined"!=typeof window?window:"undefined"!=typeof self?self:t,{size:d.x},e),l=new y.a({x:o.size.x/a.size.x|0,y:o.size.y/a.size.y|0},void 0,Array,!0),c=new y.a(l.size,void 0,void 0,!0),u=new y.a(l.size,void 0,Int32Array,!0)}(),r.useWorker||"undefined"==typeof document||(_.dom.binary=document.createElement("canvas"),_.dom.binary.className="binaryBuffer",!0===r.debug.showCanvas&&document.querySelector("#debug").appendChild(_.dom.binary),_.ctx.binary=_.dom.binary.getContext("2d"),_.dom.binary.width=f.size.x,_.dom.binary.height=f.size.y)},locate:function(){r.halfSample&&Object(m.f)(h,o),Object(m.i)(o,f),f.zeroBorder(),r.debug.showCanvas&&f.show(_.dom.binary,255);var t=function(){var t,e,n,o,c,u,l,f=[];for(t=0;t<E.x;t++)for(e=0;e<E.y;e++)C(n=a.size.x*t,o=a.size.y*e),i.zeroBorder(),b.a.init(s.data,0),u=x.a.create(i,s).rasterize(0),r.debug.showLabels&&s.overlay(_.dom.binary,Math.floor(360/u.count),{x:n,y:o}),c=s.moments(u.count),f=f.concat(O(c,[t,e],n,o));if(r.debug.showFoundPatches)for(t=0;t<f.length;t++)l=f[t],w.a.drawRect(l.pos,a.size,_.ctx.binary,{color:"#99ff00",lineWidth:2});return f}();if(t.length<E.x*E.y*.05)return null;var e=function(t){var e,n,o=0,i=.95,s=0,f=[0,1,1],d=[0,0,0];function h(){var t;for(t=0;t<u.data.length;t++)if(0===u.data[t]&&1===c.data[t])return t;return u.length}function g(t){var e,n,r,a,s,f=t%u.size.x,d=t/u.size.x|0;if(t<u.data.length)for(r=l.data[t],u.data[t]=o,s=0;s<S.a.searchDirections.length;s++)n=d+S.a.searchDirections[s][0],e=f+S.a.searchDirections[s][1],a=n*u.size.x+e,0!==c.data[a]?0===u.data[a]&&Math.abs(p.dot(l.data[a].vec,r.vec))>i&&g(a):u.data[a]=Number.MAX_VALUE}for(b.a.init(c.data,0),b.a.init(u.data,0),b.a.init(l.data,null),e=0;e<t.length;e++)n=t[e],l.data[n.index]=n,c.data[n.index]=1;for(c.zeroBorder();(s=h())<u.data.length;)o++,g(s);if(r.debug.showPatchLabels)for(e=0;e<u.data.length;e++)u.data[e]>0&&u.data[e]<=o&&(n=l.data[e],f[0]=u.data[e]/(o+1)*360,Object(m.g)(f,d),w.a.drawRect(n.pos,a.size,_.ctx.binary,{color:"rgb(".concat(d.join(","),")"),lineWidth:2}));return o}(t);if(e<1)return null;var n=function(t){var e,n,r=[];for(e=0;e<t;e++)r.push(0);for(n=u.data.length;n--;)u.data[n]>0&&r[u.data[n]-1]++;return(r=r.map(function(t,e){return{val:t,label:e+1}})).sort(function(t,e){return e.val-t.val}),r.filter(function(t){return t.val>=5})}(e);return 0===n.length?null:function(t,e){var n,o,i,s,c,f=[],d=[],h=[0,1,1],g=[0,0,0];for(n=0;n<t.length;n++){for(i=u.data.length,f.length=0;i--;)u.data[i]===t[n].label&&(s=l.data[i],f.push(s));if((c=A(f))&&(d.push(c),r.debug.showRemainingPatchLabels))for(o=0;o<f.length;o++)s=f[o],h[0]=t[n].label/(e+1)*360,Object(m.g)(h,g),w.a.drawRect(s.pos,a.size,_.ctx.binary,{color:"rgb(".concat(g.join(","),")"),lineWidth:2})}return d}(n,e)},checkImageConstraints:function(t,e){var n,r,o=t.getWidth(),i=t.getHeight(),a=e.halfSample?.5:1;t.getConfig().area&&(r=Object(m.d)(o,i,t.getConfig().area),t.setTopRight({x:r.sx,y:r.sy}),t.setCanvasSize({x:o,y:i}),o=r.sw,i=r.sh);var s={x:Math.floor(o*a),y:Math.floor(i*a)};if(n=Object(m.a)(e.patchSize,s),console.log("Patch-Size: ".concat(JSON.stringify(n))),t.setWidth(Math.floor(Math.floor(s.x/n.x)*(1/a)*n.x)),t.setHeight(Math.floor(Math.floor(s.y/n.y)*(1/a)*n.y)),t.getWidth()%n.x==0&&t.getHeight()%n.y==0)return!0;throw new Error("Image dimensions do not comply with the current settings: Width (".concat(o," )and height (").concat(i,") must a multiple of ").concat(n.x))}}}).call(this,n(45))},function(t,e,n){var r=n(90),o=n(91),i=n(92),a=n(93),s=n(94);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,e,n){var r=n(26);t.exports=function(t,e){for(var n=t.length;n--;)if(r(t[n][0],e))return n;return-1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,n){var r=n(17).Symbol;t.exports=r},function(t,e,n){var r=n(35)(Object,"create");t.exports=r},function(t,e,n){var r=n(115);t.exports=function(t,e){var n=t.__data__;return r(e)?n["string"==typeof e?"string":"hash"]:n.map}},function(t,e,n){var r=n(130),o=n(18),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,c=r(function(){return arguments}())?r:function(t){return o(t)&&a.call(t,"callee")&&!s.call(t,"callee")};t.exports=c},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&t>-1&&t%1==0&&t<e}},function(t,e,n){var r=n(14),o=n(231),i=n(232),a=n(235);t.exports=function(t,e){return r(t)?t:o(t,e)?[t]:i(a(t))}},function(t,e,n){var r=n(223),o=n(224),i=n(59),a=n(225);t.exports=function(t){return r(t)||o(t)||i(t)||a()}},function(t,e,n){t.exports={determinant:n(247),transpose:n(248),multiply:n(249),identity:n(250),adjoint:n(251),rotate:n(252),invert:n(253),create:n(254),scale:n(255),copy:n(256),frob:n(257),ldu:n(258)}},function(t,e,n){var r=n(100),o=n(106);t.exports=function(t,e){var n=o(t,e);return r(n)?n:void 0}},function(t,e,n){var r=n(22),o=n(13);t.exports=function(t){if(!o(t))return!1;var e=r(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}},function(t,e,n){var r=n(48);t.exports=function(t,e,n){"__proto__"==e&&r?r(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(36),o=n(40);t.exports=function(t){return null!=t&&o(t.length)&&!r(t)}},function(t,e){t.exports=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}},function(t,e,n){var r=n(22),o=n(18);t.exports=function(t){return"symbol"==typeof t||o(t)&&"[object Symbol]"==r(t)}},function(t,e,n){var r=n(41);t.exports=function(t){if("string"==typeof t||r(t))return t;var e=t+"";return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,n){var r=n(35)(n(17),"Map");t.exports=r},function(t,e,n){(function(e){var n="object"==typeof e&&e&&e.Object===Object&&e;t.exports=n}).call(this,n(45))},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){var r=n(107),o=n(114),i=n(116),a=n(117),s=n(118);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,e,n){var r=n(37),o=n(26);t.exports=function(t,e,n){(void 0===n||o(t[e],n))&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(35),o=function(){try{var t=r(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=o},function(t,e,n){var r=n(129)(Object.getPrototypeOf,Object);t.exports=r},function(t,e){var n=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||n)}},function(t,e,n){(function(t){var r=n(17),o=n(132),i=e&&!e.nodeType&&e,a=i&&"object"==typeof t&&t&&!t.nodeType&&t,s=a&&a.exports===i?r.Buffer:void 0,c=(s?s.isBuffer:void 0)||o;t.exports=c}).call(this,n(38)(t))},function(t,e,n){var r=n(134),o=n(135),i=n(136),a=i&&i.isTypedArray,s=a?o(a):r;t.exports=s},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,n){var r=n(37),o=n(26),i=Object.prototype.hasOwnProperty;t.exports=function(t,e,n){var a=t[e];i.call(t,e)&&o(a,n)&&(void 0!==n||e in t)||r(t,e,n)}},function(t,e,n){var r=n(139),o=n(141),i=n(39);t.exports=function(t){return i(t)?r(t,!0):o(t)}},function(t,e){t.exports=function(t){return t}},function(t,e,n){var r=n(145),o=Math.max;t.exports=function(t,e,n){return e=o(void 0===e?t.length-1:e,0),function(){for(var i=arguments,a=-1,s=o(i.length-e,0),c=Array(s);++a<s;)c[a]=i[e+a];a=-1;for(var u=Array(e+1);++a<e;)u[a]=i[a];return u[e]=n(c),r(t,this,u)}}},function(t,e,n){var r=n(146),o=n(148)(r);t.exports=o},function(t,e,n){var r=n(60);t.exports=function(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(t,e):void 0}}},function(t,e){t.exports=function(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}},function(t,e){t.exports=1e-6},function(t,e){t.exports=function(){var t=new Float32Array(2);return t[0]=0,t[1]=0,t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}},function(t,e){t.exports=function(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}},function(t,e){t.exports=function(t){var e=t[0],n=t[1];return e*e+n*n}},function(t,e){t.exports=1e-6},function(t,e){t.exports=function(){var t=new Float32Array(3);return t[0]=0,t[1]=0,t[2]=0,t}},function(t,e){t.exports=function(t,e,n){var r=new Float32Array(3);return r[0]=t,r[1]=e,r[2]=n,r}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=e[2],i=n*n+r*r+o*o;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i),t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return Math.sqrt(n*n+r*r+o*o)}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=e[2]-t[2];return n*n+r*r+o*o}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}},function(t,e){t.exports=function(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}},function(t,e,n){var r=n(151),o=n(152),i=n(59),a=n(153);t.exports=function(t,e){return r(t)||o(t,e)||i(t,e)||a()}},function(t,e,n){t.exports={EPSILON:n(70),create:n(71),clone:n(189),angle:n(190),fromValues:n(72),copy:n(191),set:n(192),equals:n(193),exactEquals:n(194),add:n(195),subtract:n(75),sub:n(196),multiply:n(76),mul:n(197),divide:n(77),div:n(198),min:n(199),max:n(200),floor:n(201),ceil:n(202),round:n(203),scale:n(204),scaleAndAdd:n(205),distance:n(78),dist:n(206),squaredDistance:n(79),sqrDist:n(207),length:n(80),len:n(208),squaredLength:n(81),sqrLen:n(209),negate:n(210),inverse:n(211),normalize:n(73),dot:n(74),cross:n(212),lerp:n(213),random:n(214),transformMat4:n(215),transformMat3:n(216),transformQuat:n(217),rotateX:n(218),rotateY:n(219),rotateZ:n(220),forEach:n(221)}},function(t,e,n){var r=n(228),o=n(242)(function(t,e){return null==t?{}:r(t,e)});t.exports=o},function(t,e,n){"use strict";var r=n(21),o={createContour2D:function(){return{dir:null,index:null,firstVertex:null,insideContours:null,nextpeer:null,prevpeer:null}},CONTOUR_DIR:{CW_DIR:0,CCW_DIR:1,UNKNOWN_DIR:2},DIR:{OUTSIDE_EDGE:-32767,INSIDE_EDGE:-32766},create:function(t,e){var n=t.data,i=e.data,a=t.size.x,s=t.size.y,c=r.a.create(t,e);return{rasterize:function(t){var e,r,u,l,f,d,h,g,p,v,y,m,b=[],w=0;for(m=0;m<400;m++)b[m]=0;for(b[0]=n[0],p=null,d=1;d<s-1;d++)for(l=0,r=b[0],f=1;f<a-1;f++)if(0===i[y=d*a+f])if((e=n[y])!==r){if(0===l)b[u=w+1]=e,r=e,null!==(h=c.contourTracing(d,f,u,e,o.DIR.OUTSIDE_EDGE))&&(w++,l=u,(g=o.createContour2D()).dir=o.CONTOUR_DIR.CW_DIR,g.index=l,g.firstVertex=h,g.nextpeer=p,g.insideContours=null,null!==p&&(p.prevpeer=g),p=g);else if(null!==(h=c.contourTracing(d,f,o.DIR.INSIDE_EDGE,e,l))){for((g=o.createContour2D()).firstVertex=h,g.insideContours=null,g.dir=0===t?o.CONTOUR_DIR.CCW_DIR:o.CONTOUR_DIR.CW_DIR,g.index=t,v=p;null!==v&&v.index!==l;)v=v.nextpeer;null!==v&&(g.nextpeer=v.insideContours,null!==v.insideContours&&(v.insideContours.prevpeer=g),v.insideContours=g)}}else i[y]=l;else i[y]===o.DIR.OUTSIDE_EDGE||i[y]===o.DIR.INSIDE_EDGE?(l=0,r=i[y]===o.DIR.INSIDE_EDGE?n[y]:b[0]):r=b[l=i[y]];for(v=p;null!==v;)v.index=t,v=v.nextpeer;return{cc:p,count:w}},debug:{drawContour:function(t,e){var n,r,i,a=t.getContext("2d"),s=e;for(a.strokeStyle="red",a.fillStyle="red",a.lineWidth=1,n=null!==s?s.insideContours:null;null!==s;){switch(null!==n?(r=n,n=n.nextpeer):(r=s,n=null!==(s=s.nextpeer)?s.insideContours:null),r.dir){case o.CONTOUR_DIR.CW_DIR:a.strokeStyle="red";break;case o.CONTOUR_DIR.CCW_DIR:a.strokeStyle="blue";break;case o.CONTOUR_DIR.UNKNOWN_DIR:a.strokeStyle="green"}i=r.firstVertex,a.beginPath(),a.moveTo(i.x,i.y);do{i=i.next,a.lineTo(i.x,i.y)}while(i!==r.firstVertex);a.stroke()}}}}}};e.a=o},function(t,e,n){"use strict";e.a=function(t,e,n){"use asm";var r=new t.Uint8Array(n),o=e.size|0,i=t.Math.imul;function a(t,e){t|=0;e|=0;var n=0;var i=0;var a=0;var s=0;var c=0;var u=0;var l=0;var f=0;for(n=1;(n|0)<(o-1|0);n=n+1|0){f=f+o|0;for(i=1;(i|0)<(o-1|0);i=i+1|0){s=f-o|0;c=f+o|0;u=i-1|0;l=i+1|0;a=(r[t+s+u|0]|0)+(r[t+s+l|0]|0)+(r[t+f+i|0]|0)+(r[t+c+u|0]|0)+(r[t+c+l|0]|0)|0;if((a|0)==(5|0)){r[e+f+i|0]=1}else{r[e+f+i|0]=0}}}}function s(t,e,n){t|=0;e|=0;n|=0;var a=0;a=i(o,o)|0;while((a|0)>0){a=a-1|0;r[n+a|0]=(r[t+a|0]|0)-(r[e+a|0]|0)|0}}function c(t,e,n){t|=0;e|=0;n|=0;var a=0;a=i(o,o)|0;while((a|0)>0){a=a-1|0;r[n+a|0]=r[t+a|0]|0|(r[e+a|0]|0)|0}}function u(t){t|=0;var e=0;var n=0;n=i(o,o)|0;while((n|0)>0){n=n-1|0;e=(e|0)+(r[t+n|0]|0)|0}return e|0}function l(t,e){t|=0;e|=0;var n=0;n=i(o,o)|0;while((n|0)>0){n=n-1|0;r[t+n|0]=e}}function f(t,e){t|=0;e|=0;var n=0;var i=0;var a=0;var s=0;var c=0;var u=0;var l=0;var f=0;for(n=1;(n|0)<(o-1|0);n=n+1|0){f=f+o|0;for(i=1;(i|0)<(o-1|0);i=i+1|0){s=f-o|0;c=f+o|0;u=i-1|0;l=i+1|0;a=(r[t+s+u|0]|0)+(r[t+s+l|0]|0)+(r[t+f+i|0]|0)+(r[t+c+u|0]|0)+(r[t+c+l|0]|0)|0;if((a|0)>(0|0)){r[e+f+i|0]=1}else{r[e+f+i|0]=0}}}}function d(t,e){t|=0;e|=0;var n=0;n=i(o,o)|0;while((n|0)>0){n=n-1|0;r[e+n|0]=r[t+n|0]|0}}function h(t){t|=0;var e=0;var n=0;for(e=0;(e|0)<(o-1|0);e=e+1|0){r[t+e|0]=0;r[t+n|0]=0;n=n+o-1|0;r[t+n|0]=0;n=n+1|0}for(e=0;(e|0)<(o|0);e=e+1|0){r[t+n|0]=0;n=n+1|0}}function g(){var t=0;var e=0;var n=0;var r=0;var g=0;var p=0;e=i(o,o)|0;n=e+e|0;r=n+e|0;l(r,0);h(t);do{a(t,e);f(e,n);s(t,n,n);c(r,n,r);d(e,t);g=u(t)|0;p=(g|0)==0|0}while(!p)}return{skeletonize:g}}},function(t,e,n){t.exports=n(259)},function(t,e,n){var r=n(89),o=n(47),i=n(119),a=n(121),s=n(13),c=n(55),u=n(53);t.exports=function t(e,n,l,f,d){e!==n&&i(n,function(i,c){if(d||(d=new r),s(i))a(e,n,c,l,t,f,d);else{var h=f?f(u(e,c),i,c+"",e,n,d):void 0;void 0===h&&(h=i),o(e,c,h)}},c)}},function(t,e,n){var r=n(24),o=n(95),i=n(96),a=n(97),s=n(98),c=n(99);function u(t){var e=this.__data__=new r(t);this.size=e.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=c,t.exports=u},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,n){var r=n(25),o=Array.prototype.splice;t.exports=function(t){var e=this.__data__,n=r(e,t);return!(n<0||(n==e.length-1?e.pop():o.call(e,n,1),--this.size,0))}},function(t,e,n){var r=n(25);t.exports=function(t){var e=this.__data__,n=r(e,t);return n<0?void 0:e[n][1]}},function(t,e,n){var r=n(25);t.exports=function(t){return r(this.__data__,t)>-1}},function(t,e,n){var r=n(25);t.exports=function(t,e){var n=this.__data__,o=r(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}},function(t,e,n){var r=n(24);t.exports=function(){this.__data__=new r,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,n){var r=n(24),o=n(43),i=n(46);t.exports=function(t,e){var n=this.__data__;if(n instanceof r){var a=n.__data__;if(!o||a.length<199)return a.push([t,e]),this.size=++n.size,this;n=this.__data__=new i(a)}return n.set(t,e),this.size=n.size,this}},function(t,e,n){var r=n(36),o=n(103),i=n(13),a=n(105),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,f=u.hasOwnProperty,d=RegExp("^"+l.call(f).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");t.exports=function(t){return!(!i(t)||o(t))&&(r(t)?d:s).test(a(t))}},function(t,e,n){var r=n(27),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=i.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var o=a.call(t);return r&&(e?t[s]=n:delete t[s]),o}},function(t,e){var n=Object.prototype.toString;t.exports=function(t){return n.call(t)}},function(t,e,n){var r,o=n(104),i=(r=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+r:"";t.exports=function(t){return!!i&&i in t}},function(t,e,n){var r=n(17)["__core-js_shared__"];t.exports=r},function(t,e){var n=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return n.call(t)}catch(t){}try{return t+""}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,n){var r=n(108),o=n(24),i=n(43);t.exports=function(){this.size=0,this.__data__={hash:new r,map:new(i||o),string:new r}}},function(t,e,n){var r=n(109),o=n(110),i=n(111),a=n(112),s=n(113);function c(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}c.prototype.clear=r,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,t.exports=c},function(t,e,n){var r=n(28);t.exports=function(){this.__data__=r?r(null):{},this.size=0}},function(t,e){t.exports=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}},function(t,e,n){var r=n(28),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;if(r){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return o.call(e,t)?e[t]:void 0}},function(t,e,n){var r=n(28),o=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return r?void 0!==e[t]:o.call(e,t)}},function(t,e,n){var r=n(28);t.exports=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=r&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,n){var r=n(29);t.exports=function(t){var e=r(this,t).delete(t);return this.size-=e?1:0,e}},function(t,e){t.exports=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,n){var r=n(29);t.exports=function(t){return r(this,t).get(t)}},function(t,e,n){var r=n(29);t.exports=function(t){return r(this,t).has(t)}},function(t,e,n){var r=n(29);t.exports=function(t,e){var n=r(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}},function(t,e,n){var r=n(120)();t.exports=r},function(t,e){t.exports=function(t){return function(e,n,r){for(var o=-1,i=Object(e),a=r(e),s=a.length;s--;){var c=a[t?s:++o];if(!1===n(i[c],c,i))break}return e}}},function(t,e,n){var r=n(47),o=n(122),i=n(123),a=n(126),s=n(127),c=n(30),u=n(14),l=n(131),f=n(51),d=n(36),h=n(13),g=n(133),p=n(52),v=n(53),y=n(137);t.exports=function(t,e,n,m,b,w,x){var S=v(t,n),R=v(e,n),_=x.get(R);if(_)r(t,n,_);else{var E=w?w(S,R,n+"",t,e,x):void 0,A=void 0===E;if(A){var C=u(R),O=!C&&f(R),D=!C&&!O&&p(R);E=R,C||O||D?u(S)?E=S:l(S)?E=a(S):O?(A=!1,E=o(R,!0)):D?(A=!1,E=i(R,!0)):E=[]:g(R)||c(R)?(E=S,c(S)?E=y(S):h(S)&&!d(S)||(E=s(R))):A=!1}A&&(x.set(R,E),b(E,R,m,w,x),x.delete(R)),r(t,n,E)}}},function(t,e,n){(function(t){var r=n(17),o=e&&!e.nodeType&&e,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o?r.Buffer:void 0,s=a?a.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=s?s(n):new t.constructor(n);return t.copy(r),r}}).call(this,n(38)(t))},function(t,e,n){var r=n(124);t.exports=function(t,e){var n=e?r(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}},function(t,e,n){var r=n(125);t.exports=function(t){var e=new t.constructor(t.byteLength);return new r(e).set(new r(t)),e}},function(t,e,n){var r=n(17).Uint8Array;t.exports=r},function(t,e){t.exports=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e}},function(t,e,n){var r=n(128),o=n(49),i=n(50);t.exports=function(t){return"function"!=typeof t.constructor||i(t)?{}:r(o(t))}},function(t,e,n){var r=n(13),o=Object.create,i=function(){function t(){}return function(e){if(!r(e))return{};if(o)return o(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();t.exports=i},function(t,e){t.exports=function(t,e){return function(n){return t(e(n))}}},function(t,e,n){var r=n(22),o=n(18);t.exports=function(t){return o(t)&&"[object Arguments]"==r(t)}},function(t,e,n){var r=n(39),o=n(18);t.exports=function(t){return o(t)&&r(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,n){var r=n(22),o=n(49),i=n(18),a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,l=c.call(Object);t.exports=function(t){if(!i(t)||"[object Object]"!=r(t))return!1;var e=o(t);if(null===e)return!0;var n=u.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&c.call(n)==l}},function(t,e,n){var r=n(22),o=n(40),i=n(18),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return i(t)&&o(t.length)&&!!a[r(t)]}},function(t,e){t.exports=function(t){return function(e){return t(e)}}},function(t,e,n){(function(t){var r=n(44),o=e&&!e.nodeType&&e,i=o&&"object"==typeof t&&t&&!t.nodeType&&t,a=i&&i.exports===o&&r.process,s=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(t){}}();t.exports=s}).call(this,n(38)(t))},function(t,e,n){var r=n(138),o=n(55);t.exports=function(t){return r(t,o(t))}},function(t,e,n){var r=n(54),o=n(37);t.exports=function(t,e,n,i){var a=!n;n||(n={});for(var s=-1,c=e.length;++s<c;){var u=e[s],l=i?i(n[u],t[u],u,n,t):void 0;void 0===l&&(l=t[u]),a?o(n,u,l):r(n,u,l)}return n}},function(t,e,n){var r=n(140),o=n(30),i=n(14),a=n(51),s=n(31),c=n(52),u=Object.prototype.hasOwnProperty;t.exports=function(t,e){var n=i(t),l=!n&&o(t),f=!n&&!l&&a(t),d=!n&&!l&&!f&&c(t),h=n||l||f||d,g=h?r(t.length,String):[],p=g.length;for(var v in t)!e&&!u.call(t,v)||h&&("length"==v||f&&("offset"==v||"parent"==v)||d&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||s(v,p))||g.push(v);return g}},function(t,e){t.exports=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r}},function(t,e,n){var r=n(13),o=n(50),i=n(142),a=Object.prototype.hasOwnProperty;t.exports=function(t){if(!r(t))return i(t);var e=o(t),n=[];for(var s in t)("constructor"!=s||!e&&a.call(t,s))&&n.push(s);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e}},function(t,e,n){var r=n(144),o=n(149);t.exports=function(t){return r(function(e,n){var r=-1,i=n.length,a=i>1?n[i-1]:void 0,s=i>2?n[2]:void 0;for(a=t.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(n[0],n[1],s)&&(a=i<3?void 0:a,i=1),e=Object(e);++r<i;){var c=n[r];c&&t(e,c,r,a)}return e})}},function(t,e,n){var r=n(56),o=n(57),i=n(58);t.exports=function(t,e){return i(o(t,e,r),t+"")}},function(t,e){t.exports=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}},function(t,e,n){var r=n(147),o=n(48),i=n(56),a=o?function(t,e){return o(t,"toString",{configurable:!0,enumerable:!1,value:r(e),writable:!0})}:i;t.exports=a},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var n=Date.now;t.exports=function(t){var e=0,r=0;return function(){var o=n(),i=16-(o-r);if(r=o,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}},function(t,e,n){var r=n(26),o=n(39),i=n(31),a=n(13);t.exports=function(t,e,n){if(!a(n))return!1;var s=typeof e;return!!("number"==s?o(n)&&i(e,n.length):"string"==s&&e in n)&&r(n[e],t)}},function(t,e){"undefined"!=typeof window&&(window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)})),"function"!=typeof Math.imul&&(Math.imul=function(t,e){var n=65535&t,r=65535&e;return n*r+((t>>>16&65535)*r+n*(e>>>16&65535)<<16>>>0)|0}),"function"!=typeof Object.assign&&(Object.assign=function(t){"use strict";if(null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(null!==r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e})},function(t,e){t.exports=function(t){if(Array.isArray(t))return t}},function(t,e){t.exports=function(t,e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var n=[],r=!0,o=!1,i=void 0;try{for(var a,s=t[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==s.return||s.return()}finally{if(o)throw i}}return n}}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e){t.exports=function(t){var e=new Float32Array(2);return e[0]=t[0],e[1]=t[1],e}},function(t,e){t.exports=function(t,e){var n=new Float32Array(2);return n[0]=t,n[1]=e,n}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e,t[1]=n,t}},function(t,e,n){t.exports=function(t,e){var n=t[0],o=t[1],i=e[0],a=e[1];return Math.abs(n-i)<=r*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(o-a)<=r*Math.max(1,Math.abs(o),Math.abs(a))};var r=n(61)},function(t,e){t.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}},function(t,e,n){t.exports=n(63)},function(t,e,n){t.exports=n(64)},function(t,e,n){t.exports=n(65)},function(t,e){t.exports=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}},function(t,e){t.exports=function(t,e,n){var r=Math.cos(n),o=Math.sin(n),i=e[0],a=e[1];return t[0]=i*r-a*o,t[1]=i*o+a*r,t}},function(t,e){t.exports=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}},function(t,e){t.exports=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t}},function(t,e,n){t.exports=n(66)},function(t,e,n){t.exports=n(67)},function(t,e,n){t.exports=n(68)},function(t,e,n){t.exports=n(69)},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=n*n+r*r;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o),t}},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]}},function(t,e){t.exports=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t}},function(t,e){t.exports=function(t,e,n,r){var o=e[0],i=e[1];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t}},function(t,e){t.exports=function(t,e){e=e||1;var n=2*Math.random()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o,t[1]=n[1]*r+n[3]*o,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[2]*o+n[4],t[1]=n[1]*r+n[3]*o+n[5],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[3]*o+n[6],t[1]=n[1]*r+n[4]*o+n[7],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1];return t[0]=n[0]*r+n[4]*o+n[12],t[1]=n[1]*r+n[5]*o+n[13],t}},function(t,e,n){t.exports=function(t,e,n,o,i,a){var s,c;for(e||(e=2),n||(n=0),c=o?Math.min(o*e+n,t.length):t.length,s=n;s<c;s+=e)r[0]=t[s],r[1]=t[s+1],i(r,r,a),t[s]=r[0],t[s+1]=r[1];return t};var r=n(62)()},function(t,e){t.exports=function(t,e,n){var r=e[0]*e[0]+e[1]*e[1];if(r>n*n){var o=Math.sqrt(r);t[0]=e[0]/o*n,t[1]=e[1]/o*n}else t[0]=e[0],t[1]=e[1];return t}},function(t,e){t.exports=function(t){var e=new Float32Array(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(t,e,n){t.exports=function(t,e){var n=r(t[0],t[1],t[2]),a=r(e[0],e[1],e[2]);o(n,n),o(a,a);var s=i(n,a);return s>1?0:Math.acos(s)};var r=n(72),o=n(73),i=n(74)},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(t,e){t.exports=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t}},function(t,e,n){t.exports=function(t,e){var n=t[0],o=t[1],i=t[2],a=e[0],s=e[1],c=e[2];return Math.abs(n-a)<=r*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-s)<=r*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=r*Math.max(1,Math.abs(i),Math.abs(c))};var r=n(70)},function(t,e){t.exports=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}},function(t,e,n){t.exports=n(75)},function(t,e,n){t.exports=n(76)},function(t,e,n){t.exports=n(77)},function(t,e){t.exports=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}},function(t,e){t.exports=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}},function(t,e){t.exports=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}},function(t,e,n){t.exports=n(78)},function(t,e,n){t.exports=n(79)},function(t,e,n){t.exports=n(80)},function(t,e,n){t.exports=n(81)},function(t,e){t.exports=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}},function(t,e){t.exports=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],c=n[2];return t[0]=o*c-i*s,t[1]=i*a-r*c,t[2]=r*s-o*a,t}},function(t,e){t.exports=function(t,e,n,r){var o=e[0],i=e[1],a=e[2];return t[0]=o+r*(n[0]-o),t[1]=i+r*(n[1]-i),t[2]=a+r*(n[2]-a),t}},function(t,e){t.exports=function(t,e){e=e||1;var n=2*Math.random()*Math.PI,r=2*Math.random()-1,o=Math.sqrt(1-r*r)*e;return t[0]=Math.cos(n)*o,t[1]=Math.sin(n)*o,t[2]=r*e,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[3]*r+n[7]*o+n[11]*i+n[15];return a=a||1,t[0]=(n[0]*r+n[4]*o+n[8]*i+n[12])/a,t[1]=(n[1]*r+n[5]*o+n[9]*i+n[13])/a,t[2]=(n[2]*r+n[6]*o+n[10]*i+n[14])/a,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2];return t[0]=r*n[0]+o*n[3]+i*n[6],t[1]=r*n[1]+o*n[4]+i*n[7],t[2]=r*n[2]+o*n[5]+i*n[8],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=n[0],s=n[1],c=n[2],u=n[3],l=u*r+s*i-c*o,f=u*o+c*r-a*i,d=u*i+a*o-s*r,h=-a*r-s*o-c*i;return t[0]=l*u+h*-a+f*-c-d*-s,t[1]=f*u+h*-s+d*-a-l*-c,t[2]=d*u+h*-c+l*-s-f*-a,t}},function(t,e){t.exports=function(t,e,n,r){var o=n[1],i=n[2],a=e[1]-o,s=e[2]-i,c=Math.sin(r),u=Math.cos(r);return t[0]=e[0],t[1]=o+a*u-s*c,t[2]=i+a*c+s*u,t}},function(t,e){t.exports=function(t,e,n,r){var o=n[0],i=n[2],a=e[0]-o,s=e[2]-i,c=Math.sin(r),u=Math.cos(r);return t[0]=o+s*c+a*u,t[1]=e[1],t[2]=i+s*u-a*c,t}},function(t,e){t.exports=function(t,e,n,r){var o=n[0],i=n[1],a=e[0]-o,s=e[1]-i,c=Math.sin(r),u=Math.cos(r);return t[0]=o+a*u-s*c,t[1]=i+a*c+s*u,t[2]=e[2],t}},function(t,e,n){t.exports=function(t,e,n,o,i,a){var s,c;for(e||(e=3),n||(n=0),c=o?Math.min(o*e+n,t.length):t.length,s=n;s<c;s+=e)r[0]=t[s],r[1]=t[s+1],r[2]=t[s+2],i(r,r,a),t[s]=r[0],t[s+1]=r[1],t[s+2]=r[2];return t};var r=n(71)()},function(t,e){function n(e,r){return t.exports=n=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t},n(e,r)}t.exports=n},function(t,e,n){var r=n(60);t.exports=function(t){if(Array.isArray(t))return r(t)}},function(t,e){t.exports=function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}},function(t,e){t.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(t,e,n){var r=n(2);t.exports=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=r(t)););return t}},function(t,e,n){var r=function(t){"use strict";var e,n=Object.prototype,r=n.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(t,e,n,r){var o=e&&e.prototype instanceof p?e:p,i=Object.create(o.prototype),a=new C(r||[]);return i._invoke=function(t,e,n){var r=l;return function(o,i){if(r===d)throw new Error("Generator is already running");if(r===h){if("throw"===o)throw i;return D()}for(n.method=o,n.arg=i;;){var a=n.delegate;if(a){var s=_(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===l)throw r=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var c=u(t,e,n);if("normal"===c.type){if(r=n.done?h:f,c.arg===g)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(r=h,n.method="throw",n.arg=c.arg)}}}(t,n,a),i}function u(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}t.wrap=c;var l="suspendedStart",f="suspendedYield",d="executing",h="completed",g={};function p(){}function v(){}function y(){}var m={};m[i]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(O([])));w&&w!==n&&r.call(w,i)&&(m=w);var x=y.prototype=p.prototype=Object.create(m);function S(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function R(t,e){var n;this._invoke=function(o,i){function a(){return new e(function(n,a){!function n(o,i,a,s){var c=u(t[o],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then(function(t){n("next",t,a,s)},function(t){n("throw",t,a,s)}):e.resolve(f).then(function(t){l.value=t,a(l)},function(t){return n("throw",t,a,s)})}s(c.arg)}(o,i,n,a)})}return n=n?n.then(a,a):a()}}function _(t,n){var r=t.iterator[n.method];if(r===e){if(n.delegate=null,"throw"===n.method){if(t.iterator.return&&(n.method="return",n.arg=e,_(t,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var o=u(r,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,g):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function E(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function A(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(t){if(t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var o=-1,a=function n(){for(;++o<t.length;)if(r.call(t,o))return n.value=t[o],n.done=!1,n;return n.value=e,n.done=!0,n};return a.next=a}}return{next:D}}function D(){return{value:e,done:!0}}return v.prototype=x.constructor=y,y.constructor=v,y[s]=v.displayName="GeneratorFunction",t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===v||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,y):(t.__proto__=y,s in t||(t[s]="GeneratorFunction")),t.prototype=Object.create(x),t},t.awrap=function(t){return{__await:t}},S(R.prototype),R.prototype[a]=function(){return this},t.AsyncIterator=R,t.async=function(e,n,r,o,i){void 0===i&&(i=Promise);var a=new R(c(e,n,r,o),i);return t.isGeneratorFunction(n)?a:a.next().then(function(t){return t.done?t.value:a.next()})},S(x),x[s]="Generator",x[i]=function(){return this},x.toString=function(){return"[object Generator]"},t.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},t.values=O,C.prototype={constructor:C,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(A),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function o(r,o){return s.type="throw",s.arg=t,n.next=r,o&&(n.method="next",n.arg=e),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),A(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;A(n)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:O(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),g}},t}(t.exports);try{regeneratorRuntime=r}catch(t){Function("r","regeneratorRuntime = r")(r)}},function(t,e,n){var r=n(229),o=n(239);t.exports=function(t,e){return r(t,e,function(e,n){return o(t,n)})}},function(t,e,n){var r=n(230),o=n(238),i=n(32);t.exports=function(t,e,n){for(var a=-1,s=e.length,c={};++a<s;){var u=e[a],l=r(t,u);n(l,u)&&o(c,i(u,t),l)}return c}},function(t,e,n){var r=n(32),o=n(42);t.exports=function(t,e){for(var n=0,i=(e=r(e,t)).length;null!=t&&n<i;)t=t[o(e[n++])];return n&&n==i?t:void 0}},function(t,e,n){var r=n(14),o=n(41),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(r(t))return!1;var n=typeof t;return!("number"!=n&&"symbol"!=n&&"boolean"!=n&&null!=t&&!o(t))||a.test(t)||!i.test(t)||null!=e&&t in Object(e)}},function(t,e,n){var r=n(233),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=r(function(t){var e=[];return 46===t.charCodeAt(0)&&e.push(""),t.replace(o,function(t,n,r,o){e.push(r?o.replace(i,"$1"):n||t)}),e});t.exports=a},function(t,e,n){var r=n(234);t.exports=function(t){var e=r(t,function(t){return 500===n.size&&n.clear(),t}),n=e.cache;return e}},function(t,e,n){var r=n(46),o="Expected a function";function i(t,e){if("function"!=typeof t||null!=e&&"function"!=typeof e)throw new TypeError(o);var n=function(){var r=arguments,o=e?e.apply(this,r):r[0],i=n.cache;if(i.has(o))return i.get(o);var a=t.apply(this,r);return n.cache=i.set(o,a)||i,a};return n.cache=new(i.Cache||r),n}i.Cache=r,t.exports=i},function(t,e,n){var r=n(236);t.exports=function(t){return null==t?"":r(t)}},function(t,e,n){var r=n(27),o=n(237),i=n(14),a=n(41),s=r?r.prototype:void 0,c=s?s.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(i(e))return o(e,t)+"";if(a(e))return c?c.call(e):"";var n=e+"";return"0"==n&&1/e==-1/0?"-0":n}},function(t,e){t.exports=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o}},function(t,e,n){var r=n(54),o=n(32),i=n(31),a=n(13),s=n(42);t.exports=function(t,e,n,c){if(!a(t))return t;for(var u=-1,l=(e=o(e,t)).length,f=l-1,d=t;null!=d&&++u<l;){var h=s(e[u]),g=n;if("__proto__"===h||"constructor"===h||"prototype"===h)return t;if(u!=f){var p=d[h];void 0===(g=c?c(p,h,d):void 0)&&(g=a(p)?p:i(e[u+1])?[]:{})}r(d,h,g),d=d[h]}return t}},function(t,e,n){var r=n(240),o=n(241);t.exports=function(t,e){return null!=t&&o(t,e,r)}},function(t,e){t.exports=function(t,e){return null!=t&&e in Object(t)}},function(t,e,n){var r=n(32),o=n(30),i=n(14),a=n(31),s=n(40),c=n(42);t.exports=function(t,e,n){for(var u=-1,l=(e=r(e,t)).length,f=!1;++u<l;){var d=c(e[u]);if(!(f=null!=t&&n(t,d)))break;t=t[d]}return f||++u!=l?f:!!(l=null==t?0:t.length)&&s(l)&&a(d,l)&&(i(t)||o(t))}},function(t,e,n){var r=n(243),o=n(57),i=n(58);t.exports=function(t){return i(o(t,void 0,r),t+"")}},function(t,e,n){var r=n(244);t.exports=function(t){return null!=t&&t.length?r(t,1):[]}},function(t,e,n){var r=n(245),o=n(246);t.exports=function t(e,n,i,a,s){var c=-1,u=e.length;for(i||(i=o),s||(s=[]);++c<u;){var l=e[c];n>0&&i(l)?n>1?t(l,n-1,i,a,s):r(s,l):a||(s[s.length]=l)}return s}},function(t,e){t.exports=function(t,e){for(var n=-1,r=e.length,o=t.length;++n<r;)t[o+n]=e[n];return t}},function(t,e,n){var r=n(27),o=n(30),i=n(14),a=r?r.isConcatSpreadable:void 0;t.exports=function(t){return i(t)||o(t)||!!(a&&t&&t[a])}},function(t,e){t.exports=function(t){return t[0]*t[3]-t[2]*t[1]}},function(t,e){t.exports=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],c=n[1],u=n[2],l=n[3];return t[0]=r*s+i*c,t[1]=o*s+a*c,t[2]=r*u+i*l,t[3]=o*u+a*l,t}},function(t,e){t.exports=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}},function(t,e){t.exports=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=Math.sin(n),c=Math.cos(n);return t[0]=r*c+i*s,t[1]=o*c+a*s,t[2]=r*-s+i*c,t[3]=o*-s+a*c,t}},function(t,e){t.exports=function(t,e){var n=e[0],r=e[1],o=e[2],i=e[3],a=n*i-o*r;return a?(a=1/a,t[0]=i*a,t[1]=-r*a,t[2]=-o*a,t[3]=n*a,t):null}},function(t,e){t.exports=function(){var t=new Float32Array(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}},function(t,e){t.exports=function(t,e,n){var r=e[0],o=e[1],i=e[2],a=e[3],s=n[0],c=n[1];return t[0]=r*s,t[1]=o*s,t[2]=i*c,t[3]=a*c,t}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}},function(t,e){t.exports=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}},function(t,e){t.exports=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]}},function(t,e,n){"use strict";n.r(e),n.d(e,"BarcodeDecoder",function(){return bt}),n.d(e,"BarcodeReader",function(){return D}),n.d(e,"CameraAccess",function(){return Lt}),n.d(e,"ImageDebug",function(){return h.a}),n.d(e,"ImageWrapper",function(){return s.a}),n.d(e,"ResultCollector",function(){return Ut});var r=n(19),o=n.n(r),i=n(15),a=n.n(i),s=(n(150),n(11)),c={},u=1,l=-1;c.getBarcodeLine=function(t,e,n){var r,o,i,a,s,c=0|e.x,u=0|e.y,l=0|n.x,f=0|n.y,d=Math.abs(f-u)>Math.abs(l-c),h=[],g=t.data,p=t.size.x,v=255,y=0;function m(t,e){s=g[e*p+t],v=s<v?s:v,y=s>y?s:y,h.push(s)}d&&(i=c,c=u,u=i,i=l,l=f,f=i),c>l&&(i=c,c=l,l=i,i=u,u=f,f=i);var b=l-c,w=Math.abs(f-u);r=b/2|0,o=u;var x=u<f?1:-1;for(a=c;a<l;a++)d?m(o,a):m(a,o),(r-=w)<0&&(o+=x,r+=b);return{line:h,min:v,max:y}},c.toBinaryLine=function(t){var e,n,r,o,i,a,s=t.min,c=t.max,f=t.line,d=s+(c-s)/2,h=[],g=(c-s)/12,p=-g;for(r=f[0]>d?u:l,h.push({pos:0,val:f[0]}),i=0;i<f.length-2;i++)r!==(o=(e=f[i+1]-f[i])+(n=f[i+2]-f[i+1])<p&&f[i+1]<1.5*d?l:e+n>g&&f[i+1]>.5*d?u:r)&&(h.push({pos:i,val:f[i]}),r=o);for(h.push({pos:f.length,val:f[f.length-1]}),a=h[0].pos;a<h[1].pos;a++)f[a]=f[a]>d?0:1;for(i=1;i<h.length-1;i++)for(g=h[i+1].val>h[i].val?h[i].val+(h[i+1].val-h[i].val)/3*2|0:h[i+1].val+(h[i].val-h[i+1].val)/3|0,a=h[i].pos;a<h[i+1].pos;a++)f[a]=f[a]>g?0:1;return{line:f,threshold:g}},c.debug={printFrequency:function(t,e){var n,r=e.getContext("2d");for(e.width=t.length,e.height=256,r.beginPath(),r.strokeStyle="blue",n=0;n<t.length;n++)r.moveTo(n,255),r.lineTo(n,255-t[n]);r.stroke(),r.closePath()},printPattern:function(t,e){var n,r=e.getContext("2d");for(e.width=t.length,r.fillColor="black",n=0;n<t.length;n++)1===t[n]&&r.fillRect(n,0,1,100)}};var f,d=c,h=n(9),g=n(3),p=n.n(g),v=n(4),y=n.n(v),m=n(1),b=n.n(m),w=n(6),x=n.n(w),S=n(5),R=n.n(S),_=n(2),E=n.n(_),A=n(0),C=n.n(A),O=n(10);!function(t){t[t.Forward=1]="Forward",t[t.Reverse=-1]="Reverse"}(f||(f={}));var D=function(){function t(e,n){return p()(this,t),C()(this,"_row",[]),C()(this,"config",{}),C()(this,"supplements",[]),C()(this,"SINGLE_CODE_ERROR",0),C()(this,"FORMAT","unknown"),C()(this,"CONFIG_KEYS",{}),this._row=[],this.config=e||{},n&&(this.supplements=n),this}return y()(t,[{key:"_nextUnset",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e<t.length;e++)if(!t[e])return e;return t.length}},{key:"_matchPattern",value:function(t,e,n){var r,o=0,i=0,a=0,s=0,c=0,u=0;n=n||this.SINGLE_CODE_ERROR||1;for(var l=0;l<t.length;l++)a+=t[l],s+=e[l];if(a<s)return Number.MAX_VALUE;n*=r=a/s;for(var f=0;f<t.length;f++){if(c=t[f],u=e[f]*r,(i=Math.abs(c-u)/u)>n)return Number.MAX_VALUE;o+=i}return o/s}},{key:"_nextSet",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;e<t.length;e++)if(t[e])return e;return t.length}},{key:"_correctBars",value:function(t,e,n){for(var r=n.length,o=0;r--;)(o=t[n[r]]*(1-(1-e)/2))>1&&(t[n[r]]=o)}},{key:"decodePattern",value:function(t){this._row=t;var e=this._decode();return null===e?(this._row.reverse(),(e=this._decode())&&(e.direction=f.Reverse,e.start=this._row.length-e.start,e.end=this._row.length-e.end)):e.direction=f.Forward,e&&(e.format=this.FORMAT),e}},{key:"_matchRange",value:function(t,e,n){var r;for(r=t=t<0?0:t;r<e;r++)if(this._row[r]!==n)return!1;return!0}},{key:"_fillCounters",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._nextUnset(this._row),e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._row.length,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=[],o=0;r[o]=0;for(var i=t;i<e;i++)this._row[i]^(n?1:0)?r[o]++:(r[++o]=1,n=!n);return r}},{key:"_toCounters",value:function(t,e){var n=e.length,r=this._row.length,o=!this._row[t],i=0;O.a.init(e,0);for(var a=t;a<r;a++)if(this._row[a]^(o?1:0))e[i]++;else{if(++i===n)break;e[i]=1,o=!o}return e}}],[{key:"Exception",get:function(){return{StartNotFoundException:"Start-Info was not found!",CodeNotFoundException:"Code could not be found!",PatternNotFoundException:"Pattern could not be found!"}}}]),t}();var T=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"CODE_SHIFT",98),C()(b()(t),"CODE_C",99),C()(b()(t),"CODE_B",100),C()(b()(t),"CODE_A",101),C()(b()(t),"START_CODE_A",103),C()(b()(t),"START_CODE_B",104),C()(b()(t),"START_CODE_C",105),C()(b()(t),"STOP_CODE",106),C()(b()(t),"CODE_PATTERN",[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]]),C()(b()(t),"SINGLE_CODE_ERROR",.64),C()(b()(t),"AVG_CODE_ERROR",.3),C()(b()(t),"FORMAT","code_128"),C()(b()(t),"MODULE_INDICES",{bar:[0,2,4],space:[1,3,5]}),t}return y()(n,[{key:"_decodeCode",value:function(t,e){for(var n={error:Number.MAX_VALUE,code:-1,start:t,end:t,correction:{bar:1,space:1}},r=[0,0,0,0,0,0],o=t,i=!this._row[o],a=0,s=o;s<this._row.length;s++)if(this._row[s]^(i?1:0))r[a]++;else{if(a===r.length-1){e&&this._correct(r,e);for(var c=0;c<this.CODE_PATTERN.length;c++){var u=this._matchPattern(r,this.CODE_PATTERN[c]);u<n.error&&(n.code=c,n.error=u)}return n.end=s,-1===n.code||n.error>this.AVG_CODE_ERROR?null:(this.CODE_PATTERN[n.code]&&(n.correction.bar=this.calculateCorrection(this.CODE_PATTERN[n.code],r,this.MODULE_INDICES.bar),n.correction.space=this.calculateCorrection(this.CODE_PATTERN[n.code],r,this.MODULE_INDICES.space)),n)}r[++a]=1,i=!i}return null}},{key:"_correct",value:function(t,e){this._correctBars(t,e.bar,this.MODULE_INDICES.bar),this._correctBars(t,e.space,this.MODULE_INDICES.space)}},{key:"_findStart",value:function(){for(var t=[0,0,0,0,0,0],e=this._nextSet(this._row),n={error:Number.MAX_VALUE,code:-1,start:0,end:0,correction:{bar:1,space:1}},r=!1,o=0,i=e;i<this._row.length;i++)if(this._row[i]^(r?1:0))t[o]++;else{if(o===t.length-1){for(var a=t.reduce(function(t,e){return t+e},0),s=this.START_CODE_A;s<=this.START_CODE_C;s++){var c=this._matchPattern(t,this.CODE_PATTERN[s]);c<n.error&&(n.code=s,n.error=c)}if(n.error<this.AVG_CODE_ERROR)return n.start=i-a,n.end=i,n.correction.bar=this.calculateCorrection(this.CODE_PATTERN[n.code],t,this.MODULE_INDICES.bar),n.correction.space=this.calculateCorrection(this.CODE_PATTERN[n.code],t,this.MODULE_INDICES.space),n;for(var u=0;u<4;u++)t[u]=t[u+2];t[4]=0,t[5]=0,o--}else o++;t[o]=1,r=!r}return null}},{key:"_decode",value:function(t,e){var n=this,r=this._findStart();if(null===r)return null;var o={code:r.code,start:r.start,end:r.end,correction:{bar:r.correction.bar,space:r.correction.space}},i=[];i.push(o);for(var a=o.code,s=function(t){switch(o.code){case n.START_CODE_A:return n.CODE_A;case n.START_CODE_B:return n.CODE_B;case n.START_CODE_C:return n.CODE_C;default:return null}}(),c=!1,u=!1,l=u,f=!0,d=0,h=[],g=[];!c;){if(l=u,u=!1,null!==(o=this._decodeCode(o.end,o.correction)))switch(o.code!==this.STOP_CODE&&(f=!0),o.code!==this.STOP_CODE&&(h.push(o.code),a+=++d*o.code),i.push(o),s){case this.CODE_A:if(o.code<64)g.push(String.fromCharCode(32+o.code));else if(o.code<96)g.push(String.fromCharCode(o.code-64));else switch(o.code!==this.STOP_CODE&&(f=!1),o.code){case this.CODE_SHIFT:u=!0,s=this.CODE_B;break;case this.CODE_B:s=this.CODE_B;break;case this.CODE_C:s=this.CODE_C;break;case this.STOP_CODE:c=!0}break;case this.CODE_B:if(o.code<96)g.push(String.fromCharCode(32+o.code));else switch(o.code!==this.STOP_CODE&&(f=!1),o.code){case this.CODE_SHIFT:u=!0,s=this.CODE_A;break;case this.CODE_A:s=this.CODE_A;break;case this.CODE_C:s=this.CODE_C;break;case this.STOP_CODE:c=!0}break;case this.CODE_C:if(o.code<100)g.push(o.code<10?"0"+o.code:o.code);else switch(o.code!==this.STOP_CODE&&(f=!1),o.code){case this.CODE_A:s=this.CODE_A;break;case this.CODE_B:s=this.CODE_B;break;case this.STOP_CODE:c=!0}}else c=!0;l&&(s=s===this.CODE_A?this.CODE_B:this.CODE_A)}return null===o?null:(o.end=this._nextUnset(this._row,o.end),this._verifyTrailingWhitespace(o)?(a-=d*h[h.length-1])%103!==h[h.length-1]?null:g.length?(f&&g.splice(g.length-1,1),{code:g.join(""),start:r.start,end:o.end,codeset:s,startInfo:r,decodedCodes:i,endInfo:o,format:this.FORMAT}):null:null)}},{key:"_verifyTrailingWhitespace",value:function(t){var e;return(e=t.end+(t.end-t.start)/2)<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"calculateCorrection",value:function(t,e,n){for(var r=n.length,o=0,i=0;r--;)i+=t[n[r]],o+=e[n[r]];return i/o}}]),n}(D);function I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function P(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?I(Object(n),!0).forEach(function(e){C()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var k=[1,1,1],N=[1,1,1,1,1],M=[1,1,2],L=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2],[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]],U=[0,11,13,14,19,25,28,21,22,26],j=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(t,r){var o;return p()(this,n),o=e.call(this,a()({supplements:[]},t),r),C()(b()(o),"FORMAT","ean_13"),C()(b()(o),"SINGLE_CODE_ERROR",.7),C()(b()(o),"STOP_PATTERN",[1,1,1]),o}return y()(n,[{key:"_findPattern",value:function(t,e,n,r){var o=new Array(t.length).fill(0),i={error:Number.MAX_VALUE,start:0,end:0},a=0;e||(e=this._nextSet(this._row));for(var s=!1,c=e;c<this._row.length;c++)if(this._row[c]^(n?1:0))o[a]+=1;else{if(a===o.length-1){var u=this._matchPattern(o,t);if(u<.48&&i.error&&u<i.error)return s=!0,i.error=u,i.start=c-o.reduce(function(t,e){return t+e},0),i.end=c,i;if(r){for(var l=0;l<o.length-2;l++)o[l]=o[l+2];o[o.length-2]=0,o[o.length-1]=0,a--}}else a++;o[a]=1,n=!n}return s?i:null}},{key:"_decodeCode",value:function(t,e){var n=[0,0,0,0],r=t,o={error:Number.MAX_VALUE,code:-1,start:t,end:t},i=!this._row[r],a=0;e||(e=L.length);for(var s=r;s<this._row.length;s++)if(this._row[s]^(i?1:0))n[a]++;else{if(a===n.length-1){for(var c=0;c<e;c++){var u=this._matchPattern(n,L[c]);o.end=s,u<o.error&&(o.code=c,o.error=u)}return o.error>.48?null:o}n[++a]=1,i=!i}return null}},{key:"_findStart",value:function(){for(var t=this._nextSet(this._row),e=null;!e;){if(!(e=this._findPattern(k,t,!1,!0)))return null;var n=e.start-(e.end-e.start);if(n>=0&&this._matchRange(n,e.start,0))return e;t=e.end,e=null}return null}},{key:"_calculateFirstDigit",value:function(t){for(var e=0;e<U.length;e++)if(t===U[e])return e;return null}},{key:"_decodePayload",value:function(t,e,n){for(var r=P({},t),o=0,i=0;i<6;i++){if(!(r=this._decodeCode(r.end)))return null;r.code>=10?(r.code-=10,o|=1<<5-i):o|=0<<5-i,e.push(r.code),n.push(r)}var a=this._calculateFirstDigit(o);if(null===a)return null;e.unshift(a);var s=this._findPattern(N,r.end,!0,!1);if(null===s||!s.end)return null;n.push(s);for(var c=0;c<6;c++){if(!(s=this._decodeCode(s.end,10)))return null;n.push(s),e.push(s.code)}return s}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start);return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"_findEnd",value:function(t,e){var n=this._findPattern(this.STOP_PATTERN,t,e,!1);return null!==n?this._verifyTrailingWhitespace(n):null}},{key:"_checksum",value:function(t){for(var e=0,n=t.length-2;n>=0;n-=2)e+=t[n];e*=3;for(var r=t.length-1;r>=0;r-=2)e+=t[r];return e%10==0}},{key:"_decodeExtensions",value:function(t){var e=this._nextSet(this._row,t),n=this._findPattern(M,e,!1,!1);if(null===n)return null;for(var r=0;r<this.supplements.length;r++)try{var o=this.supplements[r]._decode(this._row,n.end);if(null!==o)return{code:o.code,start:e,startInfo:n,end:o.end,decodedCodes:o.decodedCodes,format:this.supplements[r].FORMAT}}catch(t){console.error("* decodeExtensions error in ",this.supplements[r],": ",t)}return null}},{key:"_decode",value:function(t,e){var n=new Array,r=new Array,o={},i=this._findStart();if(!i)return null;var a={start:i.start,end:i.end};if(r.push(a),!(a=this._decodePayload(a,n,r)))return null;if(!(a=this._findEnd(a.end,!1)))return null;if(r.push(a),!this._checksum(n))return null;if(this.supplements.length>0){var s=this._decodeExtensions(a.end);if(!s)return null;if(!s.decodedCodes)return null;var c=s.decodedCodes[s.decodedCodes.length-1],u={start:c.start+((c.end-c.start)/2|0),end:c.end};if(!this._verifyTrailingWhitespace(u))return null;o={supplement:s,code:n.join("")+s.code}}return P(P({code:n.join(""),start:i.start,end:a.end,startInfo:i,decodedCodes:r},o),{},{format:this.FORMAT})}}]),n}(D),q=n(33),B=n.n(q);var F=new Uint16Array(B()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. *$/+%").map(function(t){return t.charCodeAt(0)})),W=new Uint16Array([52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,148,168,162,138,42]),z=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","code_39"),t}return y()(n,[{key:"_findStart",value:function(){for(var t=this._nextSet(this._row),e=t,n=new Uint16Array([0,0,0,0,0,0,0,0,0]),r=0,o=!1,i=t;i<this._row.length;i++)if(this._row[i]^(o?1:0))n[r]++;else{if(r===n.length-1){if(148===this._toPattern(n)){var a=Math.floor(Math.max(0,e-(i-e)/4));if(this._matchRange(a,e,0))return{start:e,end:i}}e+=n[0]+n[1];for(var s=0;s<7;s++)n[s]=n[s+2];n[7]=0,n[8]=0,r--}else r++;n[r]=1,o=!o}return null}},{key:"_toPattern",value:function(t){for(var e=t.length,n=0,r=e,o=0;r>3;){n=this._findNextWidth(t,n),r=0;for(var i=0,a=0;a<e;a++)t[a]>n&&(i|=1<<e-1-a,r++,o+=t[a]);if(3===r){for(var s=0;s<e&&r>0;s++)if(t[s]>n&&(r--,2*t[s]>=o))return-1;return i}}return-1}},{key:"_findNextWidth",value:function(t,e){for(var n=Number.MAX_VALUE,r=0;r<t.length;r++)t[r]<n&&t[r]>e&&(n=t[r]);return n}},{key:"_patternToChar",value:function(t){for(var e=0;e<W.length;e++)if(W[e]===t)return String.fromCharCode(F[e]);return null}},{key:"_verifyTrailingWhitespace",value:function(t,e,n){var r=O.a.sum(n);return 3*(e-t-r)>=r}},{key:"_decode",value:function(t,e){var n=new Uint16Array([0,0,0,0,0,0,0,0,0]),r=[];if(!(e=this._findStart()))return null;var o,i,a=this._nextSet(this._row,e.end);do{n=this._toCounters(a,n);var s=this._toPattern(n);if(s<0)return null;if(null===(o=this._patternToChar(s)))return null;r.push(o),i=a,a+=O.a.sum(n),a=this._nextSet(this._row,a)}while("*"!==o);return r.pop(),r.length&&this._verifyTrailingWhitespace(i,a,n)?{code:r.join(""),start:e.start,end:a,startInfo:e,decodedCodes:r,format:this.FORMAT}:null}}]),n}(D),V=n(16),G=n.n(V);var $=/[IOQ]/g,H=/[A-Z0-9]{17}/,Y=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","code_39_vin"),t}return y()(n,[{key:"_checkChecksum",value:function(t){return!!t}},{key:"_decode",value:function(t,e){var r=G()(E()(n.prototype),"_decode",this).call(this,t,e);if(!r)return null;var o=r.code;return o?(o=o.replace($,"")).match(H)?this._checkChecksum(o)?(r.code=o,r):null:(console.log("Failed AZ09 pattern code:",o),null):null}}]),n}(z);var X=[48,49,50,51,52,53,54,55,56,57,45,36,58,47,46,43,65,66,67,68],J=[3,6,9,96,18,66,33,36,48,72,12,24,69,81,84,21,26,41,11,14],Q=[26,41,11,14],K=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"_counters",[]),C()(b()(t),"FORMAT","codabar"),t}return y()(n,[{key:"_computeAlternatingThreshold",value:function(t,e){for(var n=Number.MAX_VALUE,r=0,o=0,i=t;i<e;i+=2)(o=this._counters[i])>r&&(r=o),o<n&&(n=o);return(n+r)/2|0}},{key:"_toPattern",value:function(t){var e=t+7;if(e>this._counters.length)return-1;for(var n=this._computeAlternatingThreshold(t,e),r=this._computeAlternatingThreshold(t+1,e),o=64,i=0,a=0,s=0;s<7;s++)i=0==(1&s)?n:r,this._counters[t+s]>i&&(a|=o),o>>=1;return a}},{key:"_isStartEnd",value:function(t){for(var e=0;e<Q.length;e++)if(Q[e]===t)return!0;return!1}},{key:"_sumCounters",value:function(t,e){for(var n=0,r=t;r<e;r++)n+=this._counters[r];return n}},{key:"_findStart",value:function(){for(var t=this._nextUnset(this._row),e=1;e<this._counters.length;e++){var n=this._toPattern(e);if(-1!==n&&this._isStartEnd(n))return{start:t+=this._sumCounters(0,e),end:t+this._sumCounters(e,e+8),startCounter:e,endCounter:e+8}}return null}},{key:"_patternToChar",value:function(t){for(var e=0;e<J.length;e++)if(J[e]===t)return String.fromCharCode(X[e]);return null}},{key:"_calculatePatternLength",value:function(t){for(var e=0,n=t;n<t+7;n++)e+=this._counters[n];return e}},{key:"_verifyWhitespace",value:function(t,e){return(t-1<=0||this._counters[t-1]>=this._calculatePatternLength(t)/2)&&(e+8>=this._counters.length||this._counters[e+7]>=this._calculatePatternLength(e)/2)}},{key:"_charToPattern",value:function(t){for(var e=t.charCodeAt(0),n=0;n<X.length;n++)if(X[n]===e)return J[n];return 0}},{key:"_thresholdResultPattern",value:function(t,e){for(var n,r={space:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}},bar:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}}},o=e,i=0;i<t.length;i++){n=this._charToPattern(t[i]);for(var a=6;a>=0;a--){var s=2==(1&a)?r.bar:r.space,c=1==(1&n)?s.wide:s.narrow;c.size+=this._counters[o+a],c.counts++,n>>=1}o+=8}return["space","bar"].forEach(function(t){var e=r[t];e.wide.min=Math.floor((e.narrow.size/e.narrow.counts+e.wide.size/e.wide.counts)/2),e.narrow.max=Math.ceil(e.wide.min),e.wide.max=Math.ceil((2*e.wide.size+1.5)/e.wide.counts)}),r}},{key:"_validateResult",value:function(t,e){for(var n,r=this._thresholdResultPattern(t,e),o=e,i=0;i<t.length;i++){n=this._charToPattern(t[i]);for(var a=6;a>=0;a--){var s=0==(1&a)?r.bar:r.space,c=1==(1&n)?s.wide:s.narrow,u=this._counters[o+a];if(u<c.min||u>c.max)return!1;n>>=1}o+=8}return!0}},{key:"_decode",value:function(t,e){if(this._counters=this._fillCounters(),!(e=this._findStart()))return null;var n,r=e.startCounter,o=[];do{if((n=this._toPattern(r))<0)return null;var i=this._patternToChar(n);if(null===i)return null;if(o.push(i),r+=8,o.length>1&&this._isStartEnd(n))break}while(r<this._counters.length);if(o.length-2<4||!this._isStartEnd(n))return null;if(!this._verifyWhitespace(e.startCounter,r-8))return null;if(!this._validateResult(o,e.startCounter))return null;r=r>this._counters.length?this._counters.length:r;var a=e.start+this._sumCounters(e.startCounter,r-8);return{code:o.join(""),start:e.start,end:a,startInfo:e,decodedCodes:o,format:this.FORMAT}}}]),n}(D);var Z=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","upc_a"),t}return y()(n,[{key:"_decode",value:function(t,e){var n=j.prototype._decode.call(this);return n&&n.code&&13===n.code.length&&"0"===n.code.charAt(0)?(n.code=n.code.substring(1),n):null}}]),n}(j);var tt=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","ean_8"),t}return y()(n,[{key:"_decodePayload",value:function(t,e,n){for(var r=t,o=0;o<4;o++){if(!(r=this._decodeCode(r.end,10)))return null;e.push(r.code),n.push(r)}if(null===(r=this._findPattern(N,r.end,!0,!1)))return null;n.push(r);for(var i=0;i<4;i++){if(!(r=this._decodeCode(r.end,10)))return null;n.push(r),e.push(r.code)}return r}}]),n}(j);var et=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","ean_2"),t}return y()(n,[{key:"_decode",value:function(t,e){t&&(this._row=t);var n=0,r=e,o=this._row.length,i=[],a=[],s=null;if(void 0===r)return null;for(var c=0;c<2&&r<o;c++){if(!(s=this._decodeCode(r)))return null;a.push(s),i.push(s.code%10),s.code>=10&&(n|=1<<1-c),1!==c&&(r=this._nextSet(this._row,s.end),r=this._nextUnset(this._row,r))}if(2!==i.length||parseInt(i.join(""))%4!==n)return null;var u=this._findStart();return{code:i.join(""),decodedCodes:a,end:s.end,format:this.FORMAT,startInfo:u,start:u.start}}}]),n}(j);var nt=[24,20,18,17,12,6,3,10,9,5],rt=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","ean_5"),t}return y()(n,[{key:"_decode",value:function(t,e){if(void 0===e)return null;t&&(this._row=t);for(var n=0,r=e,o=this._row.length,i=null,a=[],s=[],c=0;c<5&&r<o;c++){if(!(i=this._decodeCode(r)))return null;s.push(i),a.push(i.code%10),i.code>=10&&(n|=1<<4-c),4!==c&&(r=this._nextSet(this._row,i.end),r=this._nextUnset(this._row,r))}if(5!==a.length)return null;if(function(t){for(var e=t.length,n=0,r=e-2;r>=0;r-=2)n+=t[r];n*=3;for(var o=e-1;o>=0;o-=2)n+=t[o];return(n*=3)%10}(a)!==function(t){for(var e=0;e<10;e++)if(t===nt[e])return e;return null}(n))return null;var u=this._findStart();return{code:a.join(""),decodedCodes:s,end:i.end,format:this.FORMAT,startInfo:u,start:u.start}}}]),n}(j);function ot(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}var it=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"CODE_FREQUENCY",[[56,52,50,49,44,38,35,42,41,37],[7,11,13,14,19,25,28,21,22,26]]),C()(b()(t),"STOP_PATTERN",[1/6*7,1/6*7,1/6*7,1/6*7,1/6*7,1/6*7]),C()(b()(t),"FORMAT","upc_e"),t}return y()(n,[{key:"_decodePayload",value:function(t,e,n){for(var r=function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ot(Object(n),!0).forEach(function(e){C()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ot(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}({},t),o=0,i=0;i<6;i++){if(!(r=this._decodeCode(r.end)))return null;r.code>=10&&(r.code=r.code-10,o|=1<<5-i),e.push(r.code),n.push(r)}return this._determineParity(o,e)?r:null}},{key:"_determineParity",value:function(t,e){for(var n=0;n<this.CODE_FREQUENCY.length;n++)for(var r=0;r<this.CODE_FREQUENCY[n].length;r++)if(t===this.CODE_FREQUENCY[n][r])return e.unshift(n),e.push(r),!0;return!1}},{key:"_convertToUPCA",value:function(t){var e=[t[0]],n=t[t.length-2];return(e=n<=2?e.concat(t.slice(1,3)).concat([n,0,0,0,0]).concat(t.slice(3,6)):3===n?e.concat(t.slice(1,4)).concat([0,0,0,0,0]).concat(t.slice(4,6)):4===n?e.concat(t.slice(1,5)).concat([0,0,0,0,0,t[5]]):e.concat(t.slice(1,6)).concat([0,0,0,0,n])).push(t[t.length-1]),e}},{key:"_checksum",value:function(t){return G()(E()(n.prototype),"_checksum",this).call(this,this._convertToUPCA(t))}},{key:"_findEnd",value:function(t,e){return G()(E()(n.prototype),"_findEnd",this).call(this,t,!0)}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start)/2;return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}}]),n}(j);var at=1,st=3,ct=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(t){var r;return p()(this,n),r=e.call(this,a()({normalizeBarSpaceWidth:!1},t)),C()(b()(r),"barSpaceRatio",[1,1]),C()(b()(r),"SINGLE_CODE_ERROR",.78),C()(b()(r),"AVG_CODE_ERROR",.38),C()(b()(r),"START_PATTERN",[at,at,at,at]),C()(b()(r),"STOP_PATTERN",[at,at,st]),C()(b()(r),"CODE_PATTERN",[[at,at,st,st,at],[st,at,at,at,st],[at,st,at,at,st],[st,st,at,at,at],[at,at,st,at,st],[st,at,st,at,at],[at,st,st,at,at],[at,at,at,st,st],[st,at,at,st,at],[at,st,at,st,at]]),C()(b()(r),"MAX_CORRECTION_FACTOR",5),C()(b()(r),"FORMAT","i2of5"),t.normalizeBarSpaceWidth&&(r.SINGLE_CODE_ERROR=.38,r.AVG_CODE_ERROR=.09),r.config=t,R()(r,b()(r))}return y()(n,[{key:"_matchPattern",value:function(t,e){if(this.config.normalizeBarSpaceWidth){for(var n=[0,0],r=[0,0],o=[0,0],i=this.MAX_CORRECTION_FACTOR,a=1/i,s=0;s<t.length;s++)n[s%2]+=t[s],r[s%2]+=e[s];o[0]=r[0]/n[0],o[1]=r[1]/n[1],o[0]=Math.max(Math.min(o[0],i),a),o[1]=Math.max(Math.min(o[1],i),a),this.barSpaceRatio=o;for(var c=0;c<t.length;c++)t[c]*=this.barSpaceRatio[c%2]}return D.prototype._matchPattern.call(this,t,e)}},{key:"_findPattern",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=new Array(t.length).fill(0),i=0,a={error:Number.MAX_VALUE,code:-1,start:0,end:0},s=this.AVG_CODE_ERROR;n=n||!1,r=r||!1,e||(e=this._nextSet(this._row));for(var c=e;c<this._row.length;c++)if(this._row[c]^(n?1:0))o[i]++;else{if(i===o.length-1){var u=o.reduce(function(t,e){return t+e},0),l=this._matchPattern(o,t);if(l<s)return a.error=l,a.start=c-u,a.end=c,a;if(!r)return null;for(var f=0;f<o.length-2;f++)o[f]=o[f+2];o[o.length-2]=0,o[o.length-1]=0,i--}else i++;o[i]=1,n=!n}return null}},{key:"_findStart",value:function(){for(var t=0,e=this._nextSet(this._row),n=null,r=1;!n;){if(!(n=this._findPattern(this.START_PATTERN,e,!1,!0)))return null;if(r=Math.floor((n.end-n.start)/4),(t=n.start-10*r)>=0&&this._matchRange(t,n.start,0))return n;e=n.end,n=null}return null}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start)/2;return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"_findEnd",value:function(){this._row.reverse();var t=this._findPattern(this.STOP_PATTERN);if(this._row.reverse(),null===t)return null;var e=t.start;return t.start=this._row.length-t.end,t.end=this._row.length-e,null!==t?this._verifyTrailingWhitespace(t):null}},{key:"_decodePair",value:function(t){for(var e=[],n=0;n<t.length;n++){var r=this._decodeCode(t[n]);if(!r)return null;e.push(r)}return e}},{key:"_decodeCode",value:function(t){for(var e=this.AVG_CODE_ERROR,n={error:Number.MAX_VALUE,code:-1,start:0,end:0},r=0;r<this.CODE_PATTERN.length;r++){var o=this._matchPattern(t,this.CODE_PATTERN[r]);o<n.error&&(n.code=r,n.error=o)}return n.error<e?n:null}},{key:"_decodePayload",value:function(t,e,n){for(var r=0,o=t.length,i=[[0,0,0,0,0],[0,0,0,0,0]],a=null;r<o;){for(var s=0;s<5;s++)i[0][s]=t[r]*this.barSpaceRatio[0],i[1][s]=t[r+1]*this.barSpaceRatio[1],r+=2;if(!(a=this._decodePair(i)))return null;for(var c=0;c<a.length;c++)e.push(a[c].code+""),n.push(a[c])}return a}},{key:"_verifyCounterLength",value:function(t){return t.length%10==0}},{key:"_decode",value:function(t,e){var n=new Array,r=new Array,o=this._findStart();if(!o)return null;r.push(o);var i=this._findEnd();if(!i)return null;var a=this._fillCounters(o.end,i.start,!1);return this._verifyCounterLength(a)&&this._decodePayload(a,n,r)?n.length%2!=0||n.length<6?null:(r.push(i),{code:n.join(""),start:o.start,end:i.end,startInfo:o,decodedCodes:r,format:this.FORMAT}):null}}]),n}(D);var ut=[3,1,3,1,1,1],lt=[3,1,1,1,3],ft=[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]],dt=ut.reduce(function(t,e){return t+e},0),ht=function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"barSpaceRatio",[1,1]),C()(b()(t),"FORMAT","2of5"),C()(b()(t),"SINGLE_CODE_ERROR",.78),C()(b()(t),"AVG_CODE_ERROR",.3),t}return y()(n,[{key:"_findPattern",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],i=0,a={error:Number.MAX_VALUE,code:-1,start:0,end:0},s=0,c=0,u=this.AVG_CODE_ERROR;e||(e=this._nextSet(this._row));for(var l=0;l<t.length;l++)o[l]=0;for(var f=e;f<this._row.length;f++)if(this._row[f]^(n?1:0))o[i]++;else{if(i===o.length-1){s=0;for(var d=0;d<o.length;d++)s+=o[d];if((c=this._matchPattern(o,t))<u)return a.error=c,a.start=f-s,a.end=f,a;if(!r)return null;for(var h=0;h<o.length-2;h++)o[h]=o[h+2];o[o.length-2]=0,o[o.length-1]=0,i--}else i++;o[i]=1,n=!n}return null}},{key:"_findStart",value:function(){for(var t=null,e=this._nextSet(this._row),n=1,r=0;!t;){if(!(t=this._findPattern(ut,e,!1,!0)))return null;if(n=Math.floor((t.end-t.start)/dt),(r=t.start-5*n)>=0&&this._matchRange(r,t.start,0))return t;e=t.end,t=null}return t}},{key:"_verifyTrailingWhitespace",value:function(t){var e=t.end+(t.end-t.start)/2;return e<this._row.length&&this._matchRange(t.end,e,0)?t:null}},{key:"_findEnd",value:function(){this._row.reverse();var t=this._nextSet(this._row),e=this._findPattern(lt,t,!1,!0);if(this._row.reverse(),null===e)return null;var n=e.start;return e.start=this._row.length-e.end,e.end=this._row.length-n,null!==e?this._verifyTrailingWhitespace(e):null}},{key:"_verifyCounterLength",value:function(t){return t.length%10==0}},{key:"_decodeCode",value:function(t){for(var e=this.AVG_CODE_ERROR,n={error:Number.MAX_VALUE,code:-1,start:0,end:0},r=0;r<ft.length;r++){var o=this._matchPattern(t,ft[r]);o<n.error&&(n.code=r,n.error=o)}return n.error<e?n:null}},{key:"_decodePayload",value:function(t,e,n){for(var r=0,o=t.length,i=[0,0,0,0,0],a=null;r<o;){for(var s=0;s<5;s++)i[s]=t[r]*this.barSpaceRatio[0],r+=2;if(!(a=this._decodeCode(i)))return null;e.push("".concat(a.code)),n.push(a)}return a}},{key:"_decode",value:function(t,e){var n=this._findStart();if(!n)return null;var r=this._findEnd();if(!r)return null;var o=this._fillCounters(n.end,r.start,!1);if(!this._verifyCounterLength(o))return null;var i=[];i.push(n);var a=[];return this._decodePayload(o,a,i)?a.length<5?null:(i.push(r),{code:a.join(""),start:n.start,end:r.end,startInfo:n,decodedCodes:i,format:this.FORMAT}):null}}]),n}(D);var gt=new Uint16Array(B()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*").map(function(t){return t.charCodeAt(0)})),pt=new Uint16Array([276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350]);var vt,yt=/[AEIO]/g,mt={code_128_reader:T,ean_reader:j,ean_5_reader:rt,ean_2_reader:et,ean_8_reader:tt,code_39_reader:z,code_39_vin_reader:Y,codabar_reader:K,upc_reader:Z,upc_e_reader:it,i2of5_reader:ct,"2of5_reader":ht,code_93_reader:function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","code_93"),t}return y()(n,[{key:"_patternToChar",value:function(t){for(var e=0;e<pt.length;e++)if(pt[e]===t)return String.fromCharCode(gt[e]);return null}},{key:"_toPattern",value:function(t){for(var e=t.length,n=t.reduce(function(t,e){return t+e},0),r=0,o=0;o<e;o++){var i=Math.round(9*t[o]/n);if(i<1||i>4)return-1;if(0==(1&o))for(var a=0;a<i;a++)r=r<<1|1;else r<<=i}return r}},{key:"_findStart",value:function(){for(var t=this._nextSet(this._row),e=t,n=new Uint16Array([0,0,0,0,0,0]),r=0,o=!1,i=t;i<this._row.length;i++)if(this._row[i]^(o?1:0))n[r]++;else{if(r===n.length-1){if(350===this._toPattern(n)){var a=Math.floor(Math.max(0,e-(i-e)/4));if(this._matchRange(a,e,0))return{start:e,end:i}}e+=n[0]+n[1];for(var s=0;s<4;s++)n[s]=n[s+2];n[4]=0,n[5]=0,r--}else r++;n[r]=1,o=!o}return null}},{key:"_verifyEnd",value:function(t,e){return!(t===e||!this._row[e])}},{key:"_decodeExtended",value:function(t){for(var e=t.length,n=[],r=0;r<e;r++){var o=t[r];if(o>="a"&&o<="d"){if(r>e-2)return null;var i=t[++r],a=i.charCodeAt(0),s=void 0;switch(o){case"a":if(!(i>="A"&&i<="Z"))return null;s=String.fromCharCode(a-64);break;case"b":if(i>="A"&&i<="E")s=String.fromCharCode(a-38);else if(i>="F"&&i<="J")s=String.fromCharCode(a-11);else if(i>="K"&&i<="O")s=String.fromCharCode(a+16);else if(i>="P"&&i<="S")s=String.fromCharCode(a+43);else{if(!(i>="T"&&i<="Z"))return null;s=String.fromCharCode(127)}break;case"c":if(i>="A"&&i<="O")s=String.fromCharCode(a-32);else{if("Z"!==i)return null;s=":"}break;case"d":if(!(i>="A"&&i<="Z"))return null;s=String.fromCharCode(a+32);break;default:return console.warn("* code_93_reader _decodeExtended hit default case, this may be an error",s),null}n.push(s)}else n.push(o)}return n}},{key:"_matchCheckChar",value:function(t,e,n){var r=t.slice(0,e),o=r.length,i=r.reduce(function(t,e,r){return t+((-1*r+(o-1))%n+1)*gt.indexOf(e.charCodeAt(0))},0);return gt[i%47]===t[e].charCodeAt(0)}},{key:"_verifyChecksums",value:function(t){return this._matchCheckChar(t,t.length-2,20)&&this._matchCheckChar(t,t.length-1,15)}},{key:"_decode",value:function(t,e){if(!(e=this._findStart()))return null;var n,r,o=new Uint16Array([0,0,0,0,0,0]),i=[],a=this._nextSet(this._row,e.end);do{o=this._toCounters(a,o);var s=this._toPattern(o);if(s<0)return null;if(null===(r=this._patternToChar(s)))return null;i.push(r),n=a,a+=O.a.sum(o),a=this._nextSet(this._row,a)}while("*"!==r);return i.pop(),i.length&&this._verifyEnd(n,a)&&this._verifyChecksums(i)?(i=i.slice(0,i.length-2),null===(i=this._decodeExtended(i))?null:{code:i.join(""),start:e.start,end:a,startInfo:e,decodedCodes:i,format:this.FORMAT}):null}}]),n}(D),code_32_reader:function(t){x()(n,t);var e=function(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=E()(t);if(e){var o=E()(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return R()(this,n)}}(n);function n(){var t;p()(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return t=e.call.apply(e,[this].concat(o)),C()(b()(t),"FORMAT","code_32_reader"),t}return y()(n,[{key:"_decodeCode32",value:function(t){if(/[^0-9BCDFGHJKLMNPQRSTUVWXYZ]/.test(t))return null;for(var e=0,n=0;n<t.length;n++)e=32*e+"0123456789BCDFGHJKLMNPQRSTUVWXYZ".indexOf(t[n]);var r=""+e;return r.length<9&&(r=("000000000"+r).slice(-9)),"A"+r}},{key:"_checkChecksum",value:function(t){return!!t}},{key:"_decode",value:function(t,e){var r=G()(E()(n.prototype),"_decode",this).call(this,t,e);if(!r)return null;var o=r.code;if(!o)return null;if(o=o.replace(yt,""),!this._checkChecksum(o))return null;var i=this._decodeCode32(o);return i?(r.code=i,r):null}}]),n}(z)},bt={registerReader:function(t,e){mt[t]=e},create:function(t,e){var n={ctx:{frequency:null,pattern:null,overlay:null},dom:{frequency:null,pattern:null,overlay:null}},r=[];function i(){t.readers.forEach(function(t){var e,n={},i=[];"object"===o()(t)?(e=t.format,n=t.config):"string"==typeof t&&(e=t),console.log("Before registering reader: ",e),n.supplements&&(i=n.supplements.map(function(t){return new mt[t]}));try{var a=new mt[e](n,i);r.push(a)}catch(t){throw console.error("* Error constructing reader ",e,t),t}}),console.log("Registered Readers: ".concat(r.map(function(t){return JSON.stringify({format:t.FORMAT,config:t.config})}).join(", ")))}function a(o){var i,a=null,s=d.getBarcodeLine(e,o[0],o[1]);for(t.debug.showFrequency&&(h.a.drawPath(o,{x:"x",y:"y"},n.ctx.overlay,{color:"red",lineWidth:3}),d.debug.printFrequency(s.line,n.dom.frequency)),d.toBinaryLine(s),t.debug.showPattern&&d.debug.printPattern(s.line,n.dom.pattern),i=0;i<r.length&&null===a;i++)a=r[i].decodePattern(s.line);return null===a?null:{codeResult:a,barcodeLine:s}}function s(r){var o,i,s=n.ctx.overlay;t.debug.drawBoundingBox&&s&&h.a.drawPath(r,{x:0,y:1},s,{color:"blue",lineWidth:2});var c=function(t){return Math.sqrt(Math.pow(Math.abs(t[1].y-t[0].y),2)+Math.pow(Math.abs(t[1].x-t[0].x),2))}(o=function(t){return[{x:(t[1][0]-t[0][0])/2+t[0][0],y:(t[1][1]-t[0][1])/2+t[0][1]},{x:(t[3][0]-t[2][0])/2+t[2][0],y:(t[3][1]-t[2][1])/2+t[2][1]}]}(r)),u=Math.atan2(o[1].y-o[0].y,o[1].x-o[0].x);return null===(o=function(t,n,r){function o(e){var r=e*Math.sin(n),o=e*Math.cos(n);t[0].y-=r,t[0].x-=o,t[1].y+=r,t[1].x+=o}for(o(r);r>1&&(!e.inImageWithBorder(t[0])||!e.inImageWithBorder(t[1]));)o(-(r-=Math.ceil(r/2)));return t}(o,u,Math.floor(.1*c)))?null:(null===(i=a(o))&&(i=function(t,e,n){var r,o,i,s=Math.sqrt(Math.pow(t[1][0]-t[0][0],2)+Math.pow(t[1][1]-t[0][1],2)),c=null,u=Math.sin(n),l=Math.cos(n);for(r=1;r<16&&null===c;r++)i={y:(o=s/16*r*(r%2==0?-1:1))*u,x:o*l},e[0].y+=i.x,e[0].x-=i.y,e[1].y+=i.x,e[1].x-=i.y,c=a(e);return c}(r,o,u)),null===i?null:(i&&t.debug.drawScanline&&s&&h.a.drawPath(o,{x:"x",y:"y"},s,{color:"red",lineWidth:3}),{codeResult:i.codeResult,line:o,angle:u,pattern:i.barcodeLine.line,threshold:i.barcodeLine.threshold}))}return function(){if("undefined"!=typeof document){var t=document.querySelector("#debug.detection");n.dom.frequency=document.querySelector("canvas.frequency"),n.dom.frequency||(n.dom.frequency=document.createElement("canvas"),n.dom.frequency.className="frequency",t&&t.appendChild(n.dom.frequency)),n.ctx.frequency=n.dom.frequency.getContext("2d"),n.dom.pattern=document.querySelector("canvas.patternBuffer"),n.dom.pattern||(n.dom.pattern=document.createElement("canvas"),n.dom.pattern.className="patternBuffer",t&&t.appendChild(n.dom.pattern)),n.ctx.pattern=n.dom.pattern.getContext("2d"),n.dom.overlay=document.querySelector("canvas.drawingBuffer"),n.dom.overlay&&(n.ctx.overlay=n.dom.overlay.getContext("2d"))}}(),i(),function(){if("undefined"!=typeof document){var e,r=[{node:n.dom.frequency,prop:t.debug.showFrequency},{node:n.dom.pattern,prop:t.debug.showPattern}];for(e=0;e<r.length;e++)!0===r[e].prop?r[e].node.style.display="block":r[e].node.style.display="none"}}(),{decodeFromBoundingBox:function(t){return s(t)},decodeFromBoundingBoxes:function(e){var n,r,o=[],i=t.multiple;for(n=0;n<e.length;n++){var a=e[n];if((r=s(a)||{}).box=a,i)o.push(r);else if(r.codeResult)return r}if(i)return{barcodes:o}},decodeFromImage:function(t){return function(t){for(var e=null,n=0;n<r.length&&null===e;n++)e=r[n].decodeImage?r[n].decodeImage(t):null;return e}(t)},registerReader:function(t,e){if(mt[t])throw new Error("cannot register existing reader",t);mt[t]=e},setReaders:function(e){t.readers=e,r.length=0,i()}}}},wt=function(){var t={};function e(e){return t[e]||(t[e]={subscribers:[]}),t[e]}function n(t,e){t.async?setTimeout(function(){t.callback(e)},4):t.callback(e)}function r(t,n,r){var o;if("function"==typeof n)o={callback:n,async:r};else if(!(o=n).callback)throw new Error("Callback was not specified on options");e(t).subscribers.push(o)}return{subscribe:function(t,e,n){return r(t,e,n)},publish:function(t,r){var o=e(t),i=o.subscribers;i.filter(function(t){return!!t.once}).forEach(function(t){n(t,r)}),o.subscribers=i.filter(function(t){return!t.once}),o.subscribers.forEach(function(t){n(t,r)})},once:function(t,e){r(t,{callback:e,async:arguments.length>2&&void 0!==arguments[2]&&arguments[2],once:!0})},unsubscribe:function(n,r){if(n){var o=e(n);o.subscribers=o&&r?o.subscribers.filter(function(t){return t.callback!==r}):[]}else t={}}}}(),xt=n(12),St=n.n(xt),Rt=n(20),_t=n.n(Rt),Et=n(84),At=n.n(Et),Ct="This may mean that the user has declined camera access, or the browser does not support media APIs. If you are running in iOS, you must use Safari.";function Ot(){try{return navigator.mediaDevices.enumerateDevices()}catch(e){var t=new Error("enumerateDevices is not defined. ".concat(Ct));return t.code=-1,Promise.reject(t)}}function Dt(t){try{return navigator.mediaDevices.getUserMedia(t)}catch(t){var e=new Error("getUserMedia is not defined. ".concat(Ct));return e.code=-1,Promise.reject(e)}}function Tt(t){return new Promise(function(e,n){var r=10;!function o(){r>0?t.videoWidth>10&&t.videoHeight>10?(console.log("* dev: checkVideo found ".concat(t.videoWidth,"px x ").concat(t.videoHeight,"px")),e()):window.setTimeout(o,500):n(new Error("Unable to play video stream. Is webcam working?")),r--}()})}function It(t,e){return function(){return _t()(St.a.mark(function t(e,n){var r;return St.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Dt(n);case 2:if(r=t.sent,vt=r,!e){t.next=11;break}return e.setAttribute("autoplay","true"),e.setAttribute("muted","true"),e.setAttribute("playsinline","true"),e.srcObject=r,e.addEventListener("loadedmetadata",function(){e.play()}),t.abrupt("return",Tt(e));case 11:return t.abrupt("return",Promise.resolve());case 12:case"end":return t.stop()}},t)})).apply(this,arguments)}.apply(this,arguments)}function Pt(){var t=function(t){var e=At()(t,["width","height","facingMode","aspectRatio","deviceId"]);return void 0!==t.minAspectRatio&&t.minAspectRatio>0&&(e.aspectRatio=t.minAspectRatio,console.log("WARNING: Constraint 'minAspectRatio' is deprecated; Use 'aspectRatio' instead")),void 0!==t.facing&&(e.facingMode=t.facing,console.log("WARNING: Constraint 'facing' is deprecated. Use 'facingMode' instead'")),e}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return t&&t.deviceId&&t.facingMode&&delete t.facingMode,Promise.resolve({audio:!1,video:t})}function kt(){return(kt=_t()(St.a.mark(function t(){var e;return St.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Ot();case 2:return e=t.sent,t.abrupt("return",e.filter(function(t){return"videoinput"===t.kind}));case 4:case"end":return t.stop()}},t)}))).apply(this,arguments)}function Nt(){if(!vt)return null;var t=vt.getVideoTracks();return t&&null!=t&&t.length?t[0]:null}var Mt={requestedVideoElement:null,request:function(t,e){return _t()(St.a.mark(function n(){var r;return St.a.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return Mt.requestedVideoElement=t,n.next=3,Pt(e);case 3:return r=n.sent,n.abrupt("return",It(t,r));case 5:case"end":return n.stop()}},n)}))()},release:function(){var t=vt&&vt.getVideoTracks();return null!==Mt.requestedVideoElement&&Mt.requestedVideoElement.pause(),new Promise(function(e){setTimeout(function(){t&&t.length&&t[0].stop(),vt=null,Mt.requestedVideoElement=null,e()},0)})},enumerateVideoDevices:function(){return kt.apply(this,arguments)},getActiveStreamLabel:function(){var t=Nt();return t?t.label:""},getActiveTrack:Nt},Lt=Mt,Ut={create:function(t){var e,n=document.createElement("canvas"),r=n.getContext("2d"),o=[],i=null!==(e=t.capacity)&&void 0!==e?e:20,a=!0===t.capture;function s(e){return!!i&&e&&!function(t,e){return e&&e.some(function(e){return Object.keys(e).every(function(n){return e[n]===t[n]})})}(e,t.blacklist)&&function(t,e){return"function"!=typeof e||e(t)}(e,t.filter)}return{addResult:function(t,e,c){var u={};s(c)&&(i--,u.codeResult=c,a&&(n.width=e.x,n.height=e.y,h.a.drawImage(t,e,r),u.frame=n.toDataURL()),o.push(u))},getResults:function(){return o}}}},jt={inputStream:{name:"Live",type:"LiveStream",constraints:{width:640,height:480,facingMode:"environment"},area:{top:"0%",right:"0%",left:"0%",bottom:"0%"},singleChannel:!1},locate:!0,numOfWorkers:0,decoder:{readers:["code_128_reader"],debug:{drawBoundingBox:!1,showFrequency:!1,drawScanline:!1,showPattern:!1}},locator:{halfSample:!0,patchSize:"medium",debug:{showCanvas:!1,showPatches:!1,showFoundPatches:!1,showSkeleton:!1,showLabels:!1,showPatchLabels:!1,showRemainingPatchLabels:!1,boxFromPatches:{showTransformed:!1,showTransformedBox:!1,showBB:!1}}}},qt=n(7),Bt=function t(){p()(this,t),C()(this,"config",void 0),C()(this,"inputStream",void 0),C()(this,"framegrabber",void 0),C()(this,"inputImageWrapper",void 0),C()(this,"stopped",!1),C()(this,"boxSize",void 0),C()(this,"resultCollector",void 0),C()(this,"decoder",void 0),C()(this,"workerPool",[]),C()(this,"onUIThread",!0),C()(this,"canvasContainer",new Wt)},Ft=function t(){p()(this,t),C()(this,"image",void 0),C()(this,"overlay",void 0)},Wt=function t(){p()(this,t),C()(this,"ctx",void 0),C()(this,"dom",void 0),this.ctx=new Ft,this.dom=new Ft},zt=n(23);function Vt(t){if("undefined"==typeof document)return null;if(t instanceof HTMLElement&&t.nodeName&&1===t.nodeType)return t;var e="string"==typeof t?t:"#interactive.viewport";return document.querySelector(e)}function Gt(t,e){var n=function(t,e){var n=document.querySelector(t);return n||((n=document.createElement("canvas")).className=e),n}(t,e),r=n.getContext("2d");return{canvas:n,context:r}}var $t={274:"orientation"},Ht=Object.keys($t).map(function(t){return $t[t]});function Yt(t){return new Promise(function(e){var n=new FileReader;n.onload=function(t){return e(t.target.result)},n.readAsArrayBuffer(t)})}function Xt(t,e,n){if("Exif"!==function(t,e,n){for(var r="",o=e;o<e+4;o++)r+=String.fromCharCode(t.getUint8(o));return r}(t,e))return!1;var r,o=e+6;if(18761===t.getUint16(o))r=!1;else{if(19789!==t.getUint16(o))return!1;r=!0}if(42!==t.getUint16(o+2,!r))return!1;var i=t.getUint32(o+4,!r);return!(i<8)&&function(t,e,n,r,o){for(var i=t.getUint16(n,!o),a={},s=0;s<i;s++){var c=n+12*s+2,u=r[t.getUint16(c,!o)];u&&(a[u]=Jt(t,c,e,n,o))}return a}(t,o,o+i,n,r)}function Jt(t,e,n,r,o){var i=t.getUint16(e+2,!o),a=t.getUint32(e+4,!o);switch(i){case 3:if(1===a)return t.getUint16(e+8,!o)}return null}var Qt={};function Kt(t,e){t.onload=function(){e.loaded(this)}}Qt.load=function(t,e,n,r,o){var i,a,s,c=new Array(r),u=new Array(c.length);if(!1===o)c[0]=t;else for(i=0;i<c.length;i++)s=n+i,c[i]="".concat(t,"image-").concat("00".concat(s).slice(-3),".jpg");for(u.notLoaded=[],u.addImage=function(t){u.notLoaded.push(t)},u.loaded=function(n){for(var r=u.notLoaded,i=0;i<r.length;i++)if(r[i]===n){r.splice(i,1);for(var a=0;a<c.length;a++){var s=c[a].substr(c[a].lastIndexOf("/"));if(-1!==n.src.lastIndexOf(s)){u[a]={img:n};break}}break}0===r.length&&(console.log("Images loaded"),!1===o?function(t){var e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ht;return/^blob:/i.test(t)?(e=t,new Promise(function(t,n){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="blob",r.onreadystatechange=function(){r.readyState!==XMLHttpRequest.DONE||200!==r.status&&0!==r.status||t(this.response)},r.onerror=n,r.send()})).then(Yt).then(function(t){return function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ht,n=new DataView(t),r=t.byteLength,o=e.reduce(function(t,e){var n=Object.keys($t).filter(function(t){return $t[t]===e})[0];return n&&(t[n]=e),t},{}),i=2;if(255!==n.getUint8(0)||216!==n.getUint8(1))return!1;for(;i<r;){if(255!==n.getUint8(i))return!1;if(225===n.getUint8(i+1))return Xt(n,i+4,o);i+=2+n.getUint16(i+2)}return!1}(t,n)}):Promise.resolve(null)}(t,["orientation"]).then(function(t){u[0].tags=t,e(u)}).catch(function(t){console.log(t),e(u)}):e(u))},i=0;i<c.length;i++)a=new Image,u.addImage(a),Kt(a,u),a.src=c[i]};var Zt=Qt,te={createVideoStream:function(t){var e,n,r=null,o=["canrecord","ended"],i={},a={x:0,y:0,type:"Point"},s={x:0,y:0,type:"XYSize"},c={getRealWidth:function(){return t.videoWidth},getRealHeight:function(){return t.videoHeight},getWidth:function(){return e},getHeight:function(){return n},setWidth:function(t){e=t},setHeight:function(t){n=t},setInputStream:function(t){r=t,this.setAttribute("src",void 0!==t.src?t.src:"")},ended:function(){return t.ended},getConfig:function(){return r},setAttribute:function(e,n){t&&t.setAttribute(e,n)},pause:function(){t.pause()},play:function(){t.play()},setCurrentTime:function(t){var e;"LiveStream"!==(null===(e=r)||void 0===e?void 0:e.type)&&this.setAttribute("currentTime",t.toString())},addEventListener:function(e,n,r){-1!==o.indexOf(e)?(i[e]||(i[e]=[]),i[e].push(n)):t.addEventListener(e,n,r)},clearEventHandlers:function(){o.forEach(function(e){var n=i[e];n&&n.length>0&&n.forEach(function(n){t.removeEventListener(e,n)})})},trigger:function(o,a){var u,l,f,d,h,g=i[o];if("canrecord"===o&&(d=t.videoWidth,h=t.videoHeight,e=null!==(l=r)&&void 0!==l&&l.size?d/h>1?r.size:Math.floor(d/h*r.size):d,n=null!==(f=r)&&void 0!==f&&f.size?d/h>1?Math.floor(h/d*r.size):r.size:h,s.x=e,s.y=n),g&&g.length>0)for(u=0;u<g.length;u++)g[u].apply(c,a)},setTopRight:function(t){a.x=t.x,a.y=t.y},getTopRight:function(){return a},setCanvasSize:function(t){s.x=t.x,s.y=t.y},getCanvasSize:function(){return s},getFrame:function(){return t}};return c},createLiveStream:function(t){t&&t.setAttribute("autoplay","true");var e=te.createVideoStream(t);return e.ended=function(){return!1},e},createImageStream:function(){var t,e,n=null,r=0,o=0,i=0,a=!0,s=!1,c=null,u=0,l=null,f=!1,d=["canrecord","ended"],h={},g={x:0,y:0,type:"Point"},p={x:0,y:0,type:"XYSize"};function v(t,e){var n,r=h[t];if(r&&r.length>0)for(n=0;n<r.length;n++)r[n].apply(y,e)}var y={trigger:v,getWidth:function(){return t},getHeight:function(){return e},setWidth:function(e){t=e},setHeight:function(t){e=t},getRealWidth:function(){return r},getRealHeight:function(){return o},setInputStream:function(a){var f;n=a,!1===a.sequence?(l=a.src,u=1):(l=a.src,u=a.length),s=!1,Zt.load(l,function(a){var u,l;if(c=a,a[0].tags&&a[0].tags.orientation)switch(a[0].tags.orientation){case 6:case 8:r=a[0].img.height,o=a[0].img.width;break;default:r=a[0].img.width,o=a[0].img.height}else r=a[0].img.width,o=a[0].img.height;t=null!==(u=n)&&void 0!==u&&u.size?r/o>1?n.size:Math.floor(r/o*n.size):r,e=null!==(l=n)&&void 0!==l&&l.size?r/o>1?Math.floor(o/r*n.size):n.size:o,p.x=t,p.y=e,s=!0,i=0,setTimeout(function(){v("canrecord",[])},0)},1,u,null===(f=n)||void 0===f?void 0:f.sequence)},ended:function(){return f},setAttribute:function(){},getConfig:function(){return n},pause:function(){a=!0},play:function(){a=!1},setCurrentTime:function(t){i=t},addEventListener:function(t,e){-1!==d.indexOf(t)&&(h[t]||(h[t]=[]),h[t].push(e))},clearEventHandlers:function(){Object.keys(h).forEach(function(t){return delete h[t]})},setTopRight:function(t){g.x=t.x,g.y=t.y},getTopRight:function(){return g},setCanvasSize:function(t){p.x=t.x,p.y=t.y},getCanvasSize:function(){return p},getFrame:function(){var t,e;return s?(a||(t=null===(e=c)||void 0===e?void 0:e[i],i<u-1?i++:setTimeout(function(){f=!0,v("ended",[])},0)),t):null}};return y}},ee=te,ne=n(8),re=Math.PI/180,oe={create:function(t,e){var n,r={},o=t.getConfig(),i=Object(ne.h)(t.getRealWidth(),t.getRealHeight()),a=t.getCanvasSize(),s=Object(ne.h)(t.getWidth(),t.getHeight()),c=t.getTopRight(),u=c.x,l=c.y,f=null,d=null;return(n=e||document.createElement("canvas")).width=a.x,n.height=a.y,f=n.getContext("2d"),d=new Uint8Array(s.x*s.y),console.log("FrameGrabber",JSON.stringify({size:s,topRight:c,videoSize:i,canvasSize:a})),r.attachData=function(t){d=t},r.getData=function(){return d},r.grab=function(){var e,r,i,c=o.halfSample,h=t.getFrame(),g=h,p=0;if(g){if(i=a,(r=n).width!==i.x&&(console.log("WARNING: canvas-size needs to be adjusted"),r.width=i.x),r.height!==i.y&&(console.log("WARNING: canvas-size needs to be adjusted"),r.height=i.y),"ImageStream"===o.type&&(g=h.img,h.tags&&h.tags.orientation))switch(h.tags.orientation){case 6:p=90*re;break;case 8:p=-90*re}return 0!==p?(f.translate(a.x/2,a.y/2),f.rotate(p),f.drawImage(g,-a.y/2,-a.x/2,a.y,a.x),f.rotate(-p),f.translate(-a.x/2,-a.y/2)):f.drawImage(g,0,0,a.x,a.y),e=f.getImageData(u,l,s.x,s.y).data,c?Object(ne.e)(e,s,d):Object(ne.c)(e,d,o),!0}return!1},r.getSize=function(){return s},r}},ie=oe;function ae(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ae(Object(n),!0).forEach(function(e){C()(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ae(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var ce=[];function ue(t){return se(se({},t),{},{inputStream:se(se({},t.inputStream),{},{target:null})})}function le(t){if(t){var e=t().default;if(!e)return void self.postMessage({event:"error",message:"Quagga could not be created"})}var n;function r(t){self.postMessage({event:"processed",imageData:n.data,result:t},[n.data.buffer])}function o(){self.postMessage({event:"initialized",imageData:n.data},[n.data.buffer])}self.onmessage=function(t){if("init"===t.data.cmd){var i=t.data.config;i.numOfWorkers=0,n=new e.ImageWrapper({x:t.data.size.x,y:t.data.size.y},new Uint8Array(t.data.imageData)),e.init(i,o,n),e.onProcessed(r)}else"process"===t.data.cmd?(n.data=new Uint8Array(t.data.imageData),e.start()):"setReaders"===t.data.cmd?e.setReaders(t.data.readers):"registerReader"===t.data.cmd&&e.registerReader(t.data.name,t.data.reader)}}function fe(t,e,n){var r,o,i=("undefined"!=typeof __factorySource__&&(o=__factorySource__),r=new Blob(["("+le.toString()+")("+o+");"],{type:"text/javascript"}),window.URL.createObjectURL(r)),a={worker:new Worker(i),imageData:new Uint8Array(e.getWidth()*e.getHeight()),busy:!0};a.worker.onmessage=function(t){"initialized"===t.data.event?(URL.revokeObjectURL(i),a.busy=!1,a.imageData=new Uint8Array(t.data.imageData),console.log("Worker initialized"),n(a)):"processed"===t.data.event?(a.imageData=new Uint8Array(t.data.imageData),a.busy=!1):"error"===t.data.event&&console.log("Worker error: "+t.data.message)},a.worker.postMessage({cmd:"init",size:{x:e.getWidth(),y:e.getHeight()},imageData:a.imageData,config:ue(t)},[a.imageData.buffer])}function de(t,e,n,r){var o=t-ce.length;if(0===o&&r)r();else if(o<0)ce.slice(o).forEach(function(t){t.worker.terminate(),console.log("Worker terminated!")}),ce=ce.slice(0,o),r&&r();else{var i=function(e){ce.push(e),ce.length>=t&&r&&r()};if(e)for(var a=0;a<o;a++)fe(e,n,i)}}function he(t,e,n){for(var r=t.length;r--;)t[r][0]+=e,t[r][1]+=n}var ge=function(){function t(){var e=this;p()(this,t),C()(this,"context",new Bt),C()(this,"canRecord",function(t){var n;e.context.config&&(zt.a.checkImageConstraints(e.context.inputStream,null===(n=e.context.config)||void 0===n?void 0:n.locator),e.initCanvas(),e.context.framegrabber=ie.create(e.context.inputStream,e.context.canvasContainer.dom.image),void 0===e.context.config.numOfWorkers&&(e.context.config.numOfWorkers=0),de(e.context.config.numOfWorkers,e.context.config,e.context.inputStream,function(){var n;0===(null===(n=e.context.config)||void 0===n?void 0:n.numOfWorkers)&&e.initializeData(),e.ready(t)}))}),C()(this,"update",function(){if(e.context.onUIThread){var t,n=(o=e.context.framegrabber,ce.length?!!(i=ce.filter(function(t){return!t.busy})[0])&&(o.attachData(i.imageData),o.grab()&&(i.busy=!0,i.worker.postMessage({cmd:"process",imageData:i.imageData},[i.imageData.buffer])),!0):null);n||(e.context.framegrabber.attachData(null===(t=e.context.inputImageWrapper)||void 0===t?void 0:t.data),e.context.framegrabber.grab()&&(n||e.locateAndDecode()))}else{var r;e.context.framegrabber.attachData(null===(r=e.context.inputImageWrapper)||void 0===r?void 0:r.data),e.context.framegrabber.grab(),e.locateAndDecode()}var o,i})}return y()(t,[{key:"initBuffers",value:function(t){if(this.context.config){var e=function(t,e,n){var r=e||new s.a({x:t.getWidth(),y:t.getHeight(),type:"XYSize"});console.log("image wrapper size ".concat(r.size));var o=[Object(qt.clone)([0,0]),Object(qt.clone)([0,r.size.y]),Object(qt.clone)([r.size.x,r.size.y]),Object(qt.clone)([r.size.x,0])];return zt.a.init(r,n),{inputImageWrapper:r,boxSize:o}}(this.context.inputStream,t,this.context.config.locator),n=e.inputImageWrapper,r=e.boxSize;this.context.inputImageWrapper=n,this.context.boxSize=r}}},{key:"initializeData",value:function(t){this.context.config&&(this.initBuffers(t),this.context.decoder=bt.create(this.context.config.decoder,this.context.inputImageWrapper))}},{key:"getViewPort",value:function(){return this.context.config&&this.context.config.inputStream?Vt(this.context.config.inputStream.target):null}},{key:"ready",value:function(t){this.context.inputStream.play(),t()}},{key:"initCanvas",value:function(){var t=function(t){var e,n,r,o,i=Vt(null==t?void 0:null===(e=t.config)||void 0===e?void 0:null===(n=e.inputStream)||void 0===n?void 0:n.target),a=null==t?void 0:null===(r=t.config)||void 0===r?void 0:null===(o=r.inputStream)||void 0===o?void 0:o.type;if(!a)return null;var s=function(t){if("undefined"!=typeof document){var e=Gt("canvas.imgBuffer","imgBuffer"),n=Gt("canvas.drawingBuffer","drawingBuffer");return e.canvas.width=n.canvas.width=t.x,e.canvas.height=n.canvas.height=t.y,{dom:{image:e.canvas,overlay:n.canvas},ctx:{image:e.context,overlay:n.context}}}return null}(t.inputStream.getCanvasSize());if(!s)return{dom:{image:null,overlay:null},ctx:{image:null,overlay:null}};var c=s.dom;return"undefined"!=typeof document&&i&&("ImageStream"!==a||i.contains(c.image)||i.appendChild(c.image),i.contains(c.overlay)||i.appendChild(c.overlay)),s}(this.context);if(t){var e=t.ctx,n=t.dom;this.context.canvasContainer.dom.image=n.image,this.context.canvasContainer.dom.overlay=n.overlay,this.context.canvasContainer.ctx.image=e.image,this.context.canvasContainer.ctx.overlay=e.overlay}}},{key:"initInputStream",value:function(t){if(this.context.config&&this.context.config.inputStream){var e=this.context.config.inputStream,n=e.type,r=e.constraints,o=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LiveStream",e=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;switch(t){case"VideoStream":var r=document.createElement("video");return{video:r,inputStream:n.createVideoStream(r)};case"ImageStream":return{inputStream:n.createImageStream()};case"LiveStream":var o=null;return e&&((o=e.querySelector("video"))||(o=document.createElement("video"),e.appendChild(o))),{video:o,inputStream:n.createLiveStream(o)};default:return console.error("* setupInputStream invalid type ".concat(t)),{video:null,inputStream:null}}}(n,this.getViewPort(),ee),i=o.video,a=o.inputStream;"LiveStream"===n&&i&&Lt.request(i,r).then(function(){return a.trigger("canrecord")}).catch(function(e){return t(e)}),a.setAttribute("preload","auto"),a.setInputStream(this.context.config.inputStream),a.addEventListener("canrecord",this.canRecord.bind(void 0,t)),this.context.inputStream=a}}},{key:"getBoundingBoxes",value:function(){var t;return null!==(t=this.context.config)&&void 0!==t&&t.locate?zt.a.locate():[[Object(qt.clone)(this.context.boxSize[0]),Object(qt.clone)(this.context.boxSize[1]),Object(qt.clone)(this.context.boxSize[2]),Object(qt.clone)(this.context.boxSize[3])]]}},{key:"transformResult",value:function(t){var e=this,n=this.context.inputStream.getTopRight(),r=n.x,o=n.y;if((0!==r||0!==o)&&(t.barcodes&&t.barcodes.forEach(function(t){return e.transformResult(t)}),t.line&&2===t.line.length&&function(t,e,n){t[0].x+=e,t[0].y+=n,t[1].x+=e,t[1].y+=n}(t.line,r,o),t.box&&he(t.box,r,o),t.boxes&&t.boxes.length>0))for(var i=0;i<t.boxes.length;i++)he(t.boxes[i],r,o)}},{key:"addResult",value:function(t,e){var n=this;e&&this.context.resultCollector&&(t.barcodes?t.barcodes.filter(function(t){return t.codeResult}).forEach(function(t){return n.addResult(t,e)}):t.codeResult&&this.context.resultCollector.addResult(e,this.context.inputStream.getCanvasSize(),t.codeResult))}},{key:"hasCodeResult",value:function(t){return!!(t&&(t.barcodes?t.barcodes.some(function(t){return t.codeResult}):t.codeResult))}},{key:"publishResult",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1?arguments[1]:void 0,n=t;t&&this.context.onUIThread&&(this.transformResult(t),this.addResult(t,e),n=t.barcodes||t),wt.publish("processed",n),this.hasCodeResult(t)&&wt.publish("detected",n)}},{key:"locateAndDecode",value:function(){var t=this.getBoundingBoxes();if(t){var e,n=this.context.decoder.decodeFromBoundingBoxes(t)||{};n.boxes=t,this.publishResult(n,null===(e=this.context.inputImageWrapper)||void 0===e?void 0:e.data)}else{var r,o=this.context.decoder.decodeFromImage(this.context.inputImageWrapper);o?this.publishResult(o,null===(r=this.context.inputImageWrapper)||void 0===r?void 0:r.data):this.publishResult()}}},{key:"startContinuousUpdate",value:function(){var t,e=this,n=null,r=1e3/((null===(t=this.context.config)||void 0===t?void 0:t.frequency)||60);this.context.stopped=!1;var o=this.context;!function t(i){n=n||i,o.stopped||(i>=n&&(n+=r,e.update()),window.requestAnimationFrame(t))}(performance.now())}},{key:"start",value:function(){var t,e;this.context.onUIThread&&"LiveStream"===(null===(t=this.context.config)||void 0===t?void 0:null===(e=t.inputStream)||void 0===e?void 0:e.type)?this.startContinuousUpdate():this.update()}},{key:"stop",value:function(){var t=_t()(St.a.mark(function t(){var e;return St.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.context.stopped=!0,de(0),null===(e=this.context.config)||void 0===e||!e.inputStream||"LiveStream"!==this.context.config.inputStream.type){t.next=6;break}return t.next=5,Lt.release();case 5:this.context.inputStream.clearEventHandlers();case 6:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}()},{key:"setReaders",value:function(t){this.context.decoder&&this.context.decoder.setReaders(t),function(t){ce.forEach(function(e){return e.worker.postMessage({cmd:"setReaders",readers:t})})}(t)}},{key:"registerReader",value:function(t,e){bt.registerReader(t,e),this.context.decoder&&this.context.decoder.registerReader(t,e),function(t,e){ce.forEach(function(n){return n.worker.postMessage({cmd:"registerReader",name:t,reader:e})})}(t,e)}}]),t}(),pe=new ge,ve=pe.context,ye={init:function(t,e,n){var r,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:pe;return e||(r=new Promise(function(t,n){e=function(e){e?n(e):t()}})),o.context.config=a()({},jt,t),o.context.config.numOfWorkers>0&&(o.context.config.numOfWorkers=0),n?(o.context.onUIThread=!1,o.initializeData(n),e&&e()):o.initInputStream(e),r},start:function(){return pe.start()},stop:function(){return pe.stop()},pause:function(){ve.stopped=!0},onDetected:function(t){t&&("function"==typeof t||"object"===o()(t)&&t.callback)?wt.subscribe("detected",t):console.trace("* warning: Quagga.onDetected called with invalid callback, ignoring")},offDetected:function(t){wt.unsubscribe("detected",t)},onProcessed:function(t){t&&("function"==typeof t||"object"===o()(t)&&t.callback)?wt.subscribe("processed",t):console.trace("* warning: Quagga.onProcessed called with invalid callback, ignoring")},offProcessed:function(t){wt.unsubscribe("processed",t)},setReaders:function(t){t?pe.setReaders(t):console.trace("* warning: Quagga.setReaders called with no readers, ignoring")},registerReader:function(t,e){t?e?pe.registerReader(t,e):console.trace("* warning: Quagga.registerReader called with no reader, ignoring"):console.trace("* warning: Quagga.registerReader called with no name, ignoring")},registerResultCollector:function(t){t&&"function"==typeof t.addResult&&(ve.resultCollector=t)},get canvas(){return ve.canvasContainer},decodeSingle:function(t,e){var n=this,r=new ge;return(t=a()({inputStream:{type:"ImageStream",sequence:!1,size:800,src:t.src},numOfWorkers:t.debug?0:1,locator:{halfSample:!1}},t)).numOfWorkers>0&&(t.numOfWorkers=0),t.numOfWorkers>0&&("undefined"==typeof Blob||"undefined"==typeof Worker)&&(console.warn("* no Worker and/or Blob support - forcing numOfWorkers to 0"),t.numOfWorkers=0),new Promise(function(o,i){try{n.init(t,function(){wt.once("processed",function(t){r.stop(),e&&e.call(null,t),o(t)},!0),r.start()},null,r)}catch(t){i(t)}})},get default(){return ye},BarcodeReader:D,CameraAccess:Lt,ImageDebug:h.a,ImageWrapper:s.a,ResultCollector:Ut};e.default=ye}]).default})},{buffer:"dskh"}],dfhR:[function(t,e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var r=function(t){return t&&t.__esModule?t:{default:t}}(t("./quagga.js"));class o{constructor(){this.lastResult=null}async init(t){this.target=t.inputStream.target,await new Promise((e,n)=>{r.default.init(t,t=>{if(t)return console.log("BARCODE: Init error: "+t),void n(t);console.log("BARCODE: Init finished"),e()})})}async start(){await this.stop(),r.default.start(),this.callbackDetected=this.detected.bind(this),r.default.onDetected(this.callbackDetected),this.callbackProcessed=null,this.callbackProcessed&&r.default.onProcessed(this.callbackProcessed),this.started=!0}detected(t){t.codeResult&&t.codeResult.code&&(this.lastResult=t.codeResult.code,console.log("BARCODE: Detected: "+this.lastResult+" -- "+JSON.stringify(t.codeResult)),this.promiseScanCancelResolve&&this.promiseScanCancelResolve(this.lastResult),this.promiseScanCancelResolve=null,this.promiseScanCancelReject=null)}processed(t){}async stop(){this.callbackDetected&&(r.default.offDetected(this.callbackDetected),this.callbackDetected=null),this.callbackProcessed&&(r.default.offProcessed(this.callbackProcessed),this.callbackProcessed=null),this.started&&(await r.default.stop(),this.started=!1);const t=this.promiseScanCancelResolve;this.lastResult=null,this.promiseScanCancelResolve=null,this.promiseScanCancelReject=null,t&&t(this.lastResult)}async waitForScanOrCancel(){return new Promise((t,e)=>{this.promiseScanCancelResolve=t,this.promiseScanCancelReject=e})}}n.default=o,o.instance=null,o.cancel=async()=>{o.instance&&await o.instance.stop()},o.scan=async t=>{const e=t&&t.elementSelector?t.elementSelector:"#interactive.viewport";o.instance||(o.instance=new o);const n={inputStream:{name:"Live",type:"LiveStream",constraints:{facingMode:"environment"},target:document.querySelector(e)},decoder:{readers:["code_128_reader"],debug:!1}},r={code_128:"code_128_reader",ean:"ean_reader",ean_8:"ean_8_reader",code_39:"code_39_reader",code_39_vin:"code_39_vin_reader",codabar:"codabar_reader",upc:"upc_reader",upc_e:"upc_e_reader",i2of5:"i2of5_reader","2of5":"2of5_reader",code_93:"code_93_reader"},i=(t&&t.readers?t.readers:"code_128").split(",");if(i.length>0){n.decoder.readers=[];for(const t of i){const e=r[t];if(!e)throw new Exception("Unknown barcode type: "+t);n.decoder.readers.push(e)}}let a=null;try{await o.instance.init(n),await o.instance.start(),a=await o.instance.waitForScanOrCancel()}finally{await o.instance.stop(),document.querySelector(e).innerHTML=""}return a}},{"./quagga.js":"g3U2"}],jOUA:[function(t,e,n){"use strict";var r=t("./util.mjs"),o=c(t("./key_input.mjs")),i=c(t("./device_manager.mjs")),a=c(t("./barcode.mjs")),s=t("./cwa_parse.mjs");function c(t){return t&&t.__esModule?t:{default:t}}window.addEventListener("error",function(t){return document.getElementById("warnings").appendChild(document.createTextNode("⚠️ Unhandled error.")),console.log("ERROR: Unhandled error: "+(t.error&&t.error.message?t.error.message:t.error)),console.log(JSON.stringify(t)),!1}),window.addEventListener("unhandledrejection",function(t){return document.getElementById("warnings").appendChild(document.createTextNode("⚠️ Unhandled promise rejection.")),console.log("ERROR: Unhandled rejection: "+(t.error&&t.error.message?t.error.message:t.error)),console.log(JSON.stringify(t)),!1});let u={},l=!1,f=!1,d=!0,h=!0,g=!1;function p(){g||((0,r.redirectConsole)("#output"),g=!0),f&&document.querySelector("body").classList.toggle("console",l)}(0,r.watchParameters)(R),l&&p(),"serviceWorker"in navigator&&window.addEventListener("load",async function(){try{const t="service-worker.js",e=await navigator.serviceWorker.register(t);e.onupdatefound=function(){const t=e.installing;t.onstatechange=function(){switch(t.state){case"installed":navigator.serviceWorker.controller?(console.log("SERVICEWORKER: New content available."),confirm("[ServiceWorker] Update available -- reload now?")&&window.location.reload()):console.log("SERVICEWORKER: Now available offline.");break;case"redundant":console.log("SERVICEWORKER: Installing worker was redundant.")}}}}catch(t){console.log("SERVICEWORKER: Error during registration: "+t)}}),window.applicationCache&&applicationCache.addEventListener("updateready",function(){confirm("[AppCache] Update available -- reload now?")&&window.location.reload()});let v=null,y={},m=!1,b=null,w=null,x=!0,S="code_128";function R(t=u){if(u=t,console.log("PARAMS: "+JSON.stringify(t)),void 0!==t.nodebug&&(l=!1),void 0!==t.debug&&(l=!0),l&&p(),void 0!==t.allowserial&&(h=!0),void 0!==t.noserial&&(h=!1),void 0!==t.allowusb&&(d=!0),void 0!==t.nousb&&(d=!1),!f)return;let e=!1;void 0!==t.editable&&(e=!1),void 0!==t.readonly&&(e=!0);for(let t of["#session","#rate","#range","#gyro","#start","#delay","#duration","#stop","#metadata","#minbattery"]){const n=document.querySelector(t);e?n.setAttribute("disabled","true"):n.removeAttribute("disabled")}let n=!0;void 0!==t.details&&(n=!0),void 0!==t.nodetails&&(n=!1),n?document.querySelector("#details").setAttribute("open","true"):document.querySelector("#details").removeAttribute("open");const r={session:null,rate:100,range:8,gyro:0,start:0,stop:168,metadata:""};let o=!1;for(let e of["session","rate","range","gyro","start","stop","metadata","minbattery"])void 0!==t[e]&&(r[e]=t[e]),o|=typeof r[e]!=typeof y[e]||r[e]==y[e];o?(y=r,console.log("PARAMS: Config changed: "+JSON.stringify(r)),_(r)):console.log("PARAMS: Config not changed: "+JSON.stringify(r)),t.config&&w.setValue(t.config),void 0!==t.focus&&(document.querySelector("#code").select(),document.querySelector("#code").focus()),j(document.querySelector("#code").value),document.querySelector("#add_usb_device").setAttribute("style",d?"display: inline;":"display: none;"),document.querySelector("#add_serial_device").setAttribute("style",h?"display: inline;":"display: none;"),navigator.serial||document.querySelector("#add_serial_device").setAttribute("style","display: none;"),document.querySelector("body").classList.toggle("nolog",void 0!==t.nolog),document.querySelector("body").classList.toggle("nologclear",void 0!==t.nologclear),document.querySelector("body").classList.toggle("no-configure",void 0!==t.noconfigure),void 0!==t.diagnostics&&document.querySelector("body").classList.add("diagnostics-open"),document.querySelector("#add_usb_device").setAttribute("style",d?"display: inline;":"display: none;");let i=!0;void 0!==t.noscan&&(i=!1),void 0!==t.scan&&(i=!0),document.querySelector("body").classList.toggle("allow-scan",i),void 0!==t.readers&&(S=t.readers),void 0!==t.autosubmit&&(x=!0),void 0!==t.noautosubmit&&(x=!1),w.setAutoSubmit(x);let a=null;void 0!==t.title&&(a=t.title),a||(a="AX Configure"),document.querySelector("title").innerText=a,document.querySelector("#title").innerText=a}const _=t=>{document.querySelector("#session").value=void 0!==t.session?t.session:"",document.querySelector("#rate").value=void 0!==t.rate?t.rate:"",document.querySelector("#range").value=void 0!==t.range?t.range:"",document.querySelector("#gyro").value=void 0!==t.gyro?t.gyro:"",document.querySelector("#minbattery").value=void 0!==t.minbattery?t.minbattery:"";let e=D(t.start);e?(document.querySelector("#start").value=(0,r.localTimeString)(e,"m")||"",P()):(document.querySelector("#delay").value=t.start||0===t.start?t.start:"",k());let n=T(t.stop,(0,r.localTimeValue)(document.querySelector("#start").value));document.querySelector("#stop").value=null===n?document.querySelector("#start").value:(0,r.localTimeString)(n,"m")||"",N(),document.querySelector("#metadata").value=void 0!==t.metadata?t.metadata:"",E()};const E=()=>{let t=null;try{const e=function(t){const e=[],n=new Date;t.stop.getTime()<n?e.push("Recording interval has already finished."):t.start.getTime()+66e3<n?e.push("Recording interval has already started."):t.start.getTime(),t.start.getTime()>n+18144e5&&e.push("Start time is a long time in the future.");const r=(t.stop.getTime()-t.start.getTime())/1e3;return r<=0&&e.push("Start/stop times do not make an interval."),r*t.rate>158714880&&e.push("Duration is too long (for this rate)."),[6,6.25,12,12.5,25,50,100,200,400,800,1600,3200].includes(t.rate)||e.push("Rate is not valid."),e}(t=L());e&&e.length>0?U("WARNING: "+e.join("; "),!0):U("",!1),console.log("CONFIG-VALID: true"),document.querySelector("body").classList.add("config-valid")}catch(t){U(t,!0),console.log("CONFIG-VALID: false"),document.querySelector("body").classList.remove("config-valid")}const e=t&&!!v&&!W;w.submitEnabled(e)};function A(){const t=document.querySelector("body").classList.contains("device-connected"),e=document.querySelector("#diagnostic-text").value.startsWith("{");console.log("DIAGNOSTICS: Update with device: "+t+" and diagnostic: "+e),t?(document.querySelector("#diagnostic-run").removeAttribute("disabled"),document.querySelector("#diagnostic-reset").removeAttribute("disabled")):(document.querySelector("#diagnostic-run").setAttribute("disabled","true"),document.querySelector("#diagnostic-reset").setAttribute("disabled","true")),e?(document.querySelector("#diagnostic-copy").removeAttribute("disabled"),document.querySelector("#diagnostic-download").removeAttribute("disabled")):(document.querySelector("#diagnostic-copy").setAttribute("disabled","true"),document.querySelector("#diagnostic-download").setAttribute("disabled","true"))}const C=()=>{let t={deviceType:null,deviceId:"-",battery:"-",state:null,errorState:null};(v=b.getSingleDevice())?(t.deviceId=v.serial||(v.status&&v.status.id&&v.status.id.deviceId?v.status.id.deviceId:"-"),v.status&&v.status.id&&v.status.id.deviceType?t.deviceType=v.status.id.deviceType:v.deviceType&&(t.deviceType=v.deviceType),null!==v.status.battery&&(t.battery=v.status.battery.percent),t.state=v.status.state,t.errorState=v.status.errorState,document.querySelector("body").classList.add("device-connected")):document.querySelector("body").classList.remove("device-connected"),A(),document.querySelector("#device-id").value=t.deviceId+(t.deviceType?" ["+t.deviceType+"]":""),document.querySelector("#battery-meter").value=Number.isNaN(parseInt(t.battery))?0:parseInt(t.battery),document.querySelector("#battery").value=Number.isNaN(parseInt(t.battery))?"-":t.battery+"%",document.querySelector("#state").value=t.state||t.errorState||"-",v&&v.status&&v.status.recordingStarted?document.querySelector("#configure").value="⚠️ Delete device data and reconfigure":v&&v.status&&v.status.recordingConfigured?document.querySelector("#configure").value="🔁 Reconfigure":document.querySelector("#configure").value="Configure",E()},O=async()=>{if(H(),v=b.getSingleDevice()){console.log("DEVICECHANGED: "+(v.serial?v.serial:"<no serial>")),v.setStatusHandler(C),console.log("DEVICECHANGED: updateStatus...");try{await v.updateStatus(),console.log("STATUS: "+JSON.stringify(v.status))}catch(t){console.log("DEVICECHANGED: ERROR: "+JSON.stringify(t))}}else console.log("DEVICECHANGED: (none)"),m&&(m=!1,B(!0,!0)),await C()},D=t=>{if(!t&&0!==t)return null;if(t&&"[object Date]"===Object.prototype.toString.call(t)&&!isNaN(t))return t;if(/\d\d\d\d-\d\d-\d\d[T ]\d\d:\d\d:\d\d(?:\.\d\d\d)?Z?/.test(t))try{let e;if("Z"==t[t.length-1])e=new Date(t);else{const n=t.split(/\D/).map(t=>parseInt(t));n[1]=n[1]-1,e=new Date(...n)}return e}catch(e){console.log("ERROR: Problem parsing date: "+t)}return null},T=(t,e,n=36e5)=>{if(!t&&0!==t)return null;return D(t)||(e=e||0===e?e:new Date,new Date(e.getTime()+parseFloat(t)*n))},I=()=>""===document.querySelector("#duration").value?null:60*parseFloat(document.querySelector("#duration").value)*60*1e3,P=()=>{(0,r.localTimeValue)(document.querySelector("#start").value),document.querySelector("#delay").value="",M()},k=(t=null)=>{Number(t)===t&&(document.querySelector("#delay").value=t);const e=document.querySelector("#delay").value;if(""!==e.trim()){const t=new Date,n=60*parseFloat(e)*60*1e3;let o;if(n>=0)o=new Date(t.getTime()+n);else{const e=new Date(new Date(t).setHours(0,0,0,0));o=new Date(e.getTime()+-n)}const i=document.querySelector("#start"),a=(0,r.localTimeString)(o,"m");i.value!=a&&(i.value=a,M())}},N=()=>{const t=(0,r.localTimeValue)(document.querySelector("#start").value),e=(0,r.localTimeValue)(document.querySelector("#stop").value);if(null===e||null===t)return void(document.querySelector("#duration").value="");const n=(e.getTime()-t.getTime())/1e3/60/60;document.querySelector("#duration").value=n},M=t=>{if(Number(t)===t){const e=t/1e3/60/60;document.querySelector("#duration").value=e}const e=(0,r.localTimeValue)(document.querySelector("#start").value);if(e){const t=I(),n=new Date(e.getTime()+t);document.querySelector("#stop").value=(0,r.localTimeString)(n,"m")}else document.querySelector("#stop").value=document.querySelector("#start").value},L=()=>{const t={session:""==document.querySelector("#session").value?null:parseInt(document.querySelector("#session").value),rate:parseFloat(document.querySelector("#rate").value),range:parseInt(document.querySelector("#range").value),gyro:parseInt(document.querySelector("#gyro").value),start:(0,r.localTimeValue)(document.querySelector("#start").value),stop:(0,r.localTimeValue)(document.querySelector("#stop").value),metadata:document.querySelector("#metadata").value,minbattery:""==document.querySelector("#minbattery").value?null:parseInt(document.querySelector("#minbattery").value)},e=[];if(("number"!=typeof t.session||isNaN(t.session))&&e.push("session ID not specified"),"object"==typeof t.start&&t.start||e.push("start time not specified"),"object"==typeof t.stop&&t.stop||e.push("stop time not specified"),I()<=0&&e.push("start and stop times do not make a valid interval"),e.length>0)throw"Cannot configure: "+e.join(", ")+".";return t},U=(t,e=!1)=>{document.querySelector("#result").value=e?"⚠️ "+t:t},j=t=>{console.log("CODE: "+t);const e=t.trim().length>0?parseInt("0"+t.replace(/[^0-9]/g,"").slice(-9)):"";document.querySelector("#session").value=e,document.querySelector("#metadata").value=((t,e,n)=>{t.length>0&&"?"==t[0]&&(t=t.slice(1));const r=t.split("&"),o=[];let i=!1;for(let t of r){const r=t.indexOf("="),a=decodeURIComponent(r>=0?t.slice(0,r):t).replace(/\+/g," ");a.length<=0||(a==e?i||(i=!0,null!==n&&o.push(encodeURIComponent(a)+"="+encodeURIComponent(n))):o.push(t))}return i||null===n||o.push(encodeURIComponent(e)+"="+encodeURIComponent(n)),o.join("&")})(document.querySelector("#metadata").value,"_sc",0==t.length?null:t),E()},q=(t,e)=>{let n=[];n.push((0,r.localTimeString)(e.time,"S")),n.push(t),n.push(e.deviceId),n.push(e.session),n.push((0,r.localTimeString)(e.start,"S")),n.push((0,r.localTimeString)(e.stop,"S")),n.push(e.rate),n.push(e.range),n.push('"'+e.metadata.replace(/\"/g,'""')+'"');const o=((t,e)=>{t.length>0&&"?"==t[0]&&(t=t.slice(1));const n=t.split("&");for(let t of n){const n=t.indexOf("="),r=decodeURIComponent(n>=0?t.slice(0,n):t).replace(/\+/g," ");if(!(r.length<=0)&&r==e)return decodeURIComponent(n>=0?t.slice(n+1):"").replace(/\+/g," ")}return null})(e.metadata,"_sc");n.push(e.gyro),n.push('"'+o+'"');const i=n.join(","),a="LOG_"+(new Date).toISOString().slice(0,10).replace(/[^0-9]/g,"");console.log("LOG: "+i),localStorage.setItem(a,(localStorage.getItem(a)||"")+i+"\r\n")},B=(t,e)=>{document.querySelector("body").classList.remove("completed"),m=!1,t&&w.setValue(""),e&&void 0!==u.focus&&(document.querySelector("#code").select(),document.querySelector("#code").focus()),j(document.querySelector("#code").value)},F=()=>{(async()=>{try{console.log("BARCODE: Cancel: Awaiting..."),await a.default.cancel()}catch(t){console.error("BARCODE: Error during cancellation: "+t)}})()};let W=!1;const z=async()=>{if(W)U("(device busy)",!0);else try{document.querySelector("body").classList.add("configuring"),W=!0,F(),document.querySelector("#configure").setAttribute("disabled","true"),document.querySelector("#start-scan").setAttribute("disabled","true"),document.querySelector("#stop-scan").setAttribute("disabled","true"),U("Configuring...",!1);const t=L();console.log(JSON.stringify(t,null,4));try{const e=await v.configure(t);console.log("CONFIG-STATUS: "+JSON.stringify(e));let n="???";v.status&&v.status.id&&v.status.id.deviceType?n=v.status.id.deviceType:v.deviceType&&(n=v.deviceType);const r=((t,e)=>{const n=["minbattery"],r=[];for(let o of Object.keys(t))n.includes(o)||(!o in e?(console.log(`ERROR: Configuration key not found: ${o}`),r.push([{[o]:t[o]},null])):t[o]!=e[o]&&(console.log(`ERROR: Configuration value not matched for '${o}': ${t[o]} != ${e[o]}.`),r.push([{[o]:t[o]},{[o]:e[o]}])));return r})(t,e);0==r.length?(U("ℹ️ Configured",!1),document.querySelector("body").classList.add("completed"),q(n+"-CONFIG-OK",e),m=!0):(U("ℹ️ Configured but mismatched: "+JSON.stringify(r),!0),q(n+"-CONFIG-FAILURE",t))}catch(e){let n="???";v.status&&v.status.id&&v.status.id.deviceType?n=v.status.id.deviceType:v.deviceType&&(n=v.deviceType),console.log("CONFIG-ERROR: "+JSON.stringify(e)),q(n+"-CONFIG-ERROR",t),U(e,!0)}}catch(t){console.log("CONFIGURATION: "+t),U(t,!0)}finally{document.querySelector("body").classList.remove("configuring"),W=!1,document.querySelector("#configure").removeAttribute("disabled"),document.querySelector("#start-scan").removeAttribute("disabled"),document.querySelector("#stop-scan").removeAttribute("disabled")}};let V=null,G=new Date;function $(t,e=null){V=e,G=new Date,document.querySelector(".diagnostic-fieldset legend").innerText="Diagnostic Report"+(V?": "+V:"");const n=t?JSON.stringify(t,null,4):"";console.dir(t);const r=document.querySelector("#diagnostic-text");r.value=n,r.focus(),r.select(),r.scrollTo(0,0),document.querySelector("body").classList.add("diagnostics-open"),A()}function H(){$(null,null),document.querySelector("#diagnostic-file").value="",void 0===u.diagnostics&&document.querySelector("body").classList.remove("diagnostics-open")}function Y(t,e){console.log("FILE-DIAGNOSTICS: ("+e.byteLength+" bytes) -- "+t);const n={errors:[]};if(n.time=new Date,n.file={filename:t,length:e.byteLength,source:"file"},e.byteLength>=512)try{n.header=(0,s.parseHeader)(new DataView(e.buffer,0,512))}catch(t){console.dir(t),n.errors.push("Could not parse header: "+JSON.stringify(t))}if(e.byteLength>=1536)try{n.first=(0,s.parseData)(new DataView(e.buffer,1024,512))}catch(t){console.dir(t),n.errors.push("Could not parse first data: "+JSON.stringify(t))}if(e.byteLength>=2048)try{n.last=(0,s.parseData)(new DataView(e.buffer,e.byteLength-512,512))}catch(t){console.dir(t),n.errors.push("Could not parse last data: "+JSON.stringify(t))}$(n,t)}window.addEventListener("DOMContentLoaded",async t=>{f=!0,b=new i.default(d,h),w=new o.default("#code"),await C(),w.start(j,z);for(let t of b.warnings)document.getElementById("warnings").appendChild(document.createTextNode("⚠️ "+t));b.startup(O);const e=document.querySelector("#reconfigure");function n(t){const e=new FileReader;e.onload=async function(e){Y(t.name,new Uint8Array(e.target.result))},e.readAsArrayBuffer(t)}e&&e.addEventListener("click",async()=>{B(!1,!0)}),document.querySelector("#configure_new").addEventListener("click",async()=>{B(!0,!0)}),document.querySelector("#add_usb_device").addEventListener("click",async()=>{try{await b.userAddUsbDevice()}catch(t){U(t,!0)}}),document.querySelector("#add_serial_device").addEventListener("click",async()=>{try{await b.userAddSerialDevice()}catch(t){U(t,!0)}}),document.querySelector("#diagnostics-toggle").addEventListener("click",t=>{t.preventDefault(),document.querySelector("body").classList.contains("diagnostics-open")?H():$(null,null)}),document.querySelector("#diagnostic-run").addEventListener("click",async()=>{try{if(document.querySelector("#diagnostic-run").setAttribute("disabled","true"),document.querySelector("#diagnostic-reset").setAttribute("disabled","true"),v){const t=await v.runDiagnostic();$(t,t&&t.id&&t.id.deviceId?t.id.deviceId:"unknown")}}catch(t){U(t,!0)}finally{document.querySelector("#diagnostic-run").removeAttribute("disabled"),document.querySelector("#diagnostic-reset").removeAttribute("disabled")}}),document.querySelector("#diagnostic-reset").addEventListener("click",async()=>{try{if(document.querySelector("#diagnostic-run").setAttribute("disabled","true"),document.querySelector("#diagnostic-reset").setAttribute("disabled","true"),$("",null),v){const t="CAUTION: You want to DELETE ALL DATA from this device and RESET the device?";if(!window.confirm(t))throw"Reset cancelled";const e="WIPE and RESET the device now?  (Enter ID from device case to reset the device ID, or leave blank to keep the current ID)",n=window.prompt(e,"");if(null===n)throw"Reset cancelled";if(""!==n){const t=parseInt(n);if(t!=n||t<0||t>4294967295)throw"Invalid ID: "+n}await v.runReset(n),$("Device reset"+(n?": "+n:""),null)}}catch(t){U(t,!0)}finally{document.querySelector("#diagnostic-run").removeAttribute("disabled"),document.querySelector("#diagnostic-reset").removeAttribute("disabled")}}),document.querySelector("#diagnostic-copy").addEventListener("click",async()=>{const t=document.querySelector("#diagnostic-text");"clipboard"in navigator?navigator.clipboard.writeText(t.value):(t.focus(),t.select(),t.scrollTo(0,0),document.execCommand("copy"))}),document.querySelector("#diagnostic-download").addEventListener("click",async()=>{const t="diagnostic_"+G.toISOString().replace(/[^0-9]/g,"").substring(0,14)+(V?"_"+V:"")+".txt",e=document.querySelector("#diagnostic-text").value;(0,r.download)(t,e,"text/plain")}),document.querySelector("#diagnostic-file").addEventListener("change",function(t){n(t.target.files[0])}),document.body.addEventListener("dragover",function(t){document.querySelector("body").classList.contains("diagnostics-open")&&t.preventDefault()}),document.body.addEventListener("drop",function(t){if(document.querySelector("body").classList.contains("diagnostics-open")&&t.dataTransfer.files&&t.dataTransfer.files.length>0){t.preventDefault();const e=t.dataTransfer.files[0];document.querySelector("#diagnostic-file").files=t.dataTransfer.files,n(e)}});for(let t of["#delay"]){const e=document.querySelector(t);e.addEventListener("change",k),e.addEventListener("input",k)}for(let t of["#start"]){const e=document.querySelector(t);e.addEventListener("change",P),e.addEventListener("input",P)}for(let t of["#duration"]){const e=document.querySelector(t);e.addEventListener("change",M),e.addEventListener("input",M)}for(let t of["#stop"]){const e=document.querySelector(t);e.addEventListener("change",N),e.addEventListener("input",N)}for(let t of["#session","#rate","#range","#gyro","#delay","#start","#duration","#stop","#metadata","#minbattery"]){const e=document.querySelector(t);e.addEventListener("change",E),e.addEventListener("input",E),e.addEventListener("propertychange",E)}_({session:null,rate:100,range:8,start:0,stop:null,metadata:""}),navigator.usb||document.querySelector("#add_usb_device").setAttribute("disabled","true"),navigator.serial||document.querySelector("#add_serial_device").setAttribute("disabled","true"),document.querySelector("#reset").addEventListener("click",t=>{B(!0,!0),location.reload()}),document.querySelector("#log-download").addEventListener("click",t=>{t.preventDefault();try{const e=Object.keys(localStorage).filter(t=>t.startsWith("LOG_")).sort().map(t=>localStorage.getItem(t)).join(""),n="log_"+(new Date).toISOString().replace(/[^0-9]/g,"")+".csv";(0,r.download)(n,e,"text/csv;charset=utf-8")}catch(t){console.log(t)}}),document.querySelector("#log-clear").addEventListener("click",t=>{t.preventDefault();let e=!1;{const t=prompt("DESTROY data by deleting and clearing all of the configuration logs?  Type DESTROY in capitals to confirm.");null!=t&&("DESTROY"===t?e=!0:alert("Did not delete logs"))}if(e)try{(()=>{const t=Object.keys(localStorage).filter(t=>t.startsWith("LOG_"));for(let e of t)localStorage.removeItem(e)})()}catch(t){console.log(t)}}),document.querySelector("#start-scan").addEventListener("click",async()=>{try{document.querySelector("body").classList.add("scanning");const t=await a.default.scan({readers:S});null!=t?(console.log("SCAN: Result="+t),w.setValue(t)):console.log("SCAN: No result.")}catch(t){console.log("SCAN: Error="+JSON.stringify(t)),U(t,!0)}finally{document.querySelector("body").classList.remove("scanning")}}),document.querySelector("#stop-scan").addEventListener("click",F),R(),setInterval(()=>{k(),b.refreshDevices()},5e3)})},{"./util.mjs":"x7XL","./key_input.mjs":"yzmp","./device_manager.mjs":"bqdr","./barcode.mjs":"dfhR","./cwa_parse.mjs":"bBqM"}]},{},["jOUA"]);</script></head><body>
<div class="main"> <header> <h1 id="title">AX Configure</h1> <div id="warnings"><ul> <noscript>⚠️ Scripting not enabled.</noscript> </ul></div> </header> <main> <form> <div class="complete"> <div class="status">✅ Configured &mdash; please disconnect device.</div> <div class="main_button">Reconfigure: <input id="configure_new" class="button link" type="button" value="Afresh" title="New Configuration"> <input id="reconfigure" class="button link" type="button" value="Same" title="Repeat Same Configuration"> </div> </div> <div class="incomplete"> <fieldset> <legend>Configuration</legend> <div id="interactive" class="viewport"></div> <div> <label accesskey="C" for="code">Code: </label> <input id="code" type="text" placeholder="..."> <div class="scan-controls"> <button class="button" type="button" id="start-scan" title="Scan">𝄃𝄀𝄁𝄂</button> <button class="button" type="button" id="stop-scan" title="Cancel Scan">×</button> </div> </div> <details id="details" open> <summary>Details</summary> <div><label for="session">Session ID: </label><input id="session" type="number" placeholder="(none)"></div> <div><label for="rate">Rate: </label> <select id="rate" placeholder=""> <option value="3200">3200 Hz</option> <option value="1600">1600 Hz</option> <option value="800">800 Hz</option> <option value="400">400 Hz</option> <option value="200">200 Hz</option> <option value="100" selected>100 Hz</option> <option value="50">50 Hz</option> <option value="25">25 Hz</option> <option value="12.5">12.5 Hz</option> </select> </div> <div><label for="range">Range: </label> <select id="range" placeholder=""> <option value="16">&PlusMinus;16&#x1D454;</option> <option value="8" selected>&PlusMinus;8&#x1D454;</option> <option value="4">&PlusMinus;4&#x1D454;</option> <option value="2">&PlusMinus;2&#x1D454;</option> </select> </div> <div><label for="gyro">Gyro: </label> <select id="gyro" placeholder=""> <option value="2000">2000 &deg;&#x2215;s</option> <option value="1000">1000 &deg;&#x2215;s</option> <option value="500">500 &deg;&#x2215;s</option> <option value="250">250 &deg;&#x2215;s</option> <option value="0" selected>(none)</option> </select> </div> <div><label for="metadata">Metadata: </label><input id="metadata" type="text" placeholder="(none)"></div> <div><label for="delay">Delay (h): </label><input id="delay" type="number" min="0" placeholder="(hours)" step="any"></div> <div><label for="start">Start: </label><input id="start" type="datetime-local"></div> <div><label for="duration">Duration (h): </label><input id="duration" type="number" min="0" placeholder="(hours)" step="any"></div> <div><label for="stop">Stop: </label><input id="stop" type="datetime-local"></div> <div class="hidden"><label for="minbattery">Min.Batt.: </label><input id="minbattery" type="number" min="0" max="101" placeholder="(%)" step="1"></div> </details> <div><output id="result" value="-"></output></div> </fieldset> </div> <div class="disconnected"> <div class="main_button"> <input class="button" id="add_serial_device" type="button" value="&#x1F517; Connect serial device..." title="Connect to a USB device over its serial interface"> <input class="secondary" id="add_usb_device" type="button" value="&#x1F517; Alternative connect device..." title="Attempt to connect to a USB device directly"> </div> </div> <div class="connected"> <fieldset class="device-fieldset"> <legend>Device</legend> <span class="device-status"> <div><label for="device-id">Id: </label><output id="device-id">-</output></div> <div><label for="battery">Battery: </label><meter id="battery-meter" min="0" max="100" low="30" high="85" optimum="100" value="0"></meter> <output id="battery">-</output></div> <div><label for="state">State: </label><output id="state">-</output></div> </span> </fieldset> </div> <div class="diagnostics"> <fieldset class="diagnostic-fieldset"> <legend>Diagnostic Report</legend> <div class="diagnostic-controls"> <button class="button" type="button" id="diagnostic-run" title="Run Diagnostic on Device">&#x1F5B4; Device Diagnostics</button> <label id="diagnostic-file-selection"> File Diagnostics: <input type="file" class="button" id="diagnostic-file" accept=".cwa" title="Run Diagnostic on Downloaded File"> </label> <button class="secondary" type="button" id="diagnostic-reset" title="Wipe and Reset Device">&#x26A0; Reset</button> </div> <textarea id="diagnostic-text" readonly></textarea> <div class="diagnostic-controls"> <button class="button" type="button" id="diagnostic-copy" title="Copy report to clipboard">&#x2398; Copy Report</button> <button class="button" type="button" id="diagnostic-download" title="Download report">&#x21E9; Download Report</button> </div> </fieldset> </div> <div class="incomplete"> <div class="connected-valid"> <div class="main_button"><input id="configure" class="button" type="submit" value="Configure"></div> </div> </div> </form> </main> <footer> <div> <a href="https://github.com/digitalinteraction/openmovement-axconfig/blob/master/README.md" title="openmovement-axconfig project">ℹ️ Help</a> | <a id="reset" href="#">&#x21BA; Refresh</a> <span class="log-span">| <a id="log-download" href="">&#x21E9; Download Config Log</a> <span class="log-clear-span">| <a id="log-clear" href="">&#x239A; Clear Config Log</a></span> </span> | <a id="diagnostics-toggle" href="#">&#x1F5B3; Diagnostics</a> | <span class="version">-</span> </div> </footer>
</div>
<output id="output">-</output>
</body></html><script>document.addEventListener("DOMContentLoaded",function(){document.querySelector(".version").textContent=document.querySelector("#version").textContent.split(/[ ]/)[0]});</script><script type="text/plain" id="version" style="display:none;">
v2024-01-19</script>