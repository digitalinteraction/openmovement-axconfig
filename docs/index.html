<!doctype html><html lang="en" UNUSED_manifest="cache.appcache"><head><meta charset="utf-8"><title>AX Configure</title><link rel="shortcut icon" type="image/x-icon" href="data:image/x-icon;," _href="icon.ico"><style type="text/css">body,html{height:100%;width:100%}html{font-family:sans-serif;background:#f5f5f5}body{margin:0;display:grid;grid-template-rows:auto fit-content(35vh)}.main{overflow:auto;margin:.5em}fieldset{max-width:40em;margin:.5em auto}.status{font-size:150%;font-weight:700;margin-bottom:1em}#warnings,.main_button,.status,h1{text-align:center}#output::-webkit-scrollbar{width:.5em}#output::-webkit-scrollbar-track{box-shadow:inset 0 0 6px rgba(0,0,0,.3)}#output::-webkit-scrollbar-thumb{background-color:#a9a9a9;outline:1px solid #708090}#output{box-shadow:inset 4px 4px 10px #aaa;background:#fff;color:#000;margin-top:1em;font-family:monospace;overflow-y:auto;padding:.3em 0 .3em .3em;border-radius:4px;height:35vh;display:none}body.console #output{display:block}#output p{font-size:14px;font-weight:700;padding:.2em;margin:0}#output p:nth-child(odd){background:linear-gradient(180deg,rgba(51,238,238,.13),rgba(51,238,238,.13) 50%,rgba(51,153,153,.13) 0,rgba(51,153,85,.13));background-size:100% 2px}.button{box-shadow:inset 0 1px 0 0 #bbdaf7;background:linear-gradient(180deg,#79bbff 5%,#378de5);background-color:#79bbff;border-radius:6px;border:1px solid #84bbf3;color:#fff;font-size:15px;padding:10px 20px;text-decoration:none;text-shadow:0 1px 0 #528ecc}.button:hover{background:linear-gradient(180deg,#378de5 5%,#79bbff);background-color:#378de5}.button:active{position:relative;top:2px}.button,.secondary,input[type=file]{display:inline-block;cursor:pointer}.secondary{background-color:initial;border:1px solid transparent;border-radius:5px;color:#000}.secondary:hover{border:1px solid #000}.secondary:active{position:relative;top:2px}.button:disabled,.secondary:disabled,input[type=button]:disabled,input[type=submit]:disabled{background:#ddd;cursor:not-allowed}.button:disabled:hover{background:#ddd}.button:disabled:active{top:0}.link{border:0;color:#000;text-shadow:none;box-shadow:none;text-decoration:underline}.link,.link:active,.link:hover{background:0 0}fieldset,form{margin-bottom:6pt}fieldset{border-radius:6pt}fieldset div{display:flex;vertical-align:bottom;margin-top:.2em;margin-bottom:.2em}fieldset label{margin-left:.5em;width:6em}fieldset input[type=datetime-local],fieldset input[type=file],fieldset input[type=number],fieldset input[type=text],fieldset meter,fieldset output,fieldset select{width:5em;flex-grow:1}#code{font-size:150%}fieldset #battery{flex-grow:1;margin-left:.5em}summary{font-size:small;cursor:pointer}summary:after{content:"..."}footer{color:#777;margin-top:1em}footer div{color:#333;font-size:small;text-align:center}footer a{color:#777;text-decoration:none}.version{color:#777;font-size:small;white-space:nowrap}.link:active,.link:hover,footer a:active,footer a:hover{text-decoration:underline}.disconnected{display:block}.connected,.connected-valid,.device-connected .disconnected{display:none}.device-connected .connected,.device-connected.config-valid .connected-valid,.incomplete{display:block}.complete,.completed .incomplete,.hidden,body.no-configure .complete .main_button,body.no-configure .incomplete,body.nolog .log-span,body.nologclear .log-clear-span{display:none}.completed .complete,body.allow-scan .scan-controls,body.diagnostics-open .diagnostics{display:block}#duration_days,#duration_hours,#duration_minutes,#duration_seconds,.scan-controls{text-align:right}.scan-controls{margin-left:10px;display:none}.scan-controls #start-scan{display:inline}.scan-controls #stop-scan,body .diagnostics,body.scanning .scan-controls #start-scan{display:none}body.scanning .scan-controls #stop-scan{display:inline}#interactive.viewport{position:relative;height:0;transition:height .5s ease-out}body.scanning #interactive.viewport{height:480px}#interactive.viewport>video{max-width:100%;width:100%;z-index:-2}#interactive.viewport>canvas.drawingBuffer{position:absolute;left:0;top:0;z-index:-1;pointer-events:none;display:none}.device-fieldset{display:flex}.device-fieldset .device-status{display:block;flex-grow:1}.diagnostic-controls .button{margin-right:1em}.diagnostic-fieldset textarea{width:100%;height:10em;border:1px solid #000;border-radius:10px;background:0 0}#diagnostic-file-selection{text-wrap:none;word-break:keep-all;width:auto}#diagnostic-file{width:10em}#diagnostic-file::file-selector-button{display:none}</style><link rel="manifest" href="manifest.webmanifest"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="application-name" content="AX Config"><meta name="apple-mobile-web-app-title" content="AX Config"><meta name="msapplication-starturl" content="/"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><script __not__type="module">parcelRequire=function(e,t,r,n){var o,i="function"==typeof parcelRequire&&parcelRequire,a="function"==typeof require&&require;function s(r,n){if(!t[r]){if(!e[r]){var o="function"==typeof parcelRequire&&parcelRequire;if(!n&&o)return o(r,!0);if(i)return i(r,!0);if(a&&"string"==typeof r)return a(r);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}l.resolve=function(t){return e[r][1][t]||t},l.cache={};var u=t[r]=new s.Module(r);e[r][0].call(u.exports,l,u,u.exports,this)}return t[r].exports;function l(e){return s(l.resolve(e))}}s.isParcelRequire=!0,s.Module=function(e){this.id=e,this.bundle=s,this.exports={}},s.modules=e,s.cache=t,s.parent=i,s.register=function(t,r){e[t]=[function(e,t){t.exports=r},{}]};for(var c=0;c<r.length;c++)try{s(r[c])}catch(e){o||(o=e)}if(r.length){var u=s(r[r.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=u:"function"==typeof define&&define.amd&&define(function(){return u})}if(parcelRequire=s,o)throw o;return s}({x7XL:[function(e,t,r){"use strict";function n(e){if("object"!=typeof e)return null;const t=60*(new Date).getTimezoneOffset()*1e3;return new Date(e.getTime()-t)}Object.defineProperty(r,"__esModule",{value:!0}),r.sleep=async function(e){return new Promise(t=>setTimeout(t,e))},r.localTime=n,r.localTimeString=function(e,t){const r=n(e);if(null===r)return null;const o=r.toISOString().slice(0,-1);return"d"==t?o.slice(0,-13):"m"==t?o.slice(0,-7):"s"==t?o.slice(0,-4):"S"==t?o.slice(0,-4).replace("T"," "):o},r.localTimeValue=function(e){if("string"!=typeof e||0===e.length)return null;16==e.length&&(e+=":00"),19==e.length&&(e+=".000"),23==e.length&&(e+="Z");const t=60*(new Date).getTimezoneOffset()*1e3;return new Date(new Date(e).getTime()+t)},r.watchParameters=function(e){function t(){const t=new URL(window.location.href),r=t.searchParams,n=new URLSearchParams(t.hash.replace(/^#/,"")),o=[];for(let e of[r,n])for(let t of e.entries())o.push(t);const i={};for(let e of o)i[e[0].toLowerCase()]=e[1];e(i,o)}window.onhashchange=t,t()},r.redirectConsole=function(e,t="P"){function r(e,r,...n){const o=document.querySelector(e),i=n.join(" ");if(!o)return"[pre-DOM] "+i;const a=document.createTextNode(i),s=document.createElement(t);return s.appendChild(a),o.appendChild(s),s.scrollIntoView(!1),i}for(let t of["log","warn","error"]){const n=console[t];console[t]=function(){const o=r(e,t,...arguments);n(o)}}},r.download=function(e,t,r){r=r||"application/octet-binary";const n=document.createElement("A");let o;(t instanceof ArrayBuffer||"string"==typeof t)&&(t=[t]),Array.isArray(t)&&(t=new Blob(t,{type:r})),o=t instanceof Blob?URL.createObjectURL(t):"data:"+r+","+encodeURIComponent(t),n.setAttribute("href",o),n.setAttribute("download",e),n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{}],yzmp:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;r.default=class{constructor(e){this.inputSelector=e,this.inputBuffer="",this.timeoutId=null,this.autoSubmit=!1}setAutoSubmit(e){this.autoSubmit=e}start(e=null,t=null){this.changeCallback=e,document.onkeydown=this.keydown.bind(this);const r=()=>{const t=document.querySelector(this.inputSelector);if(e){const r=t.value;e(r)}},n=document.querySelector(this.inputSelector);n.addEventListener("input",r),n.addEventListener("change",r),n.addEventListener("focus",function(){this.select()}),n.form.onsubmit=e=>{const r=document.querySelector(this.inputSelector);if(e.preventDefault(),r.blur(),!r.form.querySelector("input[type=submit]").disabled&&t){const e=r.value;t(e)}return!1},r()}setValue(e,t=!1){this.inputBuffer="";const r=document.querySelector(this.inputSelector);if(r){if(arguments.length>0&&(console.log("KEYINPUT: "+e),r.value=e),r.dispatchEvent(new Event("change",{bubbles:!0})),t){const e=r.form.querySelector('input[type="submit"]');e&&e.click()}}else console.log("KEYINPUT: Error: element not found: "+this.inputSelector)}submitEnabled(e){document.querySelector(this.inputSelector).form.querySelector("input[type=submit]").disabled=!e}keydown(e){let t=!0;e=e||window.event,this.inputSelector||(t=!1),document.activeElement&&("INPUT"==document.activeElement.tagName&&["text","password","date","email","number","search"].indexOf(document.activeElement.type)>=0&&(t=!1),"TEXTAREA"==document.activeElement.tagName&&(t=!1)),(e.altKey||e.ctrlKey)&&(t=!1),e.which<32&&(this.inputBuffer.length>0&&13==e.which&&(e.preventDefault(),this.setValue(this.inputBuffer,this.autoSubmit)),t=!1),e.key&&1==e.key.length||(t=!1),null!==this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=null),t?(e.preventDefault(),this.inputBuffer+=e.key,this.timeoutId=setTimeout(function(){this.inputBuffer=""}.bind(this),2e3)):this.inputBuffer=""}}},{}],anNG:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;const n=new TextEncoder("windows-1252"),o=new TextDecoder("windows-1252"),i=2,a=10;function s(e){let t=null,r=null;for(let n of e.interfaces)n.alternates[0].interfaceClass==i?t=n.interfaceNumber:n.alternates[0].interfaceClass==a&&(r=n.interfaceNumber);if(null===t)return console.log("WARNING: CDC control interface not found in configuration "+e.configurationValue),null;null===r&&(console.log("NOTE: CDC data interface not found in configuration "+e.configurationValue+" -- will continue and assume malformed CDC using a single interface"),r=t);let n=null;for(let r of e.interfaces[t].alternates[0].endpoints)"in"===r.direction&&"interrupt"===r.type&&(n=r.endpointNumber);if(null===n)return console.log("WARNING: CDC control endpoint not found in configuration "+e.configurationValue),null;let o=null,s=null;for(let i of e.interfaces[r].alternates[0].endpoints)r==t&&i.endpointNumber==n||("in"===i.direction&&"bulk"===i.type?o=i.endpointNumber:"out"===i.direction&&"bulk"===i.type?s=i.endpointNumber:console.log("NOTE: Data endpoint ignored "+i.endpointNumber));return null===o||null===s?(console.log("WARNING: CDC data read/write endpoints not found in configuration "+e.configurationValue),null):{configurationValue:e.configurationValue,control:{interface:t,endpoint:n},data:{interface:r,endpointRead:o,endpointWrite:s}}}function c(e){let t=null;for(let r of e.interfaces)255==r.alternates[0].interfaceClass&&(console.log(JSON.stringify({interfaceClass:r.alternates[0].interfaceClass,interfaceSubclass:r.alternates[0].interfaceSubclass,interfaceProtocol:r.alternates[0].interfaceProtocol,interfaceName:r.alternates[0].interfaceName})),t=r.interfaceNumber);if(null===t)return null;let r=null,n=null;for(let o of e.interfaces[t].alternates[0].endpoints)"in"===o.direction&&"bulk"===o.type&&(r=o.endpointNumber),"out"===o.direction&&"bulk"===o.type&&(n=o.endpointNumber);return null===r||null===n?(console.log("WARNING: Generic data read/write endpoints not found in configuration "+e.configurationValue),null):{configurationValue:e.configurationValue,data:{interface:t,endpointRead:r,endpointWrite:n}}}r.default=class{constructor(e){this.device=e,this.type="usb",this.productName=this.device.productName,this.manufacturerName=this.device.manufacturerName,this.serialNumber=this.device.serialNumber,this.io=null}async open(){try{await this.device.open()}catch(e){throw console.log("ERROR: Problem opening device: "+e,e.name+" -- "+e.message),"file:"==location.protocol&&console.log("NOTE: Hosting from a file: protocol may cause this. Try serving over HTTP."),"SecurityError"==e.name&&navigator.appVersion.indexOf("(Windows")>=0&&console.log('NOTE: The "new" Windows WebUSB back-end may have this issue.'),e}console.log("Determine I/O..."),this.io=null;for(let e of this.device.configurations){if(this.io=c(e),null!==this.io)break;if(this.io=s(e),null!==this.io)break}if(null===this.io)throw console.log("ERROR: No matching configuration found."),"No matching configuration found";console.log("IO FOUND, selecting configuration: "+JSON.stringify(this.io));try{await this.device.selectConfiguration(this.io.configurationValue)}catch(e){throw console.log("ERROR: Problem selecting configuration: "+this.io.configurationValue+" -- "+e),e}console.log("...claiming interfaces...");try{await this.device.claimInterface(this.io.data.interface)}catch(e){throw console.log("ERROR: Problem claiming data interface (could it already be claimed by a driver?): "+this.io.data.interface+" -- "+e),"Could not claim interface (could it already be claimed by a driver?) Please try connecting to serial device instead. Issue: "+this.io.data.interface+" -- "+e}console.log("...USB opened")}async close(){try{await this.device.releaseInterface(this.io.data.interface)}catch(e){console.log("WARNING: Problem releasing data interface: "+this.io.data.interface+" -- "+e)}finally{try{return console.log("...close..."),await this.device.close(),console.log("...closed"),!0}catch(e){return console.log("WARNING: Problem closing device -- "+e),!1}}}async write(e,t){e.trim().length>0&&(e=("\r"+e.trim()+"\r").padEnd(64,"\r")),t||console.log("SEND: "+e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"));let r=n.encode(e);t||console.log("===: "+r);try{await this.device.transferOut(this.io.data.endpointWrite,r)}catch(e){throw console.log("WARNING: Problem writing data: "+this.io.data.endpointWrite+" -- "+r+" -- "+e),e}}async read(e){e||console.log("Read...");let t=null;try{e||console.log(`...transferIn(${this.io.data.endpointRead})`);let r=await this.device.transferIn(this.io.data.endpointRead,64);if(e||console.log(`...transferIn() - done (${r.status}): `+r),"stall"===r.status&&(console.log("Endpoint stalled. Clearing."),await this.device.clearHalt("in",this.io.data.endpointRead)),"ok"===r.status)if(r.data&&r.data.byteLength>0){let e=[];for(let t=0;t<r.data.byteLength;t++){let n=r.data.getUint8(t);(n>=128||n<32&&13!=n&&10!=n)&&(r.data.setUint8(t,32),e.push(n))}e.length>0&&console.log(`NOTE: Replaced ${e.length} of ${r.data.byteLength} bytes: ${JSON.stringify(e)}`),t=o.decode(r.data)}else console.log("WARNING: Transfer was ok but no data: "+r.data.byteLength);else console.log("WARNING: Transfer result: "+r.status)}catch(e){return console.log("WARNING: Problem reading data: "+this.io.data.endpointRead+" -- "+e),null}return e||console.log("RECV: "+(null===t?"<null>":t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"))),t}async cancelRead(){try{return console.log("cancelRead() - "+this.io.data.endpointRead),await this.device.clearHalt("in",this.io.data.endpointRead),console.log("cancelRead() - done"),!0}catch(e){return console.log("WARNING: Problem cancelling read: "+this.io.data.endpointRead+" -- "+e),!1}}isBusy(){return this.device.opened}}},{}],Lo8Z:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;e("./util.mjs");r.default=class{constructor(e){console.dir(e),this.port=e,this.type="serial",console.log("PORT: "+JSON.stringify(this.port)),console.log("PORT properties: "+JSON.stringify(Object.getOwnPropertyNames(this.port))),this.portInfo={},this.port.getInfo?this.portInfo=this.port.getInfo():console.log("WARNING: No .portInfo()"),console.log("PORT INFO: "+JSON.stringify(this.portInfo)),this.productName=this.portInfo.product,this.manufacturerName=this.portInfo.manufacturer,this.serialNumber=this.portInfo.serialNumber,this.openFlag=!1,this.unopenable=!1,this.buffer=[]}internalStartRead(){try{this.reader.read().then(this.internalRead.bind(this))}catch(e){console.log("ERROR: Problem in reader while starting read -- reader may be broken now: "+e)}}internalRead({done:e,value:t}){try{if(null!=t&&t.length>0&&this.buffer.push(t),e)return console.log("READER: Stream end"),this.reader.releaseLock(),void(this.reader=null)}catch(e){console.log("ERROR: Problem in reader while completing read -- reader may be broken now: "+e)}setTimeout(this.internalStartRead.bind(this),0)}async open(){try{if(this.openFlag)throw"Port already open";const e={baudRate:9600};e.baudrate=e.baudRate,await this.port.open(e),this.encoder=new TextEncoderStream,this.outputDone=this.encoder.readable.pipeTo(this.port.writable),this.outputStream=this.encoder.writable,this.writer=null,this.decoder=new TextDecoderStream,this.inputDone=this.port.readable.pipeTo(this.decoder.writable),this.inputStream=this.decoder.readable,this.reader=this.inputStream.getReader(),this.internalStartRead(),this.openFlag=!0,this.unopenable=!1}catch(e){throw this.unopenable=!0,console.log("ERROR: Problem opening serial device: "+e,e.name+" -- "+e.message),e}console.log("...serial opened")}async close(){try{console.log("CLOSE: reader="+(this.reader?JSON.stringify(this.reader):"n/a"));try{this.reader&&await this.reader.cancel()}catch(e){console.log("ERROR: Problem cancelling reader: "+e)}try{await this.inputDone.catch(()=>{})}catch(e){console.log("ERROR: Problem waiting for inputDone: "+e)}this.port.readable.locked&&(console.log("!!! UNEXPECTED: Port readable was still locked -- expected to be released when stream flagged done."),this.reader&&this.reader.releaseLock()),this.reader=null;try{await this.outputStream.getWriter().close(),this.outputStream=null}catch(e){console.log("ERROR: Problem closing writer: "+e)}try{await this.outputDone,this.outputDone=null}catch(e){console.log("ERROR: Problem waiting for outputDone: "+e)}}catch(e){console.log("WARNING: Problem cancelling/unlocking: "+e)}finally{try{return console.log("...close..."),this.port.writable.locked&&console.error("WARNING: Port writable is still locked (will not close)."),await this.port.close(),console.log("...closed"),this.openFlag=!1,!0}catch(e){return console.log("WARNING: Problem closing port -- "+e),!1}}}async write(e,t){e.trim().length>0&&(e=("\r"+e.trim()+"\r").padEnd(64,"\r")),t||console.log("SEND: "+e.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"));try{this.writer&&console.log("UNEXPECTED: Writer already exists"),this.writer=this.outputStream.getWriter(),await this.writer.write(e)}catch(e){throw console.log("WARNING: Problem writing data: "+e),e}finally{if(this.writer){try{this.writer.releaseLock()}catch(e){console.log("WARNING: "+e)}this.writer=null}}}async read(e){e||console.log("Read... "+this.buffer.length);let t=null;try{for(;this.buffer.length>0;)null===t&&(t=""),t+=this.buffer.shift()}catch(e){return console.log("WARNING: Problem reading serial data: "+e),null}return e||console.log("RECV: "+(null===t?"<null>":t.replace(/\r/g,"\\r").replace(/\n/g,"\\n").replace(/ /g,"☐"))),t}async cancelRead(){}isBusy(){return!1}}},{"./util.mjs":"x7XL"}],bBqM:[function(e,t,r){"use strict";function n(e){if(0==e)return 0;if(4294967295==e)return-1;const t=2e3+(e>>26&63),r=e>>22&15,n=e>>17&31,o=e>>12&31,i=e>>6&63,a=e>>0&63;try{return t.toString().padStart(4,"0")+"-"+r.toString().padStart(2,"0")+"-"+n.toString().padStart(2,"0")+"T"+o.toString().padStart(2,"0")+":"+i.toString().padStart(2,"0")+":"+a.toString().padStart(2,"0")+"Z"}catch(e){return console.log("WARNING: Invalid date: "+e),null}}function o(e){return(e+32768&65535)-32768}Object.defineProperty(r,"__esModule",{value:!0}),r.parseHeader=function(e){const t={};if(e.byteLength<512)throw new Error("Data too short: "+e.byteLength+" (expected >= 512)");if(e.getUint8(0)!="M".charCodeAt(0)||e.getUint8(1)!="D".charCodeAt(0))throw new Error("Invalid header: "+String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1)));if(t.length=e.getUint16(2,!0),t.length<508)throw new Error("Invalid header length: "+t.length+" (expected >= 512-4)");t.hardwareType=e.getUint8(4),0==t.hardwareType||23==t.hardwareType?t.deviceType="AX3":100==t.hardwareType?t.deviceType="AX6":t.deviceType="?",t.deviceId=e.getUint16(5,!0);const r=e.getUint16(11,!0);65535!=r&&(t.deviceId|=r<<16),t.sessionId=e.getUint32(7,!0),t.loggingStart=n(e.getUint32(13,!0)),t.loggingEnd=n(e.getUint32(17,!0)),t.loggingCapacity=e.getUint32(21,!0),t.flashLed=e.getUint8(26,!0),t.sensorConfig=e.getUint8(35,!0),0!=t.sensorConfig&&255!=t.sensorConfig?t.gyroRange=8e3/2**(15&t.sensorConfig):t.gyroRange=null,t.rateCode=e.getUint8(36,!0),t.frequency=3200/(1<<15-(15&t.rateCode)),t.range=16>>(t.rateCode>>6),t.lastChange=n(e.getUint32(37,!0)),t.firmwareRevision=e.getUint8(41,!0),t.metadataRaw=new TextDecoder("utf-8").decode(e.buffer.slice(64,512));for(let e=t.metadataRaw.length-1;e>=0;e--){const r=t.metadataRaw.charCodeAt(e);if(0!=r&&32!=r&&255!=r){t.metadataRaw=t.metadataRaw.slice(0,e+1);break}if(0==e){t.metadataRaw="";break}}return t},r.parseData=function(e){const t={};if(e.byteLength<512)throw new Error("Data too short: "+e.byteLength+" (expected >= 512)");if(e.getUint8(0)!="A".charCodeAt(0)||e.getUint8(1)!="X".charCodeAt(0))throw new Error("Invalid data header: "+String.fromCharCode(e.getUint8(0))+String.fromCharCode(e.getUint8(1)));if(t.length=e.getUint16(2,!0),508!=t.length)throw new Error("Invalid data length: "+t.length+" (expected >= 512-4)");t.deviceFractional=e.getUint16(4,!0),t.sessionId=e.getUint32(6,!0),t.sequenceId=e.getUint32(10,!0),t.timestampRaw=n(e.getUint32(14,!0)),t.lightRaw=e.getUint16(18,!0),t.light=1023&t.lightRaw,t.temperatureRaw=e.getUint16(20,!0),t.temperature=75*(1023&t.temperatureRaw)/256-50,t.events=e.getUint8(22,!0),t.batteryStored=e.getUint8(23,!0),t.batteryRaw=t.batteryStored+512,t.battery=6e3*t.batteryRaw/1024/1e3,t.rateCode=e.getUint8(24,!0),t.numAxesBPS=e.getUint8(25,!0),t.timestampOffsetRaw=e.getInt16(26,!0),t.sampleCount=e.getUint16(28,!0),t.frequency=3200/(1<<15-(15&t.rateCode)),t.channels=t.numAxesBPS>>4&15,t.bytesPerAxis=15&t.numAxesBPS,0==t.bytesPerAxis&&3==t.channels?t.bytesPerSample=4:t.bytesPerAxis>0&&t.channels>0&&(t.bytesPerSample=t.bytesPerAxis*t.channels),t.samplesPerSector=480/t.bytesPerSample;let r=-1,i=-1,a=-1;t.channels>=6?(i=0,r=3,t.channels>=9&&(a=6)):t.channels>=3&&(r=0);let s=256,c=2e3;s=1<<8+(t.lightRaw>>13&7),t.lightRaw>>10&!0&&(c=Math.floor(8e3/(1<<(t.lightRaw>>10&7))));let u=16;0!=t.rateCode&&(u=16>>(t.rateCode>>6));let l=32768/c;r>=0&&(t.accelAxis=r,t.accelRange=u,t.accelUnit=s),i>=0&&(t.gyroAxis=i,t.gyroRange=c,t.gyroUnit=l),a>=0&&(t.magAxis=a,t.magRange=magRange,t.magUnit=16);let d=0;if(t.timestampOffset=t.timestampOffsetRaw,!0&t.deviceFractional&&(d=(32767&t.deviceFractional)<<1,t.timestampOffset+=d*t.frequency>>16),t.timestamp=new Date(new Date(t.timestampRaw).getTime()+d/65536*1e3),t.samples=[],4==t.bytesPerSample&&3==t.channels)for(let r=0;r<t.sampleCount;r++){const n=30+4*r,i=e.getUint32(n,!0),a=6-(i>>30&3);t.samples.push([(o(65472&i<<6)>>a)/s,(o(65472&i>>4)>>a)/s,(o(65472&i>>14)>>a)/s])}else if(2==t.bytesPerAxis){for(let n=0;n<t.sampleCount;n++){const o=30+2*n*t.channels+2*r;t.samples.push([e.getInt16(o+0,!0)/s,e.getInt16(o+2,!0)/s,e.getInt16(o+4,!0)/s])}if(i>=0){t.samplesGyro=[];for(let r=0;r<t.sampleCount;r++){const n=30+2*r*t.channels+2*i;t.samplesGyro.push([e.getInt16(n+0,!0)/l,e.getInt16(n+2,!0)/l,e.getInt16(n+4,!0)/l])}}}else console.log("ERROR: Unsupported bytes-per-sample: "+t.bytesPerSample);return t}},{}],GF99:[function(e,t,r){arguments[3];var n=arguments[3];function o(){}function i(e){return"object"==typeof e&&null!==e||"function"==typeof e}Object.defineProperty(r,"__esModule",{value:!0}),r.WritableStreamDefaultWriter=r.WritableStreamDefaultController=r.WritableStream=r.TransformStreamDefaultController=r.TransformStream=r.ReadableStreamDefaultReader=r.ReadableStreamDefaultController=r.ReadableStreamBYOBRequest=r.ReadableStreamBYOBReader=r.ReadableStream=r.ReadableByteStreamController=r.CountQueuingStrategy=r.ByteLengthQueuingStrategy=void 0;const a=o;function s(e,t){try{Object.defineProperty(e,"name",{value:t,configurable:!0})}catch(e){}}const c=Promise,u=Promise.prototype.then,l=Promise.reject.bind(c);function d(e){return new c(e)}function f(e){return d(t=>t(e))}function h(e){return l(e)}function p(e,t,r){return u.call(e,t,r)}function g(e,t,r){p(p(e,t,r),void 0,a)}function m(e,t){g(e,t)}function y(e,t){g(e,void 0,t)}function v(e,t,r){return p(e,t,r)}function b(e){p(e,void 0,a)}let w=e=>{if("function"==typeof queueMicrotask)w=queueMicrotask;else{const e=f(void 0);w=t=>p(e,t)}return w(e)};function _(e,t,r){if("function"!=typeof e)throw new TypeError("Argument is not a function");return Function.prototype.apply.call(e,t,r)}function S(e,t,r){try{return f(_(e,t,r))}catch(e){return h(e)}}const R=16384;class x{constructor(){this._cursor=0,this._size=0,this._front={_elements:[],_next:void 0},this._back=this._front,this._cursor=0,this._size=0}get length(){return this._size}push(e){const t=this._back;let r=t;t._elements.length===R-1&&(r={_elements:[],_next:void 0}),t._elements.push(e),r!==t&&(this._back=r,t._next=r),++this._size}shift(){const e=this._front;let t=e;const r=this._cursor;let n=r+1;const o=e._elements,i=o[r];return n===R&&(t=e._next,n=0),--this._size,this._cursor=n,e!==t&&(this._front=t),o[r]=void 0,i}forEach(e){let t=this._cursor,r=this._front,n=r._elements;for(;!(t===n.length&&void 0===r._next||t===n.length&&(t=0,0===(n=(r=r._next)._elements).length));)e(n[t]),++t}peek(){const e=this._front,t=this._cursor;return e._elements[t]}}const E=Symbol("[[AbortSteps]]"),C=Symbol("[[ErrorSteps]]"),O=Symbol("[[CancelSteps]]"),T=Symbol("[[PullSteps]]"),A=Symbol("[[ReleaseSteps]]");function P(e,t){e._ownerReadableStream=t,t._reader=e,"readable"===t._state?M(e):"closed"===t._state?q(e):L(e,t._storedError)}function D(e,t){return Kn(e._ownerReadableStream,t)}function I(e){const t=e._ownerReadableStream;"readable"===t._state?j(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")):N(e,new TypeError("Reader was released and can no longer be used to monitor the stream's closedness")),t._readableStreamController[A](),t._reader=void 0,e._ownerReadableStream=void 0}function k(e){return new TypeError("Cannot "+e+" a stream using a released reader")}function M(e){e._closedPromise=d((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r})}function L(e,t){M(e),j(e,t)}function q(e){M(e),W(e)}function j(e,t){void 0!==e._closedPromise_reject&&(b(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}function N(e,t){L(e,t)}function W(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0)}const U=Number.isFinite||function(e){return"number"==typeof e&&isFinite(e)},B=Math.trunc||function(e){return e<0?Math.ceil(e):Math.floor(e)};function z(e){return"object"==typeof e||"function"==typeof e}function F(e,t){if(void 0!==e&&!z(e))throw new TypeError(`${t} is not an object.`)}function $(e,t){if("function"!=typeof e)throw new TypeError(`${t} is not a function.`)}function V(e){return"object"==typeof e&&null!==e||"function"==typeof e}function G(e,t){if(!V(e))throw new TypeError(`${t} is not an object.`)}function H(e,t,r){if(void 0===e)throw new TypeError(`Parameter ${t} is required in '${r}'.`)}function Y(e,t,r){if(void 0===e)throw new TypeError(`${t} is required in '${r}'.`)}function X(e){return Number(e)}function J(e){return 0===e?0:e}function Q(e){return J(B(e))}function Z(e,t){const r=Number.MAX_SAFE_INTEGER;let n=Number(e);if(n=J(n),!U(n))throw new TypeError(`${t} is not a finite number`);if((n=Q(n))<0||n>r)throw new TypeError(`${t} is outside the accepted range of 0 to ${r}, inclusive`);return U(n)&&0!==n?n:0}function K(e,t){if(!Qn(e))throw new TypeError(`${t} is not a ReadableStream.`)}function ee(e){return new ie(e)}function te(e,t){e._reader._readRequests.push(t)}function re(e,t,r){const n=e._reader._readRequests.shift();r?n._closeSteps():n._chunkSteps(t)}function ne(e){return e._reader._readRequests.length}function oe(e){const t=e._reader;return void 0!==t&&!!ae(t)}class ie{constructor(e){if(H(e,1,"ReadableStreamDefaultReader"),K(e,"First parameter"),Zn(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");P(this,e),this._readRequests=new x}get closed(){return ae(this)?this._closedPromise:h(le("closed"))}cancel(e){return ae(this)?void 0===this._ownerReadableStream?h(k("cancel")):D(this,e):h(le("cancel"))}read(){if(!ae(this))return h(le("read"));if(void 0===this._ownerReadableStream)return h(k("read from"));let e,t;const r=d((r,n)=>{e=r,t=n});return se(this,{_chunkSteps:t=>e({value:t,done:!1}),_closeSteps:()=>e({value:void 0,done:!0}),_errorSteps:e=>t(e)}),r}releaseLock(){if(!ae(this))throw le("releaseLock");void 0!==this._ownerReadableStream&&ce(this)}}function ae(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readRequests")&&e instanceof ie}function se(e,t){const r=e._ownerReadableStream;r._disturbed=!0,"closed"===r._state?t._closeSteps():"errored"===r._state?t._errorSteps(r._storedError):r._readableStreamController[T](t)}function ce(e){I(e),ue(e,new TypeError("Reader was released"))}function ue(e,t){const r=e._readRequests;e._readRequests=new x,r.forEach(e=>{e._errorSteps(t)})}function le(e){return new TypeError(`ReadableStreamDefaultReader.prototype.${e} can only be used on a ReadableStreamDefaultReader`)}r.ReadableStreamDefaultReader=ie,Object.defineProperties(ie.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),s(ie.prototype.cancel,"cancel"),s(ie.prototype.read,"read"),s(ie.prototype.releaseLock,"releaseLock"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(ie.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultReader",configurable:!0});const de=Object.getPrototypeOf(Object.getPrototypeOf(async function*(){}).prototype);class fe{constructor(e,t){this._ongoingPromise=void 0,this._isFinished=!1,this._reader=e,this._preventCancel=t}next(){const e=()=>this._nextSteps();return this._ongoingPromise=this._ongoingPromise?v(this._ongoingPromise,e,e):e(),this._ongoingPromise}return(e){const t=()=>this._returnSteps(e);return this._ongoingPromise?v(this._ongoingPromise,t,t):t()}_nextSteps(){if(this._isFinished)return Promise.resolve({value:void 0,done:!0});const e=this._reader;let t,r;const n=d((e,n)=>{t=e,r=n});return se(e,{_chunkSteps:e=>{this._ongoingPromise=void 0,w(()=>t({value:e,done:!1}))},_closeSteps:()=>{this._ongoingPromise=void 0,this._isFinished=!0,I(e),t({value:void 0,done:!0})},_errorSteps:t=>{this._ongoingPromise=void 0,this._isFinished=!0,I(e),r(t)}}),n}_returnSteps(e){if(this._isFinished)return Promise.resolve({value:e,done:!0});this._isFinished=!0;const t=this._reader;if(!this._preventCancel){const r=D(t,e);return I(t),v(r,()=>({value:e,done:!0}))}return I(t),f({value:e,done:!0})}}const he={next(){return ge(this)?this._asyncIteratorImpl.next():h(me("next"))},return(e){return ge(this)?this._asyncIteratorImpl.return(e):h(me("return"))}};function pe(e,t){const r=ee(e),n=new fe(r,t),o=Object.create(he);return o._asyncIteratorImpl=n,o}function ge(e){if(!i(e))return!1;if(!Object.prototype.hasOwnProperty.call(e,"_asyncIteratorImpl"))return!1;try{return e._asyncIteratorImpl instanceof fe}catch(e){return!1}}function me(e){return new TypeError(`ReadableStreamAsyncIterator.${e} can only be used on a ReadableSteamAsyncIterator`)}Object.setPrototypeOf(he,de);const ye=Number.isNaN||function(e){return e!=e};var ve,be,we;function _e(e){return e.slice()}function Se(e,t,r,n,o){new Uint8Array(e).set(new Uint8Array(r,n,o),t)}let Re=e=>(Re="function"==typeof e.transfer?e=>e.transfer():"function"==typeof structuredClone?e=>structuredClone(e,{transfer:[e]}):e=>e)(e),xe=e=>(xe="boolean"==typeof e.detached?e=>e.detached:e=>0===e.byteLength)(e);function Ee(e,t,r){if(e.slice)return e.slice(t,r);const n=r-t,o=new ArrayBuffer(n);return Se(o,0,e,t,n),o}function Ce(e,t){const r=e[t];if(null!=r){if("function"!=typeof r)throw new TypeError(`${String(t)} is not a function`);return r}}function Oe(e){const t={[Symbol.iterator]:()=>e.iterator},r=async function*(){return yield*t}();return{iterator:r,nextMethod:r.next,done:!1}}const Te=null!==(we=null!==(ve=Symbol.asyncIterator)&&void 0!==ve?ve:null===(be=Symbol.for)||void 0===be?void 0:be.call(Symbol,"Symbol.asyncIterator"))&&void 0!==we?we:"@@asyncIterator";function Ae(e,t="sync",r){if(void 0===r)if("async"===t){if(void 0===(r=Ce(e,Te)))return Oe(Ae(e,"sync",Ce(e,Symbol.iterator)))}else r=Ce(e,Symbol.iterator);if(void 0===r)throw new TypeError("The object is not iterable");const n=_(r,e,[]);if(!i(n))throw new TypeError("The iterator method must return an object");return{iterator:n,nextMethod:n.next,done:!1}}function Pe(e){const t=_(e.nextMethod,e.iterator,[]);if(!i(t))throw new TypeError("The iterator.next() method must return an object");return t}function De(e){return Boolean(e.done)}function Ie(e){return e.value}function ke(e){return!("number"!=typeof e||ye(e)||e<0)}function Me(e){const t=Ee(e.buffer,e.byteOffset,e.byteOffset+e.byteLength);return new Uint8Array(t)}function Le(e){const t=e._queue.shift();return e._queueTotalSize-=t.size,e._queueTotalSize<0&&(e._queueTotalSize=0),t.value}function qe(e,t,r){if(!ke(r)||r===1/0)throw new RangeError("Size must be a finite, non-NaN, non-negative number.");e._queue.push({value:t,size:r}),e._queueTotalSize+=r}function je(e){return e._queue.peek().value}function Ne(e){e._queue=new x,e._queueTotalSize=0}function We(e){return e===DataView}function Ue(e){return We(e.constructor)}function Be(e){return We(e)?1:e.BYTES_PER_ELEMENT}class ze{constructor(){throw new TypeError("Illegal constructor")}get view(){if(!Ve(this))throw Rt("view");return this._view}respond(e){if(!Ve(this))throw Rt("respond");if(H(e,1,"respond"),e=Z(e,"First parameter"),void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(xe(this._view.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be used as a response");vt(this._associatedReadableByteStreamController,e)}respondWithNewView(e){if(!Ve(this))throw Rt("respondWithNewView");if(H(e,1,"respondWithNewView"),!ArrayBuffer.isView(e))throw new TypeError("You can only respond with array buffer views");if(void 0===this._associatedReadableByteStreamController)throw new TypeError("This BYOB request has been invalidated");if(xe(e.buffer))throw new TypeError("The given view's buffer has been detached and so cannot be used as a response");bt(this._associatedReadableByteStreamController,e)}}r.ReadableStreamBYOBRequest=ze,Object.defineProperties(ze.prototype,{respond:{enumerable:!0},respondWithNewView:{enumerable:!0},view:{enumerable:!0}}),s(ze.prototype.respond,"respond"),s(ze.prototype.respondWithNewView,"respondWithNewView"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(ze.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBRequest",configurable:!0});class Fe{constructor(){throw new TypeError("Illegal constructor")}get byobRequest(){if(!$e(this))throw xt("byobRequest");return mt(this)}get desiredSize(){if(!$e(this))throw xt("desiredSize");return yt(this)}close(){if(!$e(this))throw xt("close");if(this._closeRequested)throw new TypeError("The stream has already been closed; do not close it again!");const e=this._controlledReadableByteStream._state;if("readable"!==e)throw new TypeError(`The stream (in ${e} state) is not in the readable state and cannot be closed`);ft(this)}enqueue(e){if(!$e(this))throw xt("enqueue");if(H(e,1,"enqueue"),!ArrayBuffer.isView(e))throw new TypeError("chunk must be an array buffer view");if(0===e.byteLength)throw new TypeError("chunk must have non-zero byteLength");if(0===e.buffer.byteLength)throw new TypeError("chunk's buffer must have non-zero byteLength");if(this._closeRequested)throw new TypeError("stream is closed or draining");const t=this._controlledReadableByteStream._state;if("readable"!==t)throw new TypeError(`The stream (in ${t} state) is not in the readable state and cannot be enqueued to`);ht(this,e)}error(e){if(!$e(this))throw xt("error");pt(this,e)}[O](e){He(this),Ne(this);const t=this._cancelAlgorithm(e);return dt(this),t}[T](e){const t=this._controlledReadableByteStream;if(this._queueTotalSize>0)return void gt(this,e);const r=this._autoAllocateChunkSize;if(void 0!==r){let t;try{t=new ArrayBuffer(r)}catch(t){return void e._errorSteps(t)}const n={buffer:t,bufferByteLength:r,byteOffset:0,byteLength:r,bytesFilled:0,minimumFill:1,elementSize:1,viewConstructor:Uint8Array,readerType:"default"};this._pendingPullIntos.push(n)}te(t,e),Ge(this)}[A](){if(this._pendingPullIntos.length>0){const e=this._pendingPullIntos.peek();e.readerType="none",this._pendingPullIntos=new x,this._pendingPullIntos.push(e)}}}function $e(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableByteStream")&&e instanceof Fe}function Ve(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_associatedReadableByteStreamController")&&e instanceof ze}function Ge(e){lt(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,g(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,Ge(e)),null),t=>(pt(e,t),null))))}function He(e){rt(e),e._pendingPullIntos=new x}function Ye(e,t){let r=!1;"closed"===e._state&&(r=!0);const n=Xe(t);"default"===t.readerType?re(e,n,r):Pt(e,n,r)}function Xe(e){const t=e.bytesFilled,r=e.elementSize;return new e.viewConstructor(e.buffer,e.byteOffset,t/r)}function Je(e,t,r,n){e._queue.push({buffer:t,byteOffset:r,byteLength:n}),e._queueTotalSize+=n}function Qe(e,t,r,n){let o;try{o=Ee(t,r,r+n)}catch(t){throw pt(e,t),t}Je(e,o,0,n)}function Ze(e,t){t.bytesFilled>0&&Qe(e,t.buffer,t.byteOffset,t.bytesFilled),ut(e)}function Ke(e,t){const r=Math.min(e._queueTotalSize,t.byteLength-t.bytesFilled),n=t.bytesFilled+r;let o=r,i=!1;const a=n-n%t.elementSize;a>=t.minimumFill&&(o=a-t.bytesFilled,i=!0);const s=e._queue;for(;o>0;){const r=s.peek(),n=Math.min(o,r.byteLength),i=t.byteOffset+t.bytesFilled;Se(t.buffer,i,r.buffer,r.byteOffset,n),r.byteLength===n?s.shift():(r.byteOffset+=n,r.byteLength-=n),e._queueTotalSize-=n,et(e,n,t),o-=n}return i}function et(e,t,r){r.bytesFilled+=t}function tt(e){0===e._queueTotalSize&&e._closeRequested?(dt(e),eo(e._controlledReadableByteStream)):Ge(e)}function rt(e){null!==e._byobRequest&&(e._byobRequest._associatedReadableByteStreamController=void 0,e._byobRequest._view=null,e._byobRequest=null)}function nt(e){for(;e._pendingPullIntos.length>0;){if(0===e._queueTotalSize)return;const t=e._pendingPullIntos.peek();Ke(e,t)&&(ut(e),Ye(e._controlledReadableByteStream,t))}}function ot(e){const t=e._controlledReadableByteStream._reader;for(;t._readRequests.length>0;){if(0===e._queueTotalSize)return;gt(e,t._readRequests.shift())}}function it(e,t,r,n){const o=e._controlledReadableByteStream,i=t.constructor,a=Be(i),{byteOffset:s,byteLength:c}=t,u=r*a;let l;try{l=Re(t.buffer)}catch(e){return void n._errorSteps(e)}const d={buffer:l,bufferByteLength:l.byteLength,byteOffset:s,byteLength:c,bytesFilled:0,minimumFill:u,elementSize:a,viewConstructor:i,readerType:"byob"};if(e._pendingPullIntos.length>0)return e._pendingPullIntos.push(d),void At(o,n);if("closed"!==o._state){if(e._queueTotalSize>0){if(Ke(e,d)){const t=Xe(d);return tt(e),void n._chunkSteps(t)}if(e._closeRequested){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");return pt(e,t),void n._errorSteps(t)}}e._pendingPullIntos.push(d),At(o,n),Ge(e)}else{const e=new i(d.buffer,d.byteOffset,0);n._closeSteps(e)}}function at(e,t){"none"===t.readerType&&ut(e);const r=e._controlledReadableByteStream;if(It(r))for(;Dt(r)>0;)Ye(r,ut(e))}function st(e,t,r){if(et(0,t,r),"none"===r.readerType)return Ze(e,r),void nt(e);if(r.bytesFilled<r.minimumFill)return;ut(e);const n=r.bytesFilled%r.elementSize;if(n>0){const t=r.byteOffset+r.bytesFilled;Qe(e,r.buffer,t-n,n)}r.bytesFilled-=n,Ye(e._controlledReadableByteStream,r),nt(e)}function ct(e,t){const r=e._pendingPullIntos.peek();rt(e),"closed"===e._controlledReadableByteStream._state?at(e,r):st(e,t,r),Ge(e)}function ut(e){return e._pendingPullIntos.shift()}function lt(e){const t=e._controlledReadableByteStream;return"readable"===t._state&&!e._closeRequested&&!!e._started&&(!!(oe(t)&&ne(t)>0)||!!(It(t)&&Dt(t)>0)||yt(e)>0)}function dt(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0}function ft(e){const t=e._controlledReadableByteStream;if(!e._closeRequested&&"readable"===t._state)if(e._queueTotalSize>0)e._closeRequested=!0;else{if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();if(t.bytesFilled%t.elementSize!=0){const t=new TypeError("Insufficient bytes to fill elements in the given buffer");throw pt(e,t),t}}dt(e),eo(t)}}function ht(e,t){const r=e._controlledReadableByteStream;if(e._closeRequested||"readable"!==r._state)return;const{buffer:n,byteOffset:o,byteLength:i}=t;if(xe(n))throw new TypeError("chunk's buffer is detached and so cannot be enqueued");const a=Re(n);if(e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek();if(xe(t.buffer))throw new TypeError("The BYOB request's buffer has been detached and so cannot be filled with an enqueued chunk");rt(e),t.buffer=Re(t.buffer),"none"===t.readerType&&Ze(e,t)}oe(r)?(ot(e),0===ne(r)?Je(e,a,o,i):(e._pendingPullIntos.length>0&&ut(e),re(r,new Uint8Array(a,o,i),!1))):It(r)?(Je(e,a,o,i),nt(e)):Je(e,a,o,i),Ge(e)}function pt(e,t){const r=e._controlledReadableByteStream;"readable"===r._state&&(He(e),Ne(e),dt(e),to(r,t))}function gt(e,t){const r=e._queue.shift();e._queueTotalSize-=r.byteLength,tt(e);const n=new Uint8Array(r.buffer,r.byteOffset,r.byteLength);t._chunkSteps(n)}function mt(e){if(null===e._byobRequest&&e._pendingPullIntos.length>0){const t=e._pendingPullIntos.peek(),r=new Uint8Array(t.buffer,t.byteOffset+t.bytesFilled,t.byteLength-t.bytesFilled),n=Object.create(ze.prototype);St(n,e,r),e._byobRequest=n}return e._byobRequest}function yt(e){const t=e._controlledReadableByteStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function vt(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t)throw new TypeError("bytesWritten must be 0 when calling respond() on a closed stream")}else{if(0===t)throw new TypeError("bytesWritten must be greater than 0 when calling respond() on a readable stream");if(r.bytesFilled+t>r.byteLength)throw new RangeError("bytesWritten out of range")}r.buffer=Re(r.buffer),ct(e,t)}function bt(e,t){const r=e._pendingPullIntos.peek();if("closed"===e._controlledReadableByteStream._state){if(0!==t.byteLength)throw new TypeError("The view's length must be 0 when calling respondWithNewView() on a closed stream")}else if(0===t.byteLength)throw new TypeError("The view's length must be greater than 0 when calling respondWithNewView() on a readable stream");if(r.byteOffset+r.bytesFilled!==t.byteOffset)throw new RangeError("The region specified by view does not match byobRequest");if(r.bufferByteLength!==t.buffer.byteLength)throw new RangeError("The buffer of view has different capacity than byobRequest");if(r.bytesFilled+t.byteLength>r.byteLength)throw new RangeError("The region specified by view is larger than byobRequest");const n=t.byteLength;r.buffer=Re(t.buffer),ct(e,n)}function wt(e,t,r,n,o,i,a){t._controlledReadableByteStream=e,t._pullAgain=!1,t._pulling=!1,t._byobRequest=null,t._queue=t._queueTotalSize=void 0,Ne(t),t._closeRequested=!1,t._started=!1,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,t._autoAllocateChunkSize=a,t._pendingPullIntos=new x,e._readableStreamController=t,g(f(r()),()=>(t._started=!0,Ge(t),null),e=>(pt(t,e),null))}function _t(e,t,r){const n=Object.create(Fe.prototype);let o,i,a;o=void 0!==t.start?()=>t.start(n):()=>void 0,i=void 0!==t.pull?()=>t.pull(n):()=>f(void 0),a=void 0!==t.cancel?e=>t.cancel(e):()=>f(void 0);const s=t.autoAllocateChunkSize;if(0===s)throw new TypeError("autoAllocateChunkSize must be greater than 0");wt(e,n,o,i,a,r,s)}function St(e,t,r){e._associatedReadableByteStreamController=t,e._view=r}function Rt(e){return new TypeError(`ReadableStreamBYOBRequest.prototype.${e} can only be used on a ReadableStreamBYOBRequest`)}function xt(e){return new TypeError(`ReadableByteStreamController.prototype.${e} can only be used on a ReadableByteStreamController`)}function Et(e,t){F(e,t);const r=null==e?void 0:e.mode;return{mode:void 0===r?void 0:Ct(r,`${t} has member 'mode' that`)}}function Ct(e,t){if("byob"!==(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamReaderMode`);return e}function Ot(e,t){var r;return F(e,t),{min:Z(null!==(r=null==e?void 0:e.min)&&void 0!==r?r:1,`${t} has member 'min' that`)}}function Tt(e){return new kt(e)}function At(e,t){e._reader._readIntoRequests.push(t)}function Pt(e,t,r){const n=e._reader._readIntoRequests.shift();r?n._closeSteps(t):n._chunkSteps(t)}function Dt(e){return e._reader._readIntoRequests.length}function It(e){const t=e._reader;return void 0!==t&&!!Mt(t)}r.ReadableByteStreamController=Fe,Object.defineProperties(Fe.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},byobRequest:{enumerable:!0},desiredSize:{enumerable:!0}}),s(Fe.prototype.close,"close"),s(Fe.prototype.enqueue,"enqueue"),s(Fe.prototype.error,"error"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Fe.prototype,Symbol.toStringTag,{value:"ReadableByteStreamController",configurable:!0});class kt{constructor(e){if(H(e,1,"ReadableStreamBYOBReader"),K(e,"First parameter"),Zn(e))throw new TypeError("This stream has already been locked for exclusive reading by another reader");if(!$e(e._readableStreamController))throw new TypeError("Cannot construct a ReadableStreamBYOBReader for a stream not constructed with a byte source");P(this,e),this._readIntoRequests=new x}get closed(){return Mt(this)?this._closedPromise:h(Nt("closed"))}cancel(e){return Mt(this)?void 0===this._ownerReadableStream?h(k("cancel")):D(this,e):h(Nt("cancel"))}read(e,t={}){if(!Mt(this))return h(Nt("read"));if(!ArrayBuffer.isView(e))return h(new TypeError("view must be an array buffer view"));if(0===e.byteLength)return h(new TypeError("view must have non-zero byteLength"));if(0===e.buffer.byteLength)return h(new TypeError("view's buffer must have non-zero byteLength"));if(xe(e.buffer))return h(new TypeError("view's buffer has been detached"));let r;try{r=Ot(t,"options")}catch(e){return h(e)}const n=r.min;if(0===n)return h(new TypeError("options.min must be greater than 0"));if(Ue(e)){if(n>e.byteLength)return h(new RangeError("options.min must be less than or equal to view's byteLength"))}else if(n>e.length)return h(new RangeError("options.min must be less than or equal to view's length"));if(void 0===this._ownerReadableStream)return h(k("read from"));let o,i;const a=d((e,t)=>{o=e,i=t});return Lt(this,e,n,{_chunkSteps:e=>o({value:e,done:!1}),_closeSteps:e=>o({value:e,done:!0}),_errorSteps:e=>i(e)}),a}releaseLock(){if(!Mt(this))throw Nt("releaseLock");void 0!==this._ownerReadableStream&&qt(this)}}function Mt(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readIntoRequests")&&e instanceof kt}function Lt(e,t,r,n){const o=e._ownerReadableStream;o._disturbed=!0,"errored"===o._state?n._errorSteps(o._storedError):it(o._readableStreamController,t,r,n)}function qt(e){I(e),jt(e,new TypeError("Reader was released"))}function jt(e,t){const r=e._readIntoRequests;e._readIntoRequests=new x,r.forEach(e=>{e._errorSteps(t)})}function Nt(e){return new TypeError(`ReadableStreamBYOBReader.prototype.${e} can only be used on a ReadableStreamBYOBReader`)}function Wt(e,t){const{highWaterMark:r}=e;if(void 0===r)return t;if(ye(r)||r<0)throw new RangeError("Invalid highWaterMark");return r}function Ut(e){const{size:t}=e;return t||(()=>1)}function Bt(e,t){F(e,t);const r=null==e?void 0:e.highWaterMark,n=null==e?void 0:e.size;return{highWaterMark:void 0===r?void 0:X(r),size:void 0===n?void 0:zt(n,`${t} has member 'size' that`)}}function zt(e,t){return $(e,t),t=>X(e(t))}function Ft(e,t){F(e,t);const r=null==e?void 0:e.abort,n=null==e?void 0:e.close,o=null==e?void 0:e.start,i=null==e?void 0:e.type,a=null==e?void 0:e.write;return{abort:void 0===r?void 0:$t(r,e,`${t} has member 'abort' that`),close:void 0===n?void 0:Vt(n,e,`${t} has member 'close' that`),start:void 0===o?void 0:Gt(o,e,`${t} has member 'start' that`),write:void 0===a?void 0:Ht(a,e,`${t} has member 'write' that`),type:i}}function $t(e,t,r){return $(e,r),r=>S(e,t,[r])}function Vt(e,t,r){return $(e,r),()=>S(e,t,[])}function Gt(e,t,r){return $(e,r),r=>_(e,t,[r])}function Ht(e,t,r){return $(e,r),(r,n)=>S(e,t,[r,n])}function Yt(e,t){if(!rr(e))throw new TypeError(`${t} is not a WritableStream.`)}function Xt(e){if("object"!=typeof e||null===e)return!1;try{return"boolean"==typeof e.aborted}catch(e){return!1}}r.ReadableStreamBYOBReader=kt,Object.defineProperties(kt.prototype,{cancel:{enumerable:!0},read:{enumerable:!0},releaseLock:{enumerable:!0},closed:{enumerable:!0}}),s(kt.prototype.cancel,"cancel"),s(kt.prototype.read,"read"),s(kt.prototype.releaseLock,"releaseLock"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(kt.prototype,Symbol.toStringTag,{value:"ReadableStreamBYOBReader",configurable:!0});const Jt="function"==typeof AbortController;function Qt(){if(Jt)return new AbortController}class Zt{constructor(e={},t={}){void 0===e?e=null:G(e,"First parameter");const r=Bt(t,"Second parameter"),n=Ft(e,"First parameter");if(tr(this),void 0!==n.type)throw new RangeError("Invalid type is specified");const o=Ut(r);Mr(this,n,Wt(r,1),o)}get locked(){if(!rr(this))throw Gr("locked");return nr(this)}abort(e){return rr(this)?nr(this)?h(new TypeError("Cannot abort a stream that already has a writer")):or(this,e):h(Gr("abort"))}close(){return rr(this)?nr(this)?h(new TypeError("Cannot close a stream that already has a writer")):pr(this)?h(new TypeError("Cannot close an already-closing stream")):ir(this):h(Gr("close"))}getWriter(){if(!rr(this))throw Gr("getWriter");return Kt(this)}}function Kt(e){return new wr(e)}function er(e,t,r,n,o=1,i=(()=>1)){const a=Object.create(Zt.prototype);return tr(a),kr(a,Object.create(Dr.prototype),e,t,r,n,o,i),a}function tr(e){e._state="writable",e._storedError=void 0,e._writer=void 0,e._writableStreamController=void 0,e._writeRequests=new x,e._inFlightWriteRequest=void 0,e._closeRequest=void 0,e._inFlightCloseRequest=void 0,e._pendingAbortRequest=void 0,e._backpressure=!1}function rr(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_writableStreamController")&&e instanceof Zt}function nr(e){return void 0!==e._writer}function or(e,t){var r;if("closed"===e._state||"errored"===e._state)return f(void 0);e._writableStreamController._abortReason=t,null===(r=e._writableStreamController._abortController)||void 0===r||r.abort(t);const n=e._state;if("closed"===n||"errored"===n)return f(void 0);if(void 0!==e._pendingAbortRequest)return e._pendingAbortRequest._promise;let o=!1;"erroring"===n&&(o=!0,t=void 0);const i=d((r,n)=>{e._pendingAbortRequest={_promise:void 0,_resolve:r,_reject:n,_reason:t,_wasAlreadyErroring:o}});return e._pendingAbortRequest._promise=i,o||cr(e,t),i}function ir(e){const t=e._state;if("closed"===t||"errored"===t)return h(new TypeError(`The stream (in ${t} state) is not in the writable state and cannot be closed`));const r=d((t,r)=>{const n={_resolve:t,_reject:r};e._closeRequest=n}),n=e._writer;return void 0!==n&&e._backpressure&&"writable"===t&&un(n),qr(e._writableStreamController),r}function ar(e){return d((t,r)=>{const n={_resolve:t,_reject:r};e._writeRequests.push(n)})}function sr(e,t){"writable"!==e._state?ur(e):cr(e,t)}function cr(e,t){const r=e._writableStreamController;e._state="erroring",e._storedError=t;const n=e._writer;void 0!==n&&Cr(n,t),!gr(e)&&r._started&&ur(e)}function ur(e){e._state="errored",e._writableStreamController[C]();const t=e._storedError;if(e._writeRequests.forEach(e=>{e._reject(t)}),e._writeRequests=new x,void 0===e._pendingAbortRequest)return void vr(e);const r=e._pendingAbortRequest;if(e._pendingAbortRequest=void 0,r._wasAlreadyErroring)return r._reject(t),void vr(e);g(e._writableStreamController[E](r._reason),()=>(r._resolve(),vr(e),null),t=>(r._reject(t),vr(e),null))}function lr(e){e._inFlightWriteRequest._resolve(void 0),e._inFlightWriteRequest=void 0}function dr(e,t){e._inFlightWriteRequest._reject(t),e._inFlightWriteRequest=void 0,sr(e,t)}function fr(e){e._inFlightCloseRequest._resolve(void 0),e._inFlightCloseRequest=void 0,"erroring"===e._state&&(e._storedError=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._resolve(),e._pendingAbortRequest=void 0)),e._state="closed";const t=e._writer;void 0!==t&&tn(t)}function hr(e,t){e._inFlightCloseRequest._reject(t),e._inFlightCloseRequest=void 0,void 0!==e._pendingAbortRequest&&(e._pendingAbortRequest._reject(t),e._pendingAbortRequest=void 0),sr(e,t)}function pr(e){return void 0!==e._closeRequest||void 0!==e._inFlightCloseRequest}function gr(e){return void 0!==e._inFlightWriteRequest||void 0!==e._inFlightCloseRequest}function mr(e){e._inFlightCloseRequest=e._closeRequest,e._closeRequest=void 0}function yr(e){e._inFlightWriteRequest=e._writeRequests.shift()}function vr(e){void 0!==e._closeRequest&&(e._closeRequest._reject(e._storedError),e._closeRequest=void 0);const t=e._writer;void 0!==t&&Kr(t,e._storedError)}function br(e,t){const r=e._writer;void 0!==r&&t!==e._backpressure&&(t?sn(r):un(r)),e._backpressure=t}r.WritableStream=Zt,Object.defineProperties(Zt.prototype,{abort:{enumerable:!0},close:{enumerable:!0},getWriter:{enumerable:!0},locked:{enumerable:!0}}),s(Zt.prototype.abort,"abort"),s(Zt.prototype.close,"close"),s(Zt.prototype.getWriter,"getWriter"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Zt.prototype,Symbol.toStringTag,{value:"WritableStream",configurable:!0});class wr{constructor(e){if(H(e,1,"WritableStreamDefaultWriter"),Yt(e,"First parameter"),nr(e))throw new TypeError("This stream has already been locked for exclusive writing by another writer");this._ownerWritableStream=e,e._writer=this;const t=e._state;if("writable"===t)!pr(e)&&e._backpressure?rn(this):on(this),Jr(this);else if("erroring"===t)nn(this,e._storedError),Jr(this);else if("closed"===t)on(this),Zr(this);else{const t=e._storedError;nn(this,t),Qr(this,t)}}get closed(){return _r(this)?this._closedPromise:h(Yr("closed"))}get desiredSize(){if(!_r(this))throw Yr("desiredSize");if(void 0===this._ownerWritableStream)throw Xr("desiredSize");return Or(this)}get ready(){return _r(this)?this._readyPromise:h(Yr("ready"))}abort(e){return _r(this)?void 0===this._ownerWritableStream?h(Xr("abort")):Sr(this,e):h(Yr("abort"))}close(){if(!_r(this))return h(Yr("close"));const e=this._ownerWritableStream;return void 0===e?h(Xr("close")):pr(e)?h(new TypeError("Cannot close an already-closing stream")):Rr(this)}releaseLock(){if(!_r(this))throw Yr("releaseLock");void 0!==this._ownerWritableStream&&Tr(this)}write(e){return _r(this)?void 0===this._ownerWritableStream?h(Xr("write to")):Ar(this,e):h(Yr("write"))}}function _r(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_ownerWritableStream")&&e instanceof wr}function Sr(e,t){return or(e._ownerWritableStream,t)}function Rr(e){return ir(e._ownerWritableStream)}function xr(e){const t=e._ownerWritableStream,r=t._state;return pr(t)||"closed"===r?f(void 0):"errored"===r?h(t._storedError):Rr(e)}function Er(e,t){"pending"===e._closedPromiseState?Kr(e,t):en(e,t)}function Cr(e,t){"pending"===e._readyPromiseState?an(e,t):cn(e,t)}function Or(e){const t=e._ownerWritableStream,r=t._state;return"errored"===r||"erroring"===r?null:"closed"===r?0:Nr(t._writableStreamController)}function Tr(e){const t=e._ownerWritableStream,r=new TypeError("Writer was released and can no longer be used to monitor the stream's closedness");Cr(e,r),Er(e,r),t._writer=void 0,e._ownerWritableStream=void 0}function Ar(e,t){const r=e._ownerWritableStream,n=r._writableStreamController,o=jr(n,t);if(r!==e._ownerWritableStream)return h(Xr("write to"));const i=r._state;if("errored"===i)return h(r._storedError);if(pr(r)||"closed"===i)return h(new TypeError("The stream is closing or closed and cannot be written to"));if("erroring"===i)return h(r._storedError);const a=ar(r);return Wr(n,t,o),a}r.WritableStreamDefaultWriter=wr,Object.defineProperties(wr.prototype,{abort:{enumerable:!0},close:{enumerable:!0},releaseLock:{enumerable:!0},write:{enumerable:!0},closed:{enumerable:!0},desiredSize:{enumerable:!0},ready:{enumerable:!0}}),s(wr.prototype.abort,"abort"),s(wr.prototype.close,"close"),s(wr.prototype.releaseLock,"releaseLock"),s(wr.prototype.write,"write"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(wr.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultWriter",configurable:!0});const Pr={};class Dr{constructor(){throw new TypeError("Illegal constructor")}get abortReason(){if(!Ir(this))throw Hr("abortReason");return this._abortReason}get signal(){if(!Ir(this))throw Hr("signal");if(void 0===this._abortController)throw new TypeError("WritableStreamDefaultController.prototype.signal is not supported");return this._abortController.signal}error(e){if(!Ir(this))throw Hr("error");"writable"===this._controlledWritableStream._state&&Vr(this,e)}[E](e){const t=this._abortAlgorithm(e);return Lr(this),t}[C](){Ne(this)}}function Ir(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledWritableStream")&&e instanceof Dr}function kr(e,t,r,n,o,i,a,s){t._controlledWritableStream=e,e._writableStreamController=t,t._queue=void 0,t._queueTotalSize=void 0,Ne(t),t._abortReason=void 0,t._abortController=Qt(),t._started=!1,t._strategySizeAlgorithm=s,t._strategyHWM=a,t._writeAlgorithm=n,t._closeAlgorithm=o,t._abortAlgorithm=i;const c=$r(t);br(e,c),g(f(r()),()=>(t._started=!0,Ur(t),null),r=>(t._started=!0,sr(e,r),null))}function Mr(e,t,r,n){const o=Object.create(Dr.prototype);let i,a,s,c;i=void 0!==t.start?()=>t.start(o):()=>void 0,a=void 0!==t.write?e=>t.write(e,o):()=>f(void 0),s=void 0!==t.close?()=>t.close():()=>f(void 0),c=void 0!==t.abort?e=>t.abort(e):()=>f(void 0),kr(e,o,i,a,s,c,r,n)}function Lr(e){e._writeAlgorithm=void 0,e._closeAlgorithm=void 0,e._abortAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function qr(e){qe(e,Pr,0),Ur(e)}function jr(e,t){try{return e._strategySizeAlgorithm(t)}catch(t){return Br(e,t),1}}function Nr(e){return e._strategyHWM-e._queueTotalSize}function Wr(e,t,r){try{qe(e,t,r)}catch(t){return void Br(e,t)}const n=e._controlledWritableStream;pr(n)||"writable"!==n._state||br(n,$r(e)),Ur(e)}function Ur(e){const t=e._controlledWritableStream;if(!e._started)return;if(void 0!==t._inFlightWriteRequest)return;if("erroring"===t._state)return void ur(t);if(0===e._queue.length)return;const r=je(e);r===Pr?zr(e):Fr(e,r)}function Br(e,t){"writable"===e._controlledWritableStream._state&&Vr(e,t)}function zr(e){const t=e._controlledWritableStream;mr(t),Le(e);const r=e._closeAlgorithm();Lr(e),g(r,()=>(fr(t),null),e=>(hr(t,e),null))}function Fr(e,t){const r=e._controlledWritableStream;yr(r),g(e._writeAlgorithm(t),()=>{lr(r);const t=r._state;if(Le(e),!pr(r)&&"writable"===t){const t=$r(e);br(r,t)}return Ur(e),null},t=>("writable"===r._state&&Lr(e),dr(r,t),null))}function $r(e){return Nr(e)<=0}function Vr(e,t){const r=e._controlledWritableStream;Lr(e),cr(r,t)}function Gr(e){return new TypeError(`WritableStream.prototype.${e} can only be used on a WritableStream`)}function Hr(e){return new TypeError(`WritableStreamDefaultController.prototype.${e} can only be used on a WritableStreamDefaultController`)}function Yr(e){return new TypeError(`WritableStreamDefaultWriter.prototype.${e} can only be used on a WritableStreamDefaultWriter`)}function Xr(e){return new TypeError("Cannot "+e+" a stream using a released writer")}function Jr(e){e._closedPromise=d((t,r)=>{e._closedPromise_resolve=t,e._closedPromise_reject=r,e._closedPromiseState="pending"})}function Qr(e,t){Jr(e),Kr(e,t)}function Zr(e){Jr(e),tn(e)}function Kr(e,t){void 0!==e._closedPromise_reject&&(b(e._closedPromise),e._closedPromise_reject(t),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="rejected")}function en(e,t){Qr(e,t)}function tn(e){void 0!==e._closedPromise_resolve&&(e._closedPromise_resolve(void 0),e._closedPromise_resolve=void 0,e._closedPromise_reject=void 0,e._closedPromiseState="resolved")}function rn(e){e._readyPromise=d((t,r)=>{e._readyPromise_resolve=t,e._readyPromise_reject=r}),e._readyPromiseState="pending"}function nn(e,t){rn(e),an(e,t)}function on(e){rn(e),un(e)}function an(e,t){void 0!==e._readyPromise_reject&&(b(e._readyPromise),e._readyPromise_reject(t),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="rejected")}function sn(e){rn(e)}function cn(e,t){nn(e,t)}function un(e){void 0!==e._readyPromise_resolve&&(e._readyPromise_resolve(void 0),e._readyPromise_resolve=void 0,e._readyPromise_reject=void 0,e._readyPromiseState="fulfilled")}function ln(){return"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:void 0!==n?n:void 0}r.WritableStreamDefaultController=Dr,Object.defineProperties(Dr.prototype,{abortReason:{enumerable:!0},signal:{enumerable:!0},error:{enumerable:!0}}),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Dr.prototype,Symbol.toStringTag,{value:"WritableStreamDefaultController",configurable:!0});const dn=ln();function fn(e){if("function"!=typeof e&&"object"!=typeof e)return!1;if("DOMException"!==e.name)return!1;try{return new e,!0}catch(e){return!1}}function hn(){const e=null==dn?void 0:dn.DOMException;return fn(e)?e:void 0}function pn(){const e=function(e,t){this.message=e||"",this.name=t||"Error",Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)};return s(e,"DOMException"),e.prototype=Object.create(Error.prototype),Object.defineProperty(e.prototype,"constructor",{value:e,writable:!0,configurable:!0}),e}const gn=hn()||pn();function mn(e,t,r,n,i,a){const s=ee(e),c=Kt(t);e._disturbed=!0;let u=!1,l=f(void 0);return d((h,v)=>{let w;if(void 0!==a){if(w=()=>{const r=void 0!==a.reason?a.reason:new gn("Aborted","AbortError"),o=[];n||o.push(()=>"writable"===t._state?or(t,r):f(void 0)),i||o.push(()=>"readable"===e._state?Kn(e,r):f(void 0)),R(()=>Promise.all(o.map(e=>e())),!0,r)},a.aborted)return void w();a.addEventListener("abort",w)}if(S(e,s._closedPromise,e=>(n?x(!0,e):R(()=>or(t,e),!0,e),null)),S(t,c._closedPromise,t=>(i?x(!0,t):R(()=>Kn(e,t),!0,t),null)),function(e,t,r){"closed"===e._state?r():m(t,r)}(e,s._closedPromise,()=>(r?x():R(()=>xr(c)),null)),pr(t)||"closed"===t._state){const t=new TypeError("the destination writable stream closed before all data could be piped to it");i?x(!0,t):R(()=>Kn(e,t),!0,t)}function _(){const e=l;return p(l,()=>e!==l?_():void 0)}function S(e,t,r){"errored"===e._state?r(e._storedError):y(t,r)}function R(e,r,n){function o(){return g(e(),()=>E(r,n),e=>E(!0,e)),null}u||(u=!0,"writable"!==t._state||pr(t)?o():m(_(),o))}function x(e,r){u||(u=!0,"writable"!==t._state||pr(t)?E(e,r):m(_(),()=>E(e,r)))}function E(e,t){return Tr(c),I(s),void 0!==a&&a.removeEventListener("abort",w),e?v(t):h(void 0),null}b(d((e,t)=>{!function r(n){n?e():p(u?f(!0):p(c._readyPromise,()=>d((e,t)=>{se(s,{_chunkSteps:t=>{l=p(Ar(c,t),void 0,o),e(!1)},_closeSteps:()=>e(!0),_errorSteps:t})})),r,t)}(!1)}))})}class yn{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!vn(this))throw Pn("desiredSize");return En(this)}close(){if(!vn(this))throw Pn("close");if(!On(this))throw new TypeError("The stream is not in a state that permits close");Sn(this)}enqueue(e){if(!vn(this))throw Pn("enqueue");if(!On(this))throw new TypeError("The stream is not in a state that permits enqueue");return Rn(this,e)}error(e){if(!vn(this))throw Pn("error");xn(this,e)}[O](e){Ne(this);const t=this._cancelAlgorithm(e);return _n(this),t}[T](e){const t=this._controlledReadableStream;if(this._queue.length>0){const r=Le(this);this._closeRequested&&0===this._queue.length?(_n(this),eo(t)):bn(this),e._chunkSteps(r)}else te(t,e),bn(this)}[A](){}}function vn(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledReadableStream")&&e instanceof yn}function bn(e){wn(e)&&(e._pulling?e._pullAgain=!0:(e._pulling=!0,g(e._pullAlgorithm(),()=>(e._pulling=!1,e._pullAgain&&(e._pullAgain=!1,bn(e)),null),t=>(xn(e,t),null))))}function wn(e){const t=e._controlledReadableStream;return!!On(e)&&!!e._started&&(!!(Zn(t)&&ne(t)>0)||En(e)>0)}function _n(e){e._pullAlgorithm=void 0,e._cancelAlgorithm=void 0,e._strategySizeAlgorithm=void 0}function Sn(e){if(!On(e))return;const t=e._controlledReadableStream;e._closeRequested=!0,0===e._queue.length&&(_n(e),eo(t))}function Rn(e,t){if(!On(e))return;const r=e._controlledReadableStream;if(Zn(r)&&ne(r)>0)re(r,t,!1);else{let r;try{r=e._strategySizeAlgorithm(t)}catch(t){throw xn(e,t),t}try{qe(e,t,r)}catch(t){throw xn(e,t),t}}bn(e)}function xn(e,t){const r=e._controlledReadableStream;"readable"===r._state&&(Ne(e),_n(e),to(r,t))}function En(e){const t=e._controlledReadableStream._state;return"errored"===t?null:"closed"===t?0:e._strategyHWM-e._queueTotalSize}function Cn(e){return!wn(e)}function On(e){const t=e._controlledReadableStream._state;return!e._closeRequested&&"readable"===t}function Tn(e,t,r,n,o,i,a){t._controlledReadableStream=e,t._queue=void 0,t._queueTotalSize=void 0,Ne(t),t._started=!1,t._closeRequested=!1,t._pullAgain=!1,t._pulling=!1,t._strategySizeAlgorithm=a,t._strategyHWM=i,t._pullAlgorithm=n,t._cancelAlgorithm=o,e._readableStreamController=t,g(f(r()),()=>(t._started=!0,bn(t),null),e=>(xn(t,e),null))}function An(e,t,r,n){const o=Object.create(yn.prototype);let i,a,s;i=void 0!==t.start?()=>t.start(o):()=>void 0,a=void 0!==t.pull?()=>t.pull(o):()=>f(void 0),s=void 0!==t.cancel?e=>t.cancel(e):()=>f(void 0),Tn(e,o,i,a,s,r,n)}function Pn(e){return new TypeError(`ReadableStreamDefaultController.prototype.${e} can only be used on a ReadableStreamDefaultController`)}function Dn(e,t){return $e(e._readableStreamController)?kn(e):In(e)}function In(e,t){const r=ee(e);let n,o,i,a,s,c=!1,u=!1,l=!1,h=!1;const p=d(e=>{s=e});function g(){return c?(u=!0,f(void 0)):(c=!0,se(r,{_chunkSteps:e=>{w(()=>{u=!1;const t=e,r=e;l||Rn(i._readableStreamController,t),h||Rn(a._readableStreamController,r),c=!1,u&&g()})},_closeSteps:()=>{c=!1,l||Sn(i._readableStreamController),h||Sn(a._readableStreamController),l&&h||s(void 0)},_errorSteps:()=>{c=!1}}),f(void 0))}function m(){}return i=Yn(m,g,function(t){if(l=!0,n=t,h){const t=_e([n,o]),r=Kn(e,t);s(r)}return p}),a=Yn(m,g,function(t){if(h=!0,o=t,l){const t=_e([n,o]),r=Kn(e,t);s(r)}return p}),y(r._closedPromise,e=>(xn(i._readableStreamController,e),xn(a._readableStreamController,e),l&&h||s(void 0),null)),[i,a]}function kn(e){let t,r,n,o,i,a=ee(e),s=!1,c=!1,u=!1,l=!1,h=!1;const p=d(e=>{i=e});function g(e){y(e._closedPromise,t=>e!==a?null:(pt(n._readableStreamController,t),pt(o._readableStreamController,t),l&&h||i(void 0),null))}function m(){Mt(a)&&(I(a),g(a=ee(e))),se(a,{_chunkSteps:t=>{w(()=>{c=!1,u=!1;const r=t;let a=t;if(!l&&!h)try{a=Me(t)}catch(t){return pt(n._readableStreamController,t),pt(o._readableStreamController,t),void i(Kn(e,t))}l||ht(n._readableStreamController,r),h||ht(o._readableStreamController,a),s=!1,c?b():u&&_()})},_closeSteps:()=>{s=!1,l||ft(n._readableStreamController),h||ft(o._readableStreamController),n._readableStreamController._pendingPullIntos.length>0&&vt(n._readableStreamController,0),o._readableStreamController._pendingPullIntos.length>0&&vt(o._readableStreamController,0),l&&h||i(void 0)},_errorSteps:()=>{s=!1}})}function v(t,r){ae(a)&&(I(a),g(a=Tt(e)));const d=r?o:n,f=r?n:o;Lt(a,t,1,{_chunkSteps:t=>{w(()=>{c=!1,u=!1;const n=r?h:l;if(r?l:h)n||bt(d._readableStreamController,t);else{let r;try{r=Me(t)}catch(t){return pt(d._readableStreamController,t),pt(f._readableStreamController,t),void i(Kn(e,t))}n||bt(d._readableStreamController,t),ht(f._readableStreamController,r)}s=!1,c?b():u&&_()})},_closeSteps:e=>{s=!1;const t=r?h:l,n=r?l:h;t||ft(d._readableStreamController),n||ft(f._readableStreamController),void 0!==e&&(t||bt(d._readableStreamController,e),!n&&f._readableStreamController._pendingPullIntos.length>0&&vt(f._readableStreamController,0)),t&&n||i(void 0)},_errorSteps:()=>{s=!1}})}function b(){if(s)return c=!0,f(void 0);s=!0;const e=mt(n._readableStreamController);return null===e?m():v(e._view,!1),f(void 0)}function _(){if(s)return u=!0,f(void 0);s=!0;const e=mt(o._readableStreamController);return null===e?m():v(e._view,!0),f(void 0)}function S(){}return n=Xn(S,b,function(n){if(l=!0,t=n,h){const n=_e([t,r]),o=Kn(e,n);i(o)}return p}),o=Xn(S,_,function(n){if(h=!0,r=n,l){const n=_e([t,r]),o=Kn(e,n);i(o)}return p}),g(a),[n,o]}function Mn(e){return i(e)&&void 0!==e.getReader}function Ln(e){return Mn(e)?jn(e.getReader()):qn(e)}function qn(e){let t;const r=Ae(e,"async");return t=Yn(o,function(){let e;try{e=Pe(r)}catch(e){return h(e)}return v(f(e),e=>{if(!i(e))throw new TypeError("The promise returned by the iterator.next() method must fulfill with an object");if(De(e))Sn(t._readableStreamController);else{const r=Ie(e);Rn(t._readableStreamController,r)}})},function(e){const t=r.iterator;let n,o;try{n=Ce(t,"return")}catch(e){return h(e)}if(void 0===n)return f(void 0);try{o=_(n,t,[e])}catch(e){return h(e)}return v(f(o),e=>{if(!i(e))throw new TypeError("The promise returned by the iterator.return() method must fulfill with an object")})},0)}function jn(e){let t;return t=Yn(o,function(){let r;try{r=e.read()}catch(e){return h(e)}return v(r,e=>{if(!i(e))throw new TypeError("The promise returned by the reader.read() method must fulfill with an object");if(e.done)Sn(t._readableStreamController);else{const r=e.value;Rn(t._readableStreamController,r)}})},function(t){try{return f(e.cancel(t))}catch(e){return h(e)}},0)}function Nn(e,t){F(e,t);const r=e,n=null==r?void 0:r.autoAllocateChunkSize,o=null==r?void 0:r.cancel,i=null==r?void 0:r.pull,a=null==r?void 0:r.start,s=null==r?void 0:r.type;return{autoAllocateChunkSize:void 0===n?void 0:Z(n,`${t} has member 'autoAllocateChunkSize' that`),cancel:void 0===o?void 0:Wn(o,r,`${t} has member 'cancel' that`),pull:void 0===i?void 0:Un(i,r,`${t} has member 'pull' that`),start:void 0===a?void 0:Bn(a,r,`${t} has member 'start' that`),type:void 0===s?void 0:zn(s,`${t} has member 'type' that`)}}function Wn(e,t,r){return $(e,r),r=>S(e,t,[r])}function Un(e,t,r){return $(e,r),r=>S(e,t,[r])}function Bn(e,t,r){return $(e,r),r=>_(e,t,[r])}function zn(e,t){if("bytes"!==(e=`${e}`))throw new TypeError(`${t} '${e}' is not a valid enumeration value for ReadableStreamType`);return e}function Fn(e,t){F(e,t);const r=null==e?void 0:e.preventCancel;return{preventCancel:Boolean(r)}}function $n(e,t){F(e,t);const r=null==e?void 0:e.preventAbort,n=null==e?void 0:e.preventCancel,o=null==e?void 0:e.preventClose,i=null==e?void 0:e.signal;return void 0!==i&&Vn(i,`${t} has member 'signal' that`),{preventAbort:Boolean(r),preventCancel:Boolean(n),preventClose:Boolean(o),signal:i}}function Vn(e,t){if(!Xt(e))throw new TypeError(`${t} is not an AbortSignal.`)}function Gn(e,t){F(e,t);const r=null==e?void 0:e.readable;Y(r,"readable","ReadableWritablePair"),K(r,`${t} has member 'readable' that`);const n=null==e?void 0:e.writable;return Y(n,"writable","ReadableWritablePair"),Yt(n,`${t} has member 'writable' that`),{readable:r,writable:n}}r.ReadableStreamDefaultController=yn,Object.defineProperties(yn.prototype,{close:{enumerable:!0},enqueue:{enumerable:!0},error:{enumerable:!0},desiredSize:{enumerable:!0}}),s(yn.prototype.close,"close"),s(yn.prototype.enqueue,"enqueue"),s(yn.prototype.error,"error"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(yn.prototype,Symbol.toStringTag,{value:"ReadableStreamDefaultController",configurable:!0});class Hn{constructor(e={},t={}){void 0===e?e=null:G(e,"First parameter");const r=Bt(t,"Second parameter"),n=Nn(e,"First parameter");if(Jn(this),"bytes"===n.type){if(void 0!==r.size)throw new RangeError("The strategy for a byte stream cannot have a size function");_t(this,n,Wt(r,0))}else{const e=Ut(r);An(this,n,Wt(r,1),e)}}get locked(){if(!Qn(this))throw ro("locked");return Zn(this)}cancel(e){return Qn(this)?Zn(this)?h(new TypeError("Cannot cancel a stream that already has a reader")):Kn(this,e):h(ro("cancel"))}getReader(e){if(!Qn(this))throw ro("getReader");return void 0===Et(e,"First parameter").mode?ee(this):Tt(this)}pipeThrough(e,t={}){if(!Qn(this))throw ro("pipeThrough");H(e,1,"pipeThrough");const r=Gn(e,"First parameter"),n=$n(t,"Second parameter");if(Zn(this))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked ReadableStream");if(nr(r.writable))throw new TypeError("ReadableStream.prototype.pipeThrough cannot be used on a locked WritableStream");return b(mn(this,r.writable,n.preventClose,n.preventAbort,n.preventCancel,n.signal)),r.readable}pipeTo(e,t={}){if(!Qn(this))return h(ro("pipeTo"));if(void 0===e)return h("Parameter 1 is required in 'pipeTo'.");if(!rr(e))return h(new TypeError("ReadableStream.prototype.pipeTo's first argument must be a WritableStream"));let r;try{r=$n(t,"Second parameter")}catch(e){return h(e)}return Zn(this)?h(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked ReadableStream")):nr(e)?h(new TypeError("ReadableStream.prototype.pipeTo cannot be used on a locked WritableStream")):mn(this,e,r.preventClose,r.preventAbort,r.preventCancel,r.signal)}tee(){if(!Qn(this))throw ro("tee");return _e(Dn(this))}values(e){if(!Qn(this))throw ro("values");return pe(this,Fn(e,"First parameter").preventCancel)}[Te](e){return this.values(e)}static from(e){return Ln(e)}}function Yn(e,t,r,n=1,o=(()=>1)){const i=Object.create(Hn.prototype);return Jn(i),Tn(i,Object.create(yn.prototype),e,t,r,n,o),i}function Xn(e,t,r){const n=Object.create(Hn.prototype);return Jn(n),wt(n,Object.create(Fe.prototype),e,t,r,0,void 0),n}function Jn(e){e._state="readable",e._reader=void 0,e._storedError=void 0,e._disturbed=!1}function Qn(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_readableStreamController")&&e instanceof Hn}function Zn(e){return void 0!==e._reader}function Kn(e,t){if(e._disturbed=!0,"closed"===e._state)return f(void 0);if("errored"===e._state)return h(e._storedError);eo(e);const r=e._reader;if(void 0!==r&&Mt(r)){const e=r._readIntoRequests;r._readIntoRequests=new x,e.forEach(e=>{e._closeSteps(void 0)})}return v(e._readableStreamController[O](t),o)}function eo(e){e._state="closed";const t=e._reader;if(void 0!==t&&(W(t),ae(t))){const e=t._readRequests;t._readRequests=new x,e.forEach(e=>{e._closeSteps()})}}function to(e,t){e._state="errored",e._storedError=t;const r=e._reader;void 0!==r&&(j(r,t),ae(r)?ue(r,t):jt(r,t))}function ro(e){return new TypeError(`ReadableStream.prototype.${e} can only be used on a ReadableStream`)}function no(e,t){F(e,t);const r=null==e?void 0:e.highWaterMark;return Y(r,"highWaterMark","QueuingStrategyInit"),{highWaterMark:X(r)}}r.ReadableStream=Hn,Object.defineProperties(Hn,{from:{enumerable:!0}}),Object.defineProperties(Hn.prototype,{cancel:{enumerable:!0},getReader:{enumerable:!0},pipeThrough:{enumerable:!0},pipeTo:{enumerable:!0},tee:{enumerable:!0},values:{enumerable:!0},locked:{enumerable:!0}}),s(Hn.from,"from"),s(Hn.prototype.cancel,"cancel"),s(Hn.prototype.getReader,"getReader"),s(Hn.prototype.pipeThrough,"pipeThrough"),s(Hn.prototype.pipeTo,"pipeTo"),s(Hn.prototype.tee,"tee"),s(Hn.prototype.values,"values"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Hn.prototype,Symbol.toStringTag,{value:"ReadableStream",configurable:!0}),Object.defineProperty(Hn.prototype,Te,{value:Hn.prototype.values,writable:!0,configurable:!0});const oo=e=>e.byteLength;s(oo,"size");class io{constructor(e){H(e,1,"ByteLengthQueuingStrategy"),e=no(e,"First parameter"),this._byteLengthQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!so(this))throw ao("highWaterMark");return this._byteLengthQueuingStrategyHighWaterMark}get size(){if(!so(this))throw ao("size");return oo}}function ao(e){return new TypeError(`ByteLengthQueuingStrategy.prototype.${e} can only be used on a ByteLengthQueuingStrategy`)}function so(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_byteLengthQueuingStrategyHighWaterMark")&&e instanceof io}r.ByteLengthQueuingStrategy=io,Object.defineProperties(io.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(io.prototype,Symbol.toStringTag,{value:"ByteLengthQueuingStrategy",configurable:!0});const co=()=>1;s(co,"size");class uo{constructor(e){H(e,1,"CountQueuingStrategy"),e=no(e,"First parameter"),this._countQueuingStrategyHighWaterMark=e.highWaterMark}get highWaterMark(){if(!fo(this))throw lo("highWaterMark");return this._countQueuingStrategyHighWaterMark}get size(){if(!fo(this))throw lo("size");return co}}function lo(e){return new TypeError(`CountQueuingStrategy.prototype.${e} can only be used on a CountQueuingStrategy`)}function fo(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_countQueuingStrategyHighWaterMark")&&e instanceof uo}function ho(e,t){F(e,t);const r=null==e?void 0:e.cancel,n=null==e?void 0:e.flush,o=null==e?void 0:e.readableType,i=null==e?void 0:e.start,a=null==e?void 0:e.transform,s=null==e?void 0:e.writableType;return{cancel:void 0===r?void 0:yo(r,e,`${t} has member 'cancel' that`),flush:void 0===n?void 0:po(n,e,`${t} has member 'flush' that`),readableType:o,start:void 0===i?void 0:go(i,e,`${t} has member 'start' that`),transform:void 0===a?void 0:mo(a,e,`${t} has member 'transform' that`),writableType:s}}function po(e,t,r){return $(e,r),r=>S(e,t,[r])}function go(e,t,r){return $(e,r),r=>_(e,t,[r])}function mo(e,t,r){return $(e,r),(r,n)=>S(e,t,[r,n])}function yo(e,t,r){return $(e,r),r=>S(e,t,[r])}r.CountQueuingStrategy=uo,Object.defineProperties(uo.prototype,{highWaterMark:{enumerable:!0},size:{enumerable:!0}}),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(uo.prototype,Symbol.toStringTag,{value:"CountQueuingStrategy",configurable:!0});class vo{constructor(e={},t={},r={}){void 0===e&&(e=null);const n=Bt(t,"Second parameter"),o=Bt(r,"Third parameter"),i=ho(e,"First parameter");if(void 0!==i.readableType)throw new RangeError("Invalid readableType specified");if(void 0!==i.writableType)throw new RangeError("Invalid writableType specified");const a=Wt(o,0),s=Ut(o),c=Wt(n,1),u=Ut(n);let l;bo(this,d(e=>{l=e}),c,u,a,s),To(this,i),void 0!==i.start?l(i.start(this._transformStreamController)):l(void 0)}get readable(){if(!wo(this))throw zo("readable");return this._readable}get writable(){if(!wo(this))throw zo("writable");return this._writable}}function bo(e,t,r,n,o,i){function a(){return t}e._writable=er(a,function(t){return Mo(e,t)},function(){return qo(e)},function(t){return Lo(e,t)},r,n),e._readable=Yn(a,function(){return jo(e)},function(t){return No(e,t)},o,i),e._backpressure=void 0,e._backpressureChangePromise=void 0,e._backpressureChangePromise_resolve=void 0,xo(e,!0),e._transformStreamController=void 0}function wo(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_transformStreamController")&&e instanceof vo}function _o(e,t){xn(e._readable._readableStreamController,t),So(e,t)}function So(e,t){Ao(e._transformStreamController),Br(e._writable._writableStreamController,t),Ro(e)}function Ro(e){e._backpressure&&xo(e,!1)}function xo(e,t){void 0!==e._backpressureChangePromise&&e._backpressureChangePromise_resolve(),e._backpressureChangePromise=d(t=>{e._backpressureChangePromise_resolve=t}),e._backpressure=t}r.TransformStream=vo,Object.defineProperties(vo.prototype,{readable:{enumerable:!0},writable:{enumerable:!0}}),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(vo.prototype,Symbol.toStringTag,{value:"TransformStream",configurable:!0});class Eo{constructor(){throw new TypeError("Illegal constructor")}get desiredSize(){if(!Co(this))throw Wo("desiredSize");return En(this._controlledTransformStream._readable._readableStreamController)}enqueue(e){if(!Co(this))throw Wo("enqueue");Po(this,e)}error(e){if(!Co(this))throw Wo("error");Do(this,e)}terminate(){if(!Co(this))throw Wo("terminate");ko(this)}}function Co(e){return!!i(e)&&!!Object.prototype.hasOwnProperty.call(e,"_controlledTransformStream")&&e instanceof Eo}function Oo(e,t,r,n,o){t._controlledTransformStream=e,e._transformStreamController=t,t._transformAlgorithm=r,t._flushAlgorithm=n,t._cancelAlgorithm=o,t._finishPromise=void 0,t._finishPromise_resolve=void 0,t._finishPromise_reject=void 0}function To(e,t){const r=Object.create(Eo.prototype);let n,o,i;n=void 0!==t.transform?e=>t.transform(e,r):e=>{try{return Po(r,e),f(void 0)}catch(e){return h(e)}},o=void 0!==t.flush?()=>t.flush(r):()=>f(void 0),i=void 0!==t.cancel?e=>t.cancel(e):()=>f(void 0),Oo(e,r,n,o,i)}function Ao(e){e._transformAlgorithm=void 0,e._flushAlgorithm=void 0,e._cancelAlgorithm=void 0}function Po(e,t){const r=e._controlledTransformStream,n=r._readable._readableStreamController;if(!On(n))throw new TypeError("Readable side is not in a state that permits enqueue");try{Rn(n,t)}catch(e){throw So(r,e),r._readable._storedError}Cn(n)!==r._backpressure&&xo(r,!0)}function Do(e,t){_o(e._controlledTransformStream,t)}function Io(e,t){return v(e._transformAlgorithm(t),void 0,t=>{throw _o(e._controlledTransformStream,t),t})}function ko(e){const t=e._controlledTransformStream;Sn(t._readable._readableStreamController),So(t,new TypeError("TransformStream terminated"))}function Mo(e,t){const r=e._transformStreamController;return e._backpressure?v(e._backpressureChangePromise,()=>{const n=e._writable;if("erroring"===n._state)throw n._storedError;return Io(r,t)}):Io(r,t)}function Lo(e,t){const r=e._transformStreamController;if(void 0!==r._finishPromise)return r._finishPromise;const n=e._readable;r._finishPromise=d((e,t)=>{r._finishPromise_resolve=e,r._finishPromise_reject=t});const o=r._cancelAlgorithm(t);return Ao(r),g(o,()=>("errored"===n._state?Bo(r,n._storedError):(xn(n._readableStreamController,t),Uo(r)),null),e=>(xn(n._readableStreamController,e),Bo(r,e),null)),r._finishPromise}function qo(e){const t=e._transformStreamController;if(void 0!==t._finishPromise)return t._finishPromise;const r=e._readable;t._finishPromise=d((e,r)=>{t._finishPromise_resolve=e,t._finishPromise_reject=r});const n=t._flushAlgorithm();return Ao(t),g(n,()=>("errored"===r._state?Bo(t,r._storedError):(Sn(r._readableStreamController),Uo(t)),null),e=>(xn(r._readableStreamController,e),Bo(t,e),null)),t._finishPromise}function jo(e){return xo(e,!1),e._backpressureChangePromise}function No(e,t){const r=e._transformStreamController;if(void 0!==r._finishPromise)return r._finishPromise;const n=e._writable;r._finishPromise=d((e,t)=>{r._finishPromise_resolve=e,r._finishPromise_reject=t});const o=r._cancelAlgorithm(t);return Ao(r),g(o,()=>("errored"===n._state?Bo(r,n._storedError):(Br(n._writableStreamController,t),Ro(e),Uo(r)),null),t=>(Br(n._writableStreamController,t),Ro(e),Bo(r,t),null)),r._finishPromise}function Wo(e){return new TypeError(`TransformStreamDefaultController.prototype.${e} can only be used on a TransformStreamDefaultController`)}function Uo(e){void 0!==e._finishPromise_resolve&&(e._finishPromise_resolve(),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function Bo(e,t){void 0!==e._finishPromise_reject&&(b(e._finishPromise),e._finishPromise_reject(t),e._finishPromise_resolve=void 0,e._finishPromise_reject=void 0)}function zo(e){return new TypeError(`TransformStream.prototype.${e} can only be used on a TransformStream`)}r.TransformStreamDefaultController=Eo,Object.defineProperties(Eo.prototype,{enqueue:{enumerable:!0},error:{enumerable:!0},terminate:{enumerable:!0},desiredSize:{enumerable:!0}}),s(Eo.prototype.enqueue,"enqueue"),s(Eo.prototype.error,"error"),s(Eo.prototype.terminate,"terminate"),"symbol"==typeof Symbol.toStringTag&&Object.defineProperty(Eo.prototype,Symbol.toStringTag,{value:"TransformStreamDefaultController",configurable:!0})},{}],xAlh:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.streamSaver=void 0;const n={WritableStream:e("./web-streams-ponyfill.es2018.mjs").WritableStream},o="object"==typeof window?window:void 0;o.HTMLElement||console.warn("streamsaver is meant to run on browsers main thread");let i=null,a=!1;const s=o.isSecureContext;let c=/constructor/i.test(o.HTMLElement)||!!o.safari||!!o.WebKitPoint;const u=s||"MozAppearance"in document.documentElement.style?"iframe":"navigate",l={createWriteStream:function(e,t,r){let n={size:null,pathname:null,writableStrategy:void 0,readableStrategy:void 0},o=0,s=null,h=null,p=null;if(Number.isFinite(t)?([r,t]=[t,r],console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),n.size=r,n.writableStrategy=t):t&&t.highWaterMark?(console.warn("[StreamSaver] Deprecated pass an object as 2nd argument when creating a write stream"),n.size=r,n.writableStrategy=t):n=t||{},!c){f(),h=new MessageChannel,e=encodeURIComponent(e.replace(/\//g,":")).replace(/['()]/g,escape).replace(/\*/g,"%2A");const t={transferringReadable:a,pathname:n.pathname||Math.random().toString().slice(-6)+"/"+e,headers:{"Content-Type":"application/octet-stream; charset=utf-8","Content-Disposition":"attachment; filename*=UTF-8''"+e}};n.size&&(t.headers["Content-Length"]=n.size);const r=[t,"*",[h.port2]];if(a){const e="iframe"===u?void 0:{transform(e,t){if(!(e instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");o+=e.length,t.enqueue(e),s&&(location.href=s,s=null)},flush(){s&&(location.href=s)}},t=(p=new l.TransformStream(e,n.writableStrategy,n.readableStrategy)).readable;h.port1.postMessage({readableStream:t},[t])}h.port1.onmessage=e=>{e.data.download?"navigate"===u?(i.remove(),i=null,o?location.href=e.data.download:s=e.data.download):(i.isPopup&&(i.remove(),i=null,"iframe"===u&&d(l.mitm)),d(e.data.download)):e.data.abort&&(g=[],h.port1.postMessage("abort"),h.port1.onmessage=null,h.port1.close(),h.port2.close(),h=null)},i.loaded?i.postMessage(...r):i.addEventListener("load",()=>{i.postMessage(...r)},{once:!0})}let g=[];return!c&&p&&p.writable||new l.WritableStream({write(e){if(!(e instanceof Uint8Array))throw new TypeError("Can only write Uint8Arrays");c?g.push(e):(h.port1.postMessage(e),o+=e.length,s&&(location.href=s,s=null))},close(){if(c){const t=new Blob(g,{type:"application/octet-stream; charset=utf-8"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.download=e,r.click()}else h.port1.postMessage("end")},abort(){g=[],h.port1.postMessage("abort"),h.port1.onmessage=null,h.port1.close(),h.port2.close(),h=null}},n.writableStrategy)},WritableStream:o.WritableStream||n.WritableStream,supported:!0,version:{full:"2.0.5",major:2,minor:0,dot:5},mitm:"https://jimmywarting.github.io/StreamSaver.js/mitm.html?version=2.0.0"};function d(e){if(!e)throw new Error("meh");const t=document.createElement("iframe");return t.hidden=!0,t.src=e,t.loaded=!1,t.name="iframe",t.isIframe=!0,t.postMessage=(...e)=>t.contentWindow.postMessage(...e),t.addEventListener("load",()=>{t.loaded=!0},{once:!0}),document.body.appendChild(t),t}r.streamSaver=l;try{new Response(new ReadableStream),!s||"serviceWorker"in navigator||(c=!0)}catch(e){c=!0}function f(){i||(i=s?d(l.mitm):function(e){const t=document.createDocumentFragment(),r={frame:o.open(e,"popup","width=200,height=100"),loaded:!1,isIframe:!1,isPopup:!0,remove(){r.frame.close()},addEventListener(...e){t.addEventListener(...e)},dispatchEvent(...e){t.dispatchEvent(...e)},removeEventListener(...e){t.removeEventListener(...e)},postMessage(...e){r.frame.postMessage(...e)}},n=e=>{e.source===r.frame&&(r.loaded=!0,o.removeEventListener("message",n),r.dispatchEvent(new Event("load")))};return o.addEventListener("message",n),r}(l.mitm))}(e=>{try{e()}catch(e){}})(()=>{const{readable:e}=new TransformStream,t=new MessageChannel;t.port1.postMessage(e,[e]),t.port1.close(),t.port2.close(),a=!0,Object.defineProperty(l,"TransformStream",{configurable:!1,writable:!1,value:TransformStream})})},{"./web-streams-ponyfill.es2018.mjs":"GF99"}],sLgq:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=e("./util.mjs"),o=e("./cwa_parse.mjs"),i=e("./streamsaver.mjs");function a(e){return[...new Uint8Array(e.buffer?e.buffer:e)].map(e=>e.toString(16).padStart(2,"0")).join(" ")}let s=!1;async function c(e,t,r){if(console.log("DOWNLOAD: start"),!s&&!1!==s){console.log("DOWNLOAD: scripts need to be dynamically loaded");const e=["./streamsaver/web-streams-polyfill.min.js","./streamsaver/StreamSaver.js"];s=[];for(const t of e){const e=document.createElement("script");e.type="text/javascript",e.src=t,e.promise=new Promise((t,r)=>{e.onload=t,e.onerror=r}),document.body.prepend(e),s.push(e)}}!1!==s&&(console.log("DOWNLOAD: waiting for scripts to be loaded"),await Promise.all(s.map(e=>e.promise)),console.log("DOWNLOAD: scripts loaded")),location.protocol;const n={};null!==t&&t>=0&&(n.size=t);let o=i.streamSaver.createWriteStream(e,n).getWriter();o.fileSize=t;const a=()=>{o&&(r(null),o.abort(),o=null)};try{for(window.addEventListener("unload",a);;){if(!o)throw new Error("Writer is aborted");if(!await r(o))break}o.close()}catch(e){throw console.log("DOWNLOAD: error - "+e),a(),e}finally{window.removeEventListener("unload",a)}return!0}class u{constructor(e,t,r){this.output=e,this.prefix=t,this.timeout=r}isTerminal(e){return!(!this.prefix&&""!==this.prefix||!e.startsWith(this.prefix))}}class l{constructor(e,t=!1){this.started=(new Date).getTime(),this.command=e,this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t}),this.lines=[],this.completed=!1,this.error=null,this.quiet=t}addResponse(e){this.lines.push(e);const t=this.command.isTerminal(e);return this.quiet||console.log(`...now have ${this.lines.length} line(s) (terminal=${t})`),!!t}lastLine(){return this.completed&&this.lines.length>0?this.lines[this.lines.length-1]:null}complete(e=null){null!=e?(console.log("COMMAND-REJECT: "+e),this.error=e,this.reject(this)):(this.quiet||console.log("COMMAND-RESOLVE"),this.completed=!0,this.resolve(this))}checkTimeout(){const e=(new Date).getTime()-this.started;return!(this.completed||this.error||!this.command.timeout||!(e>=this.command.timeout))}}class d{constructor(e){if(this.device=e,console.log("--- COMMS ---"),console.log(this.device.productName),console.log(this.device.manufacturerName),console.log(this.device.serialNumber),this.serial=function(e){if(null==e)return null;if(!(e=e.trim()).startsWith("AX")&&!e.startsWith("CWA"))return null;for(let t=e.length-1;;t--)if(t<0||!(e.charCodeAt(t)>=48&&e.charCodeAt(t)<=57))return t+1>=e.length?null:parseInt(e.substring(t+1))}(this.device.serialNumber),console.log("SERIAL: "+this.serial),this.deviceType=null,this.device.serialNumber){const e=this.device.serialNumber.trim();e.startsWith("CWA")?this.deviceType="AX3":e.startsWith("AX")&&(this.deviceType=e.substring(0,3))}this.hasGyro="AX6"===this.deviceType,this.commandQueue=[],this.currentCommand=null,this.currentTimeout=null,this.rejectRead=null,this.nextTick=null,this.receiveBuffer="",this.statusHandler=null,this.status={id:{deviceId:null},battery:{percent:null,time:null},start:null,stop:null,state:null,errorState:null},this.recalculateRecordingStatus()}setStatusHandler(e){this.statusHandler=e}statusChanged(){this.statusHandler&&this.statusHandler(this,this.status)}updateState(e,t){console.log("STATE: "+e+" / "+t),this.status.state=e,this.status.errorState=t,this.statusChanged()}async exec(e,t=!1){const r=new l(e,t);return r.quiet||console.log(`exec() command=${e.output.replace(/[\r\n]/g,"|")} commandQueue.length=${this.commandQueue.length} currentCommand=${this.currentCommand} nextTick=${this.nextTick}`),this.commandQueue.push(r),null==this.currentCommand&&null==this.nextTick&&(r.quiet||console.log("exec(): bootstrap"),this.nextTick=setTimeout(async()=>{r.quiet||console.log("exec(): bootstrap..."),await this.execNext(),r.quiet||console.log("exec(): bootstrap... done")},0)),r.quiet||console.log("exec(): return"),r.promise}async execNext(){try{if(this.nextTick=!0,null==this.currentCommand){if(this.commandQueue.length<=0)return void(this.nextTick=null);this.currentCommand=this.commandQueue.shift(),this.currentCommand.command.timeout?(this.currentCommand.quiet||console.log("execNext(): setting up new timeout: "+this.currentCommand.command.timeout),this.currentTimeout=setTimeout(this.timeout.bind(this),this.currentCommand.command.timeout)):console.log("execNext(): command has no timeout");try{this.currentCommand.quiet||console.log("execNext(): write: "+this.currentCommand.command.output.replace(/[\r\n]/g,"|")),await this.write(this.currentCommand.command.output,this.currentCommand.quiet),this.currentCommand.quiet||console.log("execNext(): write: (done)")}catch(e){console.log("execNext(): write: exception: "+e),this.commandComplete(e)}}if(this.currentCommand){let e=null;try{this.currentCommand&&this.currentCommand.checkTimeout()?(console.log("execNext(): timeout before read"),this.commandComplete("Timeout before read")):(this.currentCommand.quiet||console.log("execNext(): read"),e=await this.read(this.currentCommand.quiet))}catch(e){console.log("execNext(): read exception: "+e),this.commandComplete(e)}if(null===e&&"serial"===this.device.type&&null===e&&(await this.write("\r",this.currentCommand.quiet),await(0,n.sleep)(100)),this.currentCommand&&null!==e)for(this.receiveBuffer+=e;;){const e=this.receiveBuffer.indexOf("\n");if(e<0)break;const t=this.receiveBuffer.slice(0,e).trim();if(this.currentCommand.quiet||console.log("LINE: "+t),this.receiveBuffer=this.receiveBuffer.slice(e+1),this.currentCommand.addResponse(t)){this.currentCommand.quiet||console.log("execNext(): end"),this.commandComplete();break}}}}catch(e){console.log("execNext(): Exception during processing: "+e)}this.nextTick=setTimeout(async()=>{await this.execNext()},0)}async timeout(){try{console.log("timeout(): ..."),this.currentTimeout=null,this.rejectRead&&(console.log("timeout(): ...reject read..."),this.rejectRead(null)),this.currentCommand?(console.log("timeout(): ...cancel read..."),await this.device.cancelRead(),this.commandComplete("Timeout")):console.log("timeout(): no current command"),console.log("timeout(): ...done")}catch(e){console.log("timeout(): ERROR: "+e)}}commandComplete(e=null){if(null!==e?console.log("commandComplete(): FAILED "+e+" -- "+(this.currentCommand?this.currentCommand.command.output:"-")):this.currentCommand&&this.currentCommand.quiet||console.log("commandComplete(): SUCCESS -- "+(this.currentCommand?this.currentCommand.command.output:"-")),this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentCommand){const t=this.currentCommand;this.currentCommand=null,t.complete(e)}}async open(){this.receiveBuffer="",await this.device.open(),console.log("...opened")}async close(){return await this.device.close()}async write(e,t){await this.device.write(e,t)}async read(e){const t=new Promise((e,t)=>{this.rejectRead=t});return Promise.race([t,this.device.read(e)])}parseDateTime(e){if("0"==e)return 0;if("-1"==e)return-1;const t=parseInt(e.substring(0,4),10),r=parseInt(e.substring(5,7),10),n=parseInt(e.substring(8,10),10),o=parseInt(e.substring(11,13),10),i=parseInt(e.substring(14,16),10),a=parseInt(e.substring(17,19),10),s=new Date(t,r-1,n,o,i,a,0);return s.getFullYear()<2e3?0:s.getFullYear()>=2064?-1:s}packDateTime(e=null){if(null===e&&(e=new Date),0==e)return"0";if(-1==e)return"-1";let t=e.getFullYear()+"/";return(t=(t=(t=(t=t+(e.getMonth()+1<10?"0":"")+(e.getMonth()+1)+"/")+(e.getDate()<10?"0":"")+e.getDate()+",")+(e.getHours()<10?"0":"")+e.getHours()+":")+(e.getMinutes()<10?"0":"")+e.getMinutes()+":")+(e.getSeconds()<10?"0":"")+e.getSeconds()}async getConfigOptions(){const e={accelRate:[6.25,12.5,25,50,100,200,400,800,1600,3200],accelRange:[2,4,8,16]};return this.hasGyro&&(e.gyroRange=[0,250,500,1e3,2e3]),e}async setId(e){const t=new u(`\r\nDEVICE=${e}\r\n`,"DEVICE=",2e3);console.log(">>> "+t.output);const r=(await this.exec(t)).lastLine();console.log("<<< "+r);const n=r.substring(r.indexOf("=")+1).split(",").map(e=>parseInt(e,10));if(n[0]!=e||n[1]!=e)throw`DEVICE value unexpected: was ${n[0]} / ${n[1]}, expected ${e}`}async getId(){const e=new u("\r\nID\r\n","ID=",2e3);console.log(">>> "+e.output);const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const r=t.substring(t.indexOf("=")+1).split(",");return this.hasGyro="AX6"===r[0],{deviceType:"CWA"==r[0]?"AX3":r[0],deviceId:parseInt(r[3],10),firmwareVersion:parseInt(r[2],10)}}async getBattery(){const e=new u("\r\nSAMPLE 1\r\n","$BATT=",2e3);console.log(">>> "+e.output);const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const r=t.substring(t.indexOf("=")+1).split(",").map(e=>parseInt(e,10));return{voltage:r[1]/1e3,percent:r[3],charging:r[4],time:new Date}}async setLed(e){const t=new u(`\r\nLED ${e}\r\n`,"LED=",2e3);console.log(">>> "+t.output);const r=(await this.exec(t)).lastLine();console.log("<<< "+r);const n=r.substring(r.indexOf("=")+1).split(",").map(e=>parseInt(e,10));if(n[0]!=e)throw`LED value unexpected: was ${n[0]}, expected ${e}`}async getTime(){const e=new u("\r\nTIME\r\n","$TIME=",2e3);console.log(">>> "+e.output);const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const r=t.substring(t.indexOf("=")+1);return this.parseDateTime(r)}async setTime(e=null){this.updateState("Configuring: Setting time");let t=e;null===t&&(t=new Date);const r=this.packDateTime(t),n=new u(`\r\nTIME ${r}\r\n`,"$TIME=",2e3);console.log(">>> "+n.output);const o=(await this.exec(n)).lastLine();console.log("<<< "+o);const i=this.parseDateTime(o.substring(o.indexOf("=")+1)),a=i.getTime()-t.getTime();if(Math.abs(a)>2e3)throw`Time value difference too large: received ${i.toISOString()}, expected closer to ${t.toISOString()}`}async getSession(){const e=new u("\r\nSESSION\r\n","SESSION=",2e3);console.log(">>> "+e.output);const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const r=t.substring(t.indexOf("=")+1).split(",").map(e=>parseInt(e,10));return parseInt(r[0])}async setSession(e){const t=parseInt(e);if(this.updateState("Configuring: Setting session ID"),"number"!=typeof t||isNaN(t)||t<0||t>2147483647)throw"Session ID invalid value";const r=new u(`\r\nSESSION ${t}\r\n`,"SESSION=",2e3);console.log(">>> "+r.output);const n=(await this.exec(r)).lastLine();console.log("<<< "+n);const o=n.substring(n.indexOf("=")+1).split(",").map(e=>parseInt(e,10));if(o[0]!=t)throw`SESSION value unexpected: was ${o[0]}, expected ${t}`}async getMaxSamples(){const e=new u("\r\nMAXSAMPLES\r\n","MAXSAMPLES=",2e3);console.log(">>> "+e.output);const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const r=t.substring(t.indexOf("=")+1).split(",").map(e=>parseInt(e,10));return parseInt(r[0])}async setMaxSamples(e){this.updateState("Configuring: Setting max. samples");const t=new u(`\r\nMAXSAMPLES ${e}\r\n`,"MAXSAMPLES=",2e3);console.log(">>> "+t.output);const r=(await this.exec(t)).lastLine();console.log("<<< "+r);const n=r.substring(r.indexOf("=")+1).split(",").map(e=>parseInt(e,10));if(n[0]!=e)throw`MAXSAMPLES value unexpected: was ${n[0]}, expected ${e}`}async getHibernate(e){const t=new u("\r\nHIBERNATE\r\n","HIBERNATE=",2e3);console.log(">>> "+t.output);const r=(await this.exec(t)).lastLine();console.log("<<< "+r);const n=r.substring(r.indexOf("=")+1);return this.parseDateTime(n)}async setHibernate(e){this.updateState("Configuring: Setting start");const t=this.packDateTime(e),r=new u(`\r\nHIBERNATE ${t}\r\n`,"HIBERNATE=",2e3);console.log(">>> "+r.output);const n=(await this.exec(r)).lastLine();console.log("<<< "+n);const o=n.substring(n.indexOf("=")+1);if(t!=o)throw`HIBERNATE value unexpected: was ${o}, expected ${t}`}async getStop(e){const t=new u("\r\nSTOP\r\n","STOP=",2e3);console.log(">>> "+t.output);const r=(await this.exec(t)).lastLine();console.log("<<< "+r);const n=r.substring(r.indexOf("=")+1);return this.parseDateTime(n)}async setStop(e){this.updateState("Configuring: Setting stop");const t=this.packDateTime(e),r=new u(`\r\nSTOP ${t}\r\n`,"STOP=",2e3);console.log(">>> "+r.output);const n=(await this.exec(r)).lastLine();console.log("<<< "+n);const o=n.substring(n.indexOf("=")+1);if(o.indexOf(t)<0)throw`STOP value unexpected: was ${o}, expected ${t}`}async getRate(){const e=new u("\r\nRATE\r\n","RATE=",2e3);console.log(">>> "+e.output);const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const r=t.substring(t.indexOf("=")+1).split(",").map(e=>parseInt(e,10)),n=parseInt(r[0]);let o=0;return 0==(192&n)?o=16:64==(192&n)?o=8:128==(192&n)?o=4:192==(192&n)&&(o=2),{rateCode:n,rate:r.length>1?parseInt(r[1]):null,accelRange:o,gyroRange:r.length>2?parseInt(r[2]):null}}async setRate(e,t,r,n){this.updateState("Configuring: Setting rate");let o=0;switch(parseFloat(e)){case 3200:o|=15;break;case 1600:o|=14;break;case 800:o|=13;break;case 400:o|=12;break;case 200:o|=11;break;case 100:o|=10;break;case 50:o|=9;break;case 25:o|=8;break;case 12.5:case 12:o|=7;break;case 6.25:case 6:o|=6;break;default:throw"Invalid accelerometer frequency."}if(this.hasGyro&&parseFloat(e)>1600)throw"This device has a maximum rate of 1600Hz.";if(!this.hasGyro&&n&&parseFloat(e)<12)throw"This device has a minimum rate of 12.5Hz in packed mode.";if(this.hasGyro&&r&&parseFloat(e)<25)throw"This device has a minimum rate of 25Hz with the gyroscope enabled.";switch(parseInt(t)){case 16:o|=0;break;case 8:o|=64;break;case 4:o|=128;break;case 2:o|=192;break;default:throw"Invalid accelerometer sensitivity."}let i=null;if(r){if(!this.hasGyro)throw"Cannot configure gyroscope on device without gyroscope.";switch(parseInt(r)){case 2e3:case 1e3:case 500:case 250:i=parseInt(r);break;default:throw"Invalid gyro range: "+parseInt(r)}}const a=new u(i?`\r\nRATE ${o},${i}\r\n`:`\r\nRATE ${o}\r\n`,"RATE=",2e3);console.log(">>> "+a.output);const s=(await this.exec(a)).lastLine();console.log("<<< "+s);const c=s.substring(s.indexOf("=")+1).split(",").map(e=>parseInt(e,10));if(c[0]!=o)throw`RATE value unexpected: was ${c[0]}, expected ${o}`;if(c[1]!=Math.floor(e))throw`RATE frequency unexpected: was ${c[1]}, expected ${Math.floor(e)}`;if(i&&c[2]!=i)throw`RATE gyro range unexpected: was ${c[2]}, expected ${i}`}async getStatus(){const e={ftl:null,restart:null,nandid:null},t=new u("\r\nSTATUS\r\nECHO\r\n","ECHO=",2e3);console.log(">>> "+t.output);const r=await this.exec(t);for(let t of r.lines)t.startsWith("FTL=")?e.ftl=t.substring(t.indexOf("=")+1):t.startsWith("RESTART=")?e.restart=t.substring(t.indexOf("=")+1):t.startsWith("NANDID=")&&(e.nandid=t.substring(t.indexOf("=")+1));return e}async getLog(){const e=[],t=new u("\r\nLOG\r\n","LOG,0",2e3);console.log(">>> "+t.output);const r=await this.exec(t);for(let t of r.lines){const r=t.split(",");if("LOG"!=r[0])continue;const n=parseInt(r[1]),o={index:n,time:this.parseDateTime(r[3]+" "+r[4]),code:r[2],status:/[_A-Z]*/.exec(r[5])[0]};e[n]=o}return e}async setDebug(e){let t=!0===e?3:+e;this.updateState("Configuring: Setting flash status");const r=new u(`\rDEBUG ${t}\r\n`,"DEBUG=",2e3);console.log(">>> "+r.output);const n=(await this.exec(r)).lastLine();console.log("<<< "+n);const o=n.substring(n.indexOf("=")+1).split(",").map(e=>parseInt(e,10));if(o[0]!=t)throw`DEBUG value unexpected: was ${o[0]}, expected ${t}`}async readSector(e,t=null,r=0,n=null){const o=new u(`\r\nREADL ${e}\r\nECHO\r\n`,"ECHO=",1e4);console.log(`>>> READL ${e}`);const i=await this.exec(o,!0);t||(t=new ArrayBuffer(512)),null===n&&(n=512);const a=new DataView(t,r,n);let s=0;for(let e of i.lines){if(e.startsWith("READL="))continue;if(e.startsWith("OK"))continue;if(e.startsWith("ECHO="))continue;const t=(e=e.trim()).split(":",1)[0],r=parseInt(t,16);if(r!=s)throw`Unexpected sector offset ${r}, expected ${s}`;const o=e.replace(/\ /g,"").slice(t.length+1,t.length+1+32),i=o.length/2;if(16!=i)throw`Unexpected sector line length ${o.length} -> ${i}, expected 32 -> 16`;for(let e=0;e<i;e++){if(s<n){const t=parseInt(o.slice(2*e,2*e+2),16);a.setUint8(s,t)}else console.log("WARNING: Ignoring sector contents beyond end of read extent: "+s);s++}}if(512!=s)throw console.dir(i.lines),`Unexpected sector data of size ${s}, expected size 512, from ${i.lines.length} lines`;return a}fileTell(e,t){return t.sectorWithinFile*e.sectorSize+t.offsetWithinSector}fileReset(e,t){t.currentCluster=t.dataFirstCluster,t.currentSectorWithinFile=0,t.offsetWithinSector=0,t.currentSectorBuffer=null}async fileSeek(e,t,r){const n=Math.floor(r/e.sectorSize);if(n==t.currentSectorWithinFile)return!0;t.currentSectorBuffer=null;let o=Math.floor(t.currentSectorWithinFile/e.sectorsPerCluster);const i=Math.floor(n/e.sectorsPerCluster);for(i<o&&(o=0,t.currentCluster=t.dataFirstCluster);o!=i;){let r=null;const n=8*e.sectorSize/e.type,i=Math.floor(t.currentCluster/n);if(e.allocationTable||(e.allocationTable=[]),!e.allocationTable[i]){const t=e.firstFatSector+i;console.log("READ-FILE: Cache miss, reading FAT page "+i+" at sector "+t);const r=await this.readSector(t);e.allocationTable[i]=r}const a=t.currentCluster%n;if(12==e.type)throw"FAT12 not supported";if(16==e.type)r=e.allocationTable[i].getUint16(2*a,!0);else{if(32!=e.type)throw"Filesystem type not supported: "+e.type;r=e.allocationTable[i].getUint32(4*a,!0)}console.log("READ-FILE: seeking after current cluster, following chain: #"+o+" "+t.currentCluster+" -> "+r),t.currentCluster=r,o++}return t.currentSectorWithinFile=n,t.offsetWithinSector=r%e.sectorSize,!0}async fileRead(e,t,r,n,o){if(r<=0)return 0;if(t.offsetWithinSector>=e.sectorSize){const r=(t.currentSectorWithinFile+1)*e.sectorSize;await this.fileSeek(e,t,r)}if(null==t.currentSectorBuffer){const r=e.firstSectorOfFileArea+(t.currentCluster-2)*e.sectorsPerCluster+t.currentSectorWithinFile%e.sectorsPerCluster;t.currentSectorBuffer=new ArrayBuffer(e.sectorSize),await this.readSector(r,t.currentSectorBuffer,0,e.sectorSize)}r>e.sectorSize-t.offsetWithinSector&&(r=e.sectorSize-t.offsetWithinSector);const i=new DataView(t.currentSectorBuffer,t.offsetWithinSector,r),a=new DataView(n,o,r);for(let e=0;e<r;e++){const t=i.getUint8(e);a.setUint8(e,t)}return t.offsetWithinSector+=r,r}async findFileEntry(e,t){e.rootSector||(e.rootSector=await this.readSector(e.rootSectorNumber));let r=null;if(null!=t){const e=t.split("."),n=(e.length<=1?"":e.pop()).trim().toUpperCase().slice(0,3).padEnd(3," ");r=e.join("").trim().toUpperCase().replace(/ /g,"").slice(0,8).padEnd(8," ")+n}const n={};null!=t&&(n.filename=t,n.entry=r,n.dataLength=null,n.dataFirstCluster=null),n.foundEntry=null,n.exists=!1;for(let o=0;o<16;o++){const i=32*o,a=e.rootSector.getUint8(i+11);let s=!0;if(null!=r){for(let t=0;t<r.length;t++)if(e.rootSector.getUint8(i+t)!=r.charCodeAt(t)){s=!1;break}}else 8&a&&(s=!0);if(s){n.exists=!0,n.foundEntry="";for(let t=0;t<11;t++)n.foundEntry+=String.fromCharCode(e.rootSector.getUint8(i+t));n.attributes=a,null!=t&&(n.dataFirstCluster=e.rootSector.getUint16(i+26,!0),n.dataLength=e.rootSector.getUint32(i+28,!0));const r=e.rootSector.getUint16(i+22,!0),o=e.rootSector.getUint16(i+24,!0),s=o>>5&15,c=31&o,u=r>>11&31,l=r>>5&63,d=2*(31&r),f=(1980+(o>>9&127)).toString().padStart(4,"0")+"-"+s.toString().padStart(2,"0")+"-"+c.toString().padStart(2,"0")+"T"+u.toString().padStart(2,"0")+":"+l.toString().padStart(2,"0")+":"+d.toString().padStart(2,"0")+"Z";n.timestamp=f;break}}return null!=t&&this.fileReset(e,n),n}async readFile(e,t,r,n){if(!t.exists)return null;if(!await this.fileSeek(e,t,r))throw"Cannot seek to offset: "+r;null===n&&(n=t.dataLength-r),n>t.dataLength-r&&(n=t.dataLength-r),console.log("READ-FILE: @"+r+"+"+n);const o=new ArrayBuffer(n);let i=0;for(;;){const r=await this.fileRead(e,t,n-i,o,i);if(r<=0)break;i+=r}return i<n&&console.log("READ-FILE WARNING: Short read: "+i+" / "+n),o}async readFilesystem(e){this.updateState("Reading filesystem - please wait...");const t={};if(t.mbrSector=await this.readSector(0),85!=t.mbrSector.getUint8(510)||170!=t.mbrSector.getUint8(511))throw"Invalid MBR signature";if(t.firstSectorNumber=t.mbrSector.getUint32(454,!0),t.sectorCount=t.mbrSector.getUint32(458,!0),t.bootSector=await this.readSector(t.firstSectorNumber),t.sectorSize=t.bootSector.getUint16(11,!0),512!=t.sectorSize)throw"Invalid sectorSize: "+t.sectorSize;if(t.sectorsPerCluster=t.bootSector.getUint8(13),t.sectorsPerCluster&t.sectorsPerCluster-1!=0)throw"Invalid sectorsPerCluster: "+t.sectorsPerCluster;if(t.clusterSize=t.sectorsPerCluster*t.sectorSize,t.clusterSize&t.clusterSize-1!=0)throw"Invalid clusterSize: "+t.clusterSize;if(t.numReservedSectors=t.bootSector.getUint16(14,!0),t.numFATs=t.bootSector.getUint8(16),t.numFATs<1||t.numFATs>2)throw"Invalid numFATs: "+t.numFATs;if(t.firstFatSector=t.firstSectorNumber+t.numReservedSectors,t.numRootDirectoryEntries=t.bootSector.getUint16(17,!0),0==t.numRootDirectoryEntries)throw"Invalid numRootDirectoryEntries: "+t.numRootDirectoryEntries;return t.sectorsPerFAT=t.bootSector.getUint16(22,!0),t.rootSectorNumber=t.firstSectorNumber+t.numReservedSectors+t.numFATs*t.sectorsPerFAT,t.firstSectorOfFileArea=t.rootSectorNumber+Math.floor(32*t.numRootDirectoryEntries/512),t.sectorCapacity=t.sectorCount-t.firstSectorNumber,t.clusterCapacity=Math.ceil(t.sectorCapacity/t.sectorsPerCluster),t.clusterCapacity<4085?t.type=12:t.clusterCapacity<65525?t.type=16:t.type=32,32==t.type&&(t.rootSectorNumber=t.firstSectorOfFileArea),console.log("Filesystem: "+t.type+"-bit, "+t.sectorCapacity+" sectors, "+t.clusterCapacity+" clusters, "+t.sectorsPerCluster+" sectors per cluster, "+t.clusterSize+" bytes per cluster, "+t.numRootDirectoryEntries+" root directory entries, "+t.firstSectorOfFileArea+" first sector of file area, "+t.rootSectorNumber+" first sector of root directory"),t.volumeEntry=await this.findFileEntry(t,null),t.fileEntry=await this.findFileEntry(t,"CWA-DATA.CWA"),t.fileEntry.dataContents=await this.readFile(t,t.fileEntry,0,1536),t.fileEntry.readLength=t.fileEntry.dataContents.byteLength,e&&t.fileEntry.dataLength>=1536&&(t.fileEntry.lastDataContents=await this.readFile(t,t.fileEntry,t.fileEntry.dataLength-512,512)),t}async setMetadata(e){for(let t=0;t<14;t++){this.updateState(`Configuring: Setting metadata (${t+1} / 14)`);let r="";const n=32*t;let o=32*(t+1);n<e.length&&(o>e.length&&(o=e.length),r=e.substring(n,o));const i="Annotate"+(t<10?"0":"")+t+"="+r+"\r\n",a="ANNOTATE"+(t<10?"0":"")+t+"=";await this.tryAndRetry(async()=>{const e=new u(`\r\n${i}\r\n`,a,1e3);console.log(">>> "+e.output+"|");const t=(await this.exec(e)).lastLine();console.log("<<< "+t);const n=t.substring(t.indexOf("=")+1);if(n.trim()!=r.trim())throw`${a} unexpected value, received "${n.trim()}", expected "${r.trim()}"`})}}async commit(e){let t;if(!0===e)this.updateState("Configuring: Wiping and committing"),t=new u("\r\nFORMAT WC\r\n","COMMIT",15e3);else if(!1===e)this.updateState("Configuring: Erasing and committing"),t=new u("\r\nFORMAT QC\r\n","COMMIT",12e3);else{if(null!==e)throw"ERROR: Unknown commit type.";this.updateState("Configuring: Committing"),t=new u("\r\nCommit\r\n","COMMIT",8e3)}console.log(">>> "+t.output);const r=(await this.exec(t)).lastLine();console.log("<<< "+r)}async tryAndRetry(e,t=3,r=1e3){let o="Unexpected failure in retry logic.";for(let i=0;i<t;i++)try{return r&&i>0&&(console.log(`Retrying in ${r/1e3}s...`),await(0,n.sleep)(r)),await e()}catch(e){o=e,console.log(`WARNING: Failed attempt (${i+1}/${t}): `+(e.error?e.error:e))}throw o}async updateStatus(){if(this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{if(this.updateState("Querying status"),await this.tryAndRetry(()=>this.open()),null===this.status.id||null===this.status.id.deviceId){if(this.status.id=await this.tryAndRetry(()=>this.getId()),this.status.id.deviceId!=this.serial){if(null!==this.serial||"serial"!==this.device.type)throw`ERROR: Device id mismatch: reported ID=${this.status.id.deviceId} but serial number was ${this.serial}.`;console.log(`WARNING: Serial API did not return serial number, so not verifying reported: ID=${this.status.id.deviceId}`)}console.log("ID="+JSON.stringify(this.status.id))}const e=new Date;return(null===this.status.battery||null===this.status.battery.percent||null===this.status.battery.time||e.getTime()-this.status.battery.time.getTime()>=3e4)&&(this.status.battery=await this.tryAndRetry(()=>this.getBattery()),console.log("BATTERY="+JSON.stringify(this.status.battery))),null===this.status.start&&(this.status.start=await this.tryAndRetry(()=>this.getHibernate())),null===this.status.stop&&(this.status.stop=await this.tryAndRetry(()=>this.getStop())),this.recalculateRecordingStatus(),this.status}catch(e){throw e.error?(this.updateState(null,`Error getting status: ${e.error}`),console.log("ERROR: Problem during status update: "+e.error)):(this.updateState(null,`Error getting status: ${e}`),console.log("ERROR: Problem during status update: "+e)),e}finally{await this.close()}}recalculateRecordingStatus(e=!1){const t=Date.UTC(-271821,3,20),r=Date.UTC(275760,8,13),n=new Date;let o=this.status.start;-1===o&&(o=r),0===o&&(o=t);let i=this.status.stop;-1===i&&(o=r),0===i&&(o=t),this.status.recordingConfigured=o<i,this.status.recordingFinished=this.status.recordingConfigured&&n>=i,this.status.recordingStarted=this.status.recordingConfigured&&n>=o&&!this.status.recordingFinished,this.status.recordingIncomplete=this.status.recordingConfigured&&!this.status.recordingFinished;let a=e?"Configured: ":"";this.status.recordingConfigured?this.status.recordingFinished?a+="Recording complete":this.status.recordingStarted?a+="Recording started":a+="Configured":a=e?"Settings cleared":"Ready",this.updateState(a)}async configure(e){if(this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{this.updateState("Configuring..."),await this.tryAndRetry(()=>this.open());const t={resetDeviceId:null,minbattery:null,configLed:d.LED_BLUE,time:null,session:0,maxSamples:0,rate:100,range:8,gyro:0,start:-1,stop:0,metadata:"",led:d.LED_MAGENTA,wipe:!0,noData:!1,debug:!1};for(let r of Object.keys(e))if(!(r in t))throw`ERROR: Unknown configuration value: ${r}`;const r=Object.assign(t,e);if(console.log("ID="+JSON.stringify(this.status.id)),this.status.id.deviceId!=this.serial){if(null!==this.serial||"serial"!==this.device.type)throw`ERROR: Device id mismatch (was status updated first?): reported ID=${this.status.id.deviceId} but USB serial number was ${this.serial}.`;console.log(`WARNING: Serial API did not return serial number, so not verifying reported: ID=${this.status.id.deviceId}`)}if(await this.tryAndRetry(()=>this.setLed(r.configLed)),console.log("BATTERY="+JSON.stringify(this.status.battery)),this.status.battery.percent<r.minbattery)throw`ERROR: Device battery level too low: ${this.status.battery.percent}% (required ${r.minbattery}%).`;if(r.noData){const e=await this.tryAndRetry(()=>this.readFilesystem(!1));if(console.log("FILESYSTEM="+JSON.stringify(e)),e.fileEntry&&e.fileEntry.dataLength&&e.fileEntry.dataLength>1024)throw"ERROR: Device has data on it."}return r.time||(r.time=new Date),r.resetDeviceId&&this.setId(r.resetDeviceId),await this.tryAndRetry(()=>this.setTime(r.time)),await this.tryAndRetry(()=>this.setRate(r.rate,r.range,r.gyro,!0)),await this.tryAndRetry(()=>this.setSession(r.session)),await this.tryAndRetry(()=>this.setMaxSamples(r.maxSamples)),await this.tryAndRetry(()=>this.setDebug(r.debug?3:0)),await this.tryAndRetry(()=>this.setHibernate(r.start)),await this.tryAndRetry(()=>this.setStop(r.stop)),await this.tryAndRetry(()=>this.setMetadata(r.metadata)),await this.tryAndRetry(()=>this.commit(r.wipe)),this.status.start=r.start,this.status.stop=r.stop,this.recalculateRecordingStatus(!0),await this.tryAndRetry(()=>this.setLed(r.led)),{time:r.time,timeDevice:(0,n.localTimeString)(r.time,"S"),deviceId:this.status.id.deviceId,battery:battery.percent,start:r.start,startDevice:(0,n.localTimeString)(r.start,"S"),stop:r.stop,stopDevice:(0,n.localTimeString)(r.stop,"S"),session:r.session,rate:r.rate,range:r.range,gyro:r.gyro,metadata:r.metadata}}catch(e){throw e.error?(this.updateState(null,`Error: ${e.error}`),console.log("ERROR: Problem during configuration: "+e.error)):(this.updateState(null,`Error: ${e}`),console.log("ERROR: Problem during configuration: "+e)),e}finally{await this.close()}}async runDownload(e){const t=Date.now();let r=null;if(console.log("DOWNLOAD: Start..."),this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{if(await this.tryAndRetry(()=>this.open()),this.diagnostic||(this.diagnostic={}),this.diagnostic.filesystem||(this.diagnostic.filesystem=await this.readFilesystem(!1)),!this.diagnostic.filesystem.fileEntry)throw"Cannot find file.";const n=this.diagnostic.filesystem.fileEntry.dataLength;let o=this.diagnostic.filesystem.fileEntry.filename;o=o.replace(".CWA","-"+this.status.id.deviceId+".cwa");const i=await c(o,n,async o=>{if(!o)throw new Error("Writer is aborted - callback 1");o.written||(o.written=0);const i=await this.readFile(this.diagnostic.filesystem,this.diagnostic.filesystem.fileEntry,o.written,8192);if(!o)throw new Error("Writer is aborted - callback 2");console.log("DOWNLOAD: READ: "+i.byteLength);const a=new Uint8Array(i);if(await o.write(a),!o)throw new Error("Writer is aborted - callback 3");o.written+=a.byteLength;const s=o.written<o.fileSize,c=Date.now();if(null===r||c-r>=1e3||!s){const i=(c-t)/1e3,a=o.written,u=i>2?a/i:0,l={elapsed:i,written:a,total:n,proportion:n>0?a/n:1,complete:s,bytesPerSecond:u,estimatedRemaining:u>0?(n-a)/u:null};e&&e(l),r=c}return s});console.log("DOWNLOAD: result="+i)}catch(e){throw e.error?(this.updateState(null,`Error running diagnostic: ${e.error}`),console.log("ERROR: Problem during diagnostic: "+e.error)):(this.updateState(null,`Error running diagnostic: ${e}`),console.log("ERROR: Problem during diagnostic: "+e)),e}finally{await this.close()}}async runReset(e){let t={time:new Date,session:0,rate:100,range:8,gyro:0,start:-1,stop:0,metadata:"",maxSamples:0,debug:0,wipe:!0,minbattery:0,noData:!1};e&&(t.resetDeviceId=e),this.configure(t)}async runDiagnostic(){if(this.device.isBusy())throw this.updateState(null,"Device busy"),"ERROR: Device is busy";try{this.updateState("Running diagnostic..."),await this.tryAndRetry(()=>this.open()),this.diagnostic={},this.diagnostic.errors=[],this.diagnostic.time=new Date,this.diagnostic.id=this.status.id,this.diagnostic.battery=this.status.battery,this.diagnostic.start=this.status.start,this.diagnostic.stop=this.status.stop;try{this.diagnostic.rate=await this.getRate(),this.diagnostic.deviceTime=await this.getTime(),this.diagnostic.sessionId=await this.getSession(),this.diagnostic.maxSamples=await this.getMaxSamples(),this.diagnostic.status=await this.getStatus(),this.diagnostic.log=await this.getLog()}catch(e){this.diagnostic.errors.push("Problem while getting additional information: "+JSON.stringify(e))}try{const e=!0;this.diagnostic.filesystem=await this.readFilesystem(e)}catch(e){this.diagnostic.errors.push("Problem while getting filesystem information: "+JSON.stringify(e))}if(this.diagnostic.sectorDump={},this.diagnostic.filesystem&&(this.diagnostic.filesystem.mbrSector&&(this.diagnostic.sectorDump.mbrSector=a(this.diagnostic.filesystem.mbrSector)),this.diagnostic.filesystem.bootSector&&(this.diagnostic.sectorDump.bootSector=a(this.diagnostic.filesystem.bootSector)),this.diagnostic.filesystem.rootSector&&(this.diagnostic.sectorDump.rootSector=a(this.diagnostic.filesystem.rootSector)),this.diagnostic.filesystem.allocationTable&&this.diagnostic.filesystem.allocationTable[0]&&(this.diagnostic.sectorDump.allocationTable0=a(this.diagnostic.filesystem.allocationTable[0]))),this.diagnostic.filesystem&&this.diagnostic.filesystem.fileEntry&&this.diagnostic.filesystem.fileEntry.dataLength>0&&this.diagnostic.filesystem.fileEntry.dataContents){let e=null,t=null;try{this.diagnostic.file={filename:this.diagnostic.filesystem.fileEntry.filename,length:this.diagnostic.filesystem.fileEntry.dataLength,source:"serial"},e=this.diagnostic.filesystem.fileEntry.dataContents,t=this.diagnostic.filesystem.fileEntry.lastDataContents,this.diagnostic.sectorDump.dataContents=a(this.diagnostic.filesystem.fileEntry.dataContents),t&&(this.diagnostic.sectorDump.lastDataContents=a(this.diagnostic.filesystem.fileEntry.lastDataContents))}catch(e){this.diagnostic.errors.push("Problem while reading data file: "+JSON.stringify(e))}if(e&&this.diagnostic.filesystem.fileEntry.dataLength>=512)try{this.diagnostic.header=(0,o.parseHeader)(new DataView(e,0,512))}catch(e){this.diagnostic.errors.push("Problem while parsing file header: "+JSON.stringify(e))}if(e&&this.diagnostic.filesystem.fileEntry.dataLength>=1536)try{this.diagnostic.first=(0,o.parseData)(new DataView(e,1024,512))}catch(e){this.diagnostic.errors.push("Problem while parsing file data (first): "+JSON.stringify(e))}if(t&&this.diagnostic.filesystem.fileEntry.dataLength>=512)try{this.diagnostic.last=(0,o.parseData)(new DataView(t,0,512))}catch(e){this.diagnostic.errors.push("Problem while parsing file data (last): "+JSON.stringify(e))}}return this.recalculateRecordingStatus(),this.diagnostic.filesystem&&this.diagnostic.filesystem.allocationTable&&delete this.diagnostic.filesystem.allocationTable,this.diagnostic}catch(e){throw e.error?(this.updateState(null,`Error running diagnostic: ${e.error}`),console.log("ERROR: Problem during diagnostic: "+e.error)):(this.updateState(null,`Error running diagnostic: ${e}`),console.log("ERROR: Problem during diagnostic: "+e)),e}finally{await this.close()}}}r.default=d,d.USB_DEVICE_VID=1240,d.USB_DEVICE_PID=87,d.LED_OFF=0,d.LED_BLUE=1,d.LED_GREEN=2,d.LED_CYAN=3,d.LED_RED=4,d.LED_MAGENTA=5,d.LED_YELLOW=6,d.LED_WHITE=7},{"./util.mjs":"x7XL","./cwa_parse.mjs":"bBqM","./streamsaver.mjs":"xAlh"}],bqdr:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=a(e("./usb_device.mjs")),o=a(e("./serial_device.mjs")),i=a(e("./ax3device.mjs"));function a(e){return e&&e.__esModule?e:{default:e}}r.default=class{constructor(e,t){this.enableSerial=t,this.lastAdd=null,this.usbDevices={},this.serialDevices={},this.warnings=[],"file:"===location.protocol&&this.warnings.push("WARNING: Features may not work over the file: protocol (try via an HTTP web server)."),"https:"!==location.protocol&&"localhost"!==location.hostname&&"127.0.0.1"!==location.hostname&&"::1"!==location.hostname&&this.warnings.push("WARNING: Features may require secure HTTPS on non-loopback connections."),navigator.usb||navigator.serial||this.warnings.push("WARNING: This browser configuration does not support device connection (WebUSB or Web Serial API)."),!(e&&navigator.usb&&navigator.appVersion.indexOf("(Windows")>=0)||t&&navigator.serial||this.warnings.push("WARNING: WebUSB will not work on Windows as standard (CDC devices claimed by the driver). "+(t?" You can try enabling the experimental Web Serial API at: chrome://flags#enable-experimental-web-platform-features and/or see Help for experimental firmware with WinUSB and Generic interface support.":""));for(let e of this.warnings)console.log(e)}async startup(e){return this.changedHandler=e,navigator.usb&&(navigator.usb.addEventListener("disconnect",e=>{const t=e.device;console.log("DEVICEMANAGER: USB Disconnect "+t);const r=this.usbDevices[t];delete this.usbDevices[t],this.changedHandler&&this.changedHandler(r,t,"disconnect")}),navigator.usb.addEventListener("connect",e=>{const t=e.device;console.log("DEVICEMANAGER: USB Connect "+t);const r=new i.default(new n.default(t));this.usbDevices[t]=r,this.changedHandler&&this.changedHandler(r,t,"connect")})),await this.refreshDevices(),!0}async refreshDevices(){if(navigator.serial){const e={};if(navigator.serial.getPorts){let t=[];try{t=await navigator.serial.getPorts()}catch(e){this.firstSerialEnumerateError||(this.firstSerialEnumerateError=!0,console.log("ERROR: Problem enumerating serial devices: "+e+" -- "+JSON.stringify(e)))}for(let r of t)if(e[r]=r,!(r in this.serialDevices)){console.log("DEVICEMANAGER: Serial Enumerate "+r);const e=new i.default(new o.default(r));this.serialDevices[r]=e,this.changedHandler&&this.changedHandler(e,r,"get")}}for(let t of Object.keys(this.serialDevices))if(!(t in e)){console.log("DEVICEMANAGER: Serial Enumerate device lost "+t);const e=this.serialDevices[t];this.changedHandler&&this.changedHandler(e,t,"disconnect"),delete this.serialDevices[t]}}}async userAddUsbDevice(){if(this.lastAdd="usb",!navigator.usb)throw"ERROR: WebUSB is not supported in this browser configuration.";try{const e=await navigator.usb.requestDevice({filters:[{vendorId:i.default.USB_DEVICE_VID,productId:i.default.USB_DEVICE_PID}]});if(console.log("DEVICEMANAGER: Request USB "+e),!(e in this.usbDevices)){const t=new i.default(new n.default(e));this.usbDevices[e]=t}return this.changedHandler&&this.changedHandler(this.usbDevices[e],e,"request"),!0}catch(e){throw"NotFoundError"==e.name?(console.log("NOTE: User did not select a device: "+e.name+" -- "+e.message),"No device chosen."):(console.log("ERROR: "+e+" -- "+e.name+" -- "+e.message),"ERROR: "+e+" -- "+e.name+" -- "+e.message)}}async userAddSerialDevice(){if(this.lastAdd="serial",!("serial"in navigator))throw"ERROR: Web Serial API is not supported in this browser configuration.";try{const e={filters:[{usbVendorId:i.default.USB_DEVICE_VID,usbProductId:i.default.USB_DEVICE_PID,vendorId:i.default.USB_DEVICE_VID,productId:i.default.USB_DEVICE_PID}]},t=await navigator.serial.requestPort(e);if(console.log("DEVICEMANAGER: Request serial "+t),!(t in this.serialDevices)){if(this.serialDevices.length>0){console.log("WARNING: Only one serial device is supported at a time, but about to add another -- removing old.");const e=Object.keys(this.serialDevices)[0],t=this.serialDevices[e];this.changedHandler&&this.changedHandler(t,e,"disconnect"),delete this.serialDevices[e]}const e=new i.default(new o.default(t));this.serialDevices[t]=e}return this.changedHandler&&this.changedHandler(this.serialDevices[t],t,"request"),!0}catch(e){throw"NotFoundError"==e.name?(console.log("NOTE: User did not select a device: "+e.name+" -- "+e.message),"No device chosen."):(console.log("ERROR: "+e+" -- "+e.name+" -- "+e.message),"ERROR: "+e+" -- "+e.name+" -- "+e.message)}}getSingleDevice(){const e=Object.keys(this.usbDevices).length,t=Object.keys(this.serialDevices).length;return 0==e&&0==t?(console.log("ERROR: DeviceManager has no devices -- this will only work for a single device."),null):e+t!==1?(console.log("WARNING: DeviceManager has "+e+" USB device(s) and "+t+" serial device(s)."),console.log("USB: "+JSON.stringify(this.usbDevices)),console.log("SERIAL: "+JSON.stringify(this.serialDevices)),"usb"==this.lastAdd&&e>0?(console.log("NOTE: Choosing USB..."),e>1?(console.log("ERROR: Multiple USB, but this will only work with a single device."),null):Object.values(this.usbDevices)[0]):t>1?(console.log("ERROR: Multiple Serial, but this will only work with a single device."),null):1==t?Object.values(this.serialDevices)[0]:(console.log("ERROR: DeviceManager had an unexpected issue trying to resolve a single device."),null)):t>0?Object.values(this.serialDevices)[0]:e>0?Object.values(this.usbDevices)[0]:(console.log("ERROR: DeviceManager had an unexpected issue trying to resolve a single device."),null)}}},{"./usb_device.mjs":"anNG","./serial_device.mjs":"Lo8Z","./ax3device.mjs":"sLgq"}],yh9p:[function(e,t,r){"use strict";r.byteLength=function(e){var t=u(e),r=t[0],n=t[1];return 3*(r+n)/4-n},r.toByteArray=function(e){var t,r,n=u(e),a=n[0],s=n[1],c=new i(function(e,t,r){return 3*(t+r)/4-r}(0,a,s)),l=0,d=s>0?a-4:a;for(r=0;r<d;r+=4)t=o[e.charCodeAt(r)]<<18|o[e.charCodeAt(r+1)]<<12|o[e.charCodeAt(r+2)]<<6|o[e.charCodeAt(r+3)],c[l++]=t>>16&255,c[l++]=t>>8&255,c[l++]=255&t;return 2===s&&(t=o[e.charCodeAt(r)]<<2|o[e.charCodeAt(r+1)]>>4,c[l++]=255&t),1===s&&(t=o[e.charCodeAt(r)]<<10|o[e.charCodeAt(r+1)]<<4|o[e.charCodeAt(r+2)]>>2,c[l++]=t>>8&255,c[l++]=255&t),c},r.fromByteArray=function(e){for(var t,r=e.length,o=r%3,i=[],a=0,s=r-o;a<s;a+=16383)i.push(d(e,a,a+16383>s?s:a+16383));return 1===o?(t=e[r-1],i.push(n[t>>2]+n[t<<4&63]+"==")):2===o&&(t=(e[r-2]<<8)+e[r-1],i.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"=")),i.join("")};for(var n=[],o=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,c=a.length;s<c;++s)n[s]=a[s],o[a.charCodeAt(s)]=s;function u(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");return-1===r&&(r=t),[r,r===t?0:4-r%4]}function l(e){return n[e>>18&63]+n[e>>12&63]+n[e>>6&63]+n[63&e]}function d(e,t,r){for(var n,o=[],i=t;i<r;i+=3)n=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(255&e[i+2]),o.push(l(n));return o.join("")}o["-".charCodeAt(0)]=62,o["_".charCodeAt(0)]=63},{}],JgNJ:[function(e,t,r){r.read=function(e,t,r,n,o){var i,a,s=8*o-n-1,c=(1<<s)-1,u=c>>1,l=-7,d=r?o-1:0,f=r?-1:1,h=e[t+d];for(d+=f,i=h&(1<<-l)-1,h>>=-l,l+=s;l>0;i=256*i+e[t+d],d+=f,l-=8);for(a=i&(1<<-l)-1,i>>=-l,l+=n;l>0;a=256*a+e[t+d],d+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return a?NaN:1/0*(h?-1:1);a+=Math.pow(2,n),i-=u}return(h?-1:1)*a*Math.pow(2,i-n)},r.write=function(e,t,r,n,o,i){var a,s,c,u=8*i-o-1,l=(1<<u)-1,d=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,h=n?0:i-1,p=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-a))<1&&(a--,c*=2),(t+=a+d>=1?f/c:f*Math.pow(2,1-d))*c>=2&&(a++,c/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*c-1)*Math.pow(2,o),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,o),a=0));o>=8;e[r+h]=255&s,h+=p,s/=256,o-=8);for(a=a<<o|s,u+=o;u>0;e[r+h]=255&a,h+=p,a/=256,u-=8);e[r+h-p]|=128*g}},{}],REa7:[function(e,t,r){var n={}.toString;t.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},{}],dskh:[function(e,t,r){arguments[3];var n=arguments[3],o=e("base64-js"),i=e("ieee754"),a=e("isarray");function s(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}function c(){return l.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function u(e,t){if(c()<t)throw new RangeError("Invalid typed array length");return l.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=l.prototype:(null===e&&(e=new l(t)),e.length=t),e}function l(e,t,r){if(!(l.TYPED_ARRAY_SUPPORT||this instanceof l))return new l(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return p(this,e)}return d(this,e,t,r)}function d(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?y(e,t,r,n):"string"==typeof t?g(e,t,r):v(e,t)}function f(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function h(e,t,r,n){return f(t),t<=0?u(e,t):void 0!==r?"string"==typeof n?u(e,t).fill(r,n):u(e,t).fill(r):u(e,t)}function p(e,t){if(f(t),e=u(e,t<0?0:0|b(t)),!l.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function g(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!l.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|_(t,r),o=(e=u(e,n)).write(t,r);return o!==n&&(e=e.slice(0,o)),e}function m(e,t){var r=t.length<0?0:0|b(t.length);e=u(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function y(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),l.TYPED_ARRAY_SUPPORT?(e=t).__proto__=l.prototype:e=m(e,t),e}function v(e,t){if(l.isBuffer(t)){var r=0|b(t.length);return 0===(e=u(e,r)).length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||re(t.length)?u(e,0):m(e,t);if("Buffer"===t.type&&a(t.data))return m(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function b(e){if(e>=c())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c().toString(16)+" bytes");return 0|e}function w(e){return+e!=e&&(e=0),l.alloc(+e)}function _(e,t){if(l.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return Q(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return ee(e).length;default:if(n)return Q(e).length;t=(""+t).toLowerCase(),n=!0}}function S(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if((r>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,r);case"utf8":case"utf-8":return k(this,t,r);case"ascii":return q(this,t,r);case"latin1":case"binary":return j(this,t,r);case"base64":return I(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function R(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function x(e,t,r,n,o){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=o?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(o)return-1;r=e.length-1}else if(r<0){if(!o)return-1;r=0}if("string"==typeof t&&(t=l.from(t,n)),l.isBuffer(t))return 0===t.length?-1:E(e,t,r,n,o);if("number"==typeof t)return t&=255,l.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):E(e,[t],r,n,o);throw new TypeError("val must be string, number or Buffer")}function E(e,t,r,n,o){var i,a=1,s=e.length,c=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;a=2,s/=2,c/=2,r/=2}function u(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(o){var l=-1;for(i=r;i<s;i++)if(u(e,i)===u(t,-1===l?0:i-l)){if(-1===l&&(l=i),i-l+1===c)return l*a}else-1!==l&&(i-=i-l),l=-1}else for(r+c>s&&(r=s-c),i=r;i>=0;i--){for(var d=!0,f=0;f<c;f++)if(u(e,i+f)!==u(t,f)){d=!1;break}if(d)return i}return-1}function C(e,t,r,n){r=Number(r)||0;var o=e.length-r;n?(n=Number(n))>o&&(n=o):n=o;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");n>i/2&&(n=i/2);for(var a=0;a<n;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[r+a]=s}return a}function O(e,t,r,n){return te(Q(t,e.length-r),e,r,n)}function T(e,t,r,n){return te(Z(t),e,r,n)}function A(e,t,r,n){return T(e,t,r,n)}function P(e,t,r,n){return te(ee(t),e,r,n)}function D(e,t,r,n){return te(K(t,e.length-r),e,r,n)}function I(e,t,r){return 0===t&&r===e.length?o.fromByteArray(e):o.fromByteArray(e.slice(t,r))}function k(e,t,r){r=Math.min(e.length,r);for(var n=[],o=t;o<r;){var i,a,s,c,u=e[o],l=null,d=u>239?4:u>223?3:u>191?2:1;if(o+d<=r)switch(d){case 1:u<128&&(l=u);break;case 2:128==(192&(i=e[o+1]))&&(c=(31&u)<<6|63&i)>127&&(l=c);break;case 3:i=e[o+1],a=e[o+2],128==(192&i)&&128==(192&a)&&(c=(15&u)<<12|(63&i)<<6|63&a)>2047&&(c<55296||c>57343)&&(l=c);break;case 4:i=e[o+1],a=e[o+2],s=e[o+3],128==(192&i)&&128==(192&a)&&128==(192&s)&&(c=(15&u)<<18|(63&i)<<12|(63&a)<<6|63&s)>65535&&c<1114112&&(l=c)}null===l?(l=65533,d=1):l>65535&&(l-=65536,n.push(l>>>10&1023|55296),l=56320|1023&l),n.push(l),o+=d}return L(n)}r.Buffer=l,r.SlowBuffer=w,r.INSPECT_MAX_BYTES=50,l.TYPED_ARRAY_SUPPORT=void 0!==n.TYPED_ARRAY_SUPPORT?n.TYPED_ARRAY_SUPPORT:s(),r.kMaxLength=c(),l.poolSize=8192,l._augment=function(e){return e.__proto__=l.prototype,e},l.from=function(e,t,r){return d(null,e,t,r)},l.TYPED_ARRAY_SUPPORT&&(l.prototype.__proto__=Uint8Array.prototype,l.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&l[Symbol.species]===l&&Object.defineProperty(l,Symbol.species,{value:null,configurable:!0})),l.alloc=function(e,t,r){return h(null,e,t,r)},l.allocUnsafe=function(e){return p(null,e)},l.allocUnsafeSlow=function(e){return p(null,e)},l.isBuffer=function(e){return!(null==e||!e._isBuffer)},l.compare=function(e,t){if(!l.isBuffer(e)||!l.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,o=0,i=Math.min(r,n);o<i;++o)if(e[o]!==t[o]){r=e[o],n=t[o];break}return r<n?-1:n<r?1:0},l.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(e,t){if(!a(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return l.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=l.allocUnsafe(t),o=0;for(r=0;r<e.length;++r){var i=e[r];if(!l.isBuffer(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(n,o),o+=i.length}return n},l.byteLength=_,l.prototype._isBuffer=!0,l.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)R(this,t,t+1);return this},l.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)R(this,t,t+3),R(this,t+1,t+2);return this},l.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)R(this,t,t+7),R(this,t+1,t+6),R(this,t+2,t+5),R(this,t+3,t+4);return this},l.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?k(this,0,e):S.apply(this,arguments)},l.prototype.equals=function(e){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===l.compare(this,e)},l.prototype.inspect=function(){var e="",t=r.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,t).match(/.{2}/g).join(" "),this.length>t&&(e+=" ... ")),"<Buffer "+e+">"},l.prototype.compare=function(e,t,r,n,o){if(!l.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===o&&(o=this.length),t<0||r>e.length||n<0||o>this.length)throw new RangeError("out of range index");if(n>=o&&t>=r)return 0;if(n>=o)return-1;if(t>=r)return 1;if(this===e)return 0;for(var i=(o>>>=0)-(n>>>=0),a=(r>>>=0)-(t>>>=0),s=Math.min(i,a),c=this.slice(n,o),u=e.slice(t,r),d=0;d<s;++d)if(c[d]!==u[d]){i=c[d],a=u[d];break}return i<a?-1:a<i?1:0},l.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},l.prototype.indexOf=function(e,t,r){return x(this,e,t,r,!0)},l.prototype.lastIndexOf=function(e,t,r){return x(this,e,t,r,!1)},l.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var o=this.length-t;if((void 0===r||r>o)&&(r=o),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var i=!1;;)switch(n){case"hex":return C(this,e,t,r);case"utf8":case"utf-8":return O(this,e,t,r);case"ascii":return T(this,e,t,r);case"latin1":case"binary":return A(this,e,t,r);case"base64":return P(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return D(this,e,t,r);default:if(i)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),i=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var M=4096;function L(e){var t=e.length;if(t<=M)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=M));return r}function q(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(127&e[o]);return n}function j(e,t,r){var n="";r=Math.min(e.length,r);for(var o=t;o<r;++o)n+=String.fromCharCode(e[o]);return n}function N(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var o="",i=t;i<r;++i)o+=J(e[i]);return o}function W(e,t,r){for(var n=e.slice(t,r),o="",i=0;i<n.length;i+=2)o+=String.fromCharCode(n[i]+256*n[i+1]);return o}function U(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function B(e,t,r,n,o,i){if(!l.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>o||t<i)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function z(e,t,r,n){t<0&&(t=65535+t+1);for(var o=0,i=Math.min(e.length-r,2);o<i;++o)e[r+o]=(t&255<<8*(n?o:1-o))>>>8*(n?o:1-o)}function F(e,t,r,n){t<0&&(t=4294967295+t+1);for(var o=0,i=Math.min(e.length-r,4);o<i;++o)e[r+o]=t>>>8*(n?o:3-o)&255}function $(e,t,r,n,o,i){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function V(e,t,r,n,o){return o||$(e,0,r,4),i.write(e,t,r,n,23,4),r+4}function G(e,t,r,n,o){return o||$(e,0,r,8),i.write(e,t,r,n,52,8),r+8}l.prototype.slice=function(e,t){var r,n=this.length;if((e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e),l.TYPED_ARRAY_SUPPORT)(r=this.subarray(e,t)).__proto__=l.prototype;else{var o=t-e;r=new l(o,void 0);for(var i=0;i<o;++i)r[i]=this[i+e]}return r},l.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n},l.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e+--t],o=1;t>0&&(o*=256);)n+=this[e+--t]*o;return n},l.prototype.readUInt8=function(e,t){return t||U(e,1,this.length),this[e]},l.prototype.readUInt16LE=function(e,t){return t||U(e,2,this.length),this[e]|this[e+1]<<8},l.prototype.readUInt16BE=function(e,t){return t||U(e,2,this.length),this[e]<<8|this[e+1]},l.prototype.readUInt32LE=function(e,t){return t||U(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},l.prototype.readUInt32BE=function(e,t){return t||U(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},l.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=this[e],o=1,i=0;++i<t&&(o*=256);)n+=this[e+i]*o;return n>=(o*=128)&&(n-=Math.pow(2,8*t)),n},l.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||U(e,t,this.length);for(var n=t,o=1,i=this[e+--n];n>0&&(o*=256);)i+=this[e+--n]*o;return i>=(o*=128)&&(i-=Math.pow(2,8*t)),i},l.prototype.readInt8=function(e,t){return t||U(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},l.prototype.readInt16LE=function(e,t){t||U(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt16BE=function(e,t){t||U(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},l.prototype.readInt32LE=function(e,t){return t||U(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},l.prototype.readInt32BE=function(e,t){return t||U(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},l.prototype.readFloatLE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!0,23,4)},l.prototype.readFloatBE=function(e,t){return t||U(e,4,this.length),i.read(this,e,!1,23,4)},l.prototype.readDoubleLE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!0,52,8)},l.prototype.readDoubleBE=function(e,t){return t||U(e,8,this.length),i.read(this,e,!1,52,8)},l.prototype.writeUIntLE=function(e,t,r,n){e=+e,t|=0,r|=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var o=1,i=0;for(this[t]=255&e;++i<r&&(o*=256);)this[t+i]=e/o&255;return t+r},l.prototype.writeUIntBE=function(e,t,r,n){e=+e,t|=0,r|=0,n||B(this,e,t,r,Math.pow(2,8*r)-1,0);var o=r-1,i=1;for(this[t+o]=255&e;--o>=0&&(i*=256);)this[t+o]=e/i&255;return t+r},l.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,1,255,0),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},l.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):z(this,e,t,!0),t+2},l.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,65535,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):z(this,e,t,!1),t+2},l.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):F(this,e,t,!0),t+4},l.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,4294967295,0),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},l.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);B(this,e,t,r,o-1,-o)}var i=0,a=1,s=0;for(this[t]=255&e;++i<r&&(a*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},l.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var o=Math.pow(2,8*r-1);B(this,e,t,r,o-1,-o)}var i=r-1,a=1,s=0;for(this[t+i]=255&e;--i>=0&&(a*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/a>>0)-s&255;return t+r},l.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,1,127,-128),l.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},l.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):z(this,e,t,!0),t+2},l.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,2,32767,-32768),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):z(this,e,t,!1),t+2},l.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,2147483647,-2147483648),l.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):F(this,e,t,!0),t+4},l.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||B(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),l.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):F(this,e,t,!1),t+4},l.prototype.writeFloatLE=function(e,t,r){return V(this,e,t,!0,r)},l.prototype.writeFloatBE=function(e,t,r){return V(this,e,t,!1,r)},l.prototype.writeDoubleLE=function(e,t,r){return G(this,e,t,!0,r)},l.prototype.writeDoubleBE=function(e,t,r){return G(this,e,t,!1,r)},l.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var o,i=n-r;if(this===e&&r<t&&t<n)for(o=i-1;o>=0;--o)e[o+t]=this[o+r];else if(i<1e3||!l.TYPED_ARRAY_SUPPORT)for(o=0;o<i;++o)e[o+t]=this[o+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+i),t);return i},l.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var o=e.charCodeAt(0);o<256&&(e=o)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!l.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;var i;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(i=t;i<r;++i)this[i]=e;else{var a=l.isBuffer(e)?e:Q(new l(e,n).toString()),s=a.length;for(i=0;i<r-t;++i)this[i+t]=a[i%s]}return this};var H=/[^+\/0-9A-Za-z-_]/g;function Y(e){if((e=X(e).replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}function X(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function J(e){return e<16?"0"+e.toString(16):e.toString(16)}function Q(e,t){var r;t=t||1/0;for(var n=e.length,o=null,i=[],a=0;a<n;++a){if((r=e.charCodeAt(a))>55295&&r<57344){if(!o){if(r>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(a+1===n){(t-=3)>-1&&i.push(239,191,189);continue}o=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),o=r;continue}r=65536+(o-55296<<10|r-56320)}else o&&(t-=3)>-1&&i.push(239,191,189);if(o=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return i}function Z(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function K(e,t){for(var r,n,o,i=[],a=0;a<e.length&&!((t-=2)<0);++a)n=(r=e.charCodeAt(a))>>8,o=r%256,i.push(o),i.push(n);return i}function ee(e){return o.toByteArray(Y(e))}function te(e,t,r,n){for(var o=0;o<n&&!(o+r>=t.length||o>=e.length);++o)t[o+r]=e[o];return o}function re(e){return e!=e}},{"base64-js":"yh9p",ieee754:"JgNJ",isarray:"REa7",buffer:"dskh"}],g3U2:[function(e,t,r){var n;arguments[3],e("buffer").Buffer,arguments[3],e("buffer").Buffer;!function(e,o){"object"==typeof r&&"object"==typeof t?t.exports=o():"function"==typeof n&&n.amd?n([],o):"object"==typeof r?r.Quagga=o():e.Quagga=o()}(window,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/",r(r.s=87)}([function(e,t){e.exports=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){function r(t){return e.exports=r=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},r(t)}e.exports=r},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}e.exports=function(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}},function(e,t,r){var n=r(19),o=r(1);e.exports=function(e,t){return!t||"object"!==n(t)&&"function"!=typeof t?o(e):t}},function(e,t,r){var n=r(222);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&n(e,t)}},function(e,t,r){e.exports={EPSILON:r(61),create:r(62),clone:r(154),fromValues:r(155),copy:r(156),set:r(157),equals:r(158),exactEquals:r(159),add:r(160),subtract:r(63),sub:r(161),multiply:r(64),mul:r(162),divide:r(65),div:r(163),inverse:r(164),min:r(165),max:r(166),rotate:r(167),floor:r(168),ceil:r(169),round:r(170),scale:r(171),scaleAndAdd:r(172),distance:r(66),dist:r(173),squaredDistance:r(67),sqrDist:r(174),length:r(68),len:r(175),squaredLength:r(69),sqrLen:r(176),negate:r(177),normalize:r(178),dot:r(179),cross:r(180),lerp:r(181),random:r(182),transformMat2:r(183),transformMat2d:r(184),transformMat3:r(185),transformMat4:r(186),forEach:r(187),limit:r(188)}},function(e,t,r){"use strict";r.d(t,"h",function(){return l}),r.d(t,"i",function(){return d}),r.d(t,"b",function(){return f}),r.d(t,"j",function(){return h}),r.d(t,"e",function(){return p}),r.d(t,"c",function(){return g}),r.d(t,"f",function(){return m}),r.d(t,"g",function(){return y}),r.d(t,"a",function(){return b}),r.d(t,"d",function(){return _});var n=r(7),o=r(83),i={clone:n.clone,dot:n.dot},a={create:function(e,t){var r=[],n={rad:0,vec:i.clone([0,0])},o={};function a(e){o[e.id]=e,r.push(e)}function s(){var e,t=0;for(e=0;e<r.length;e++)t+=r[e].rad;n.rad=t/r.length,n.vec=i.clone([Math.cos(n.rad),Math.sin(n.rad)])}return a(e),s(),{add:function(e){o[e.id]||(a(e),s())},fits:function(e){return Math.abs(i.dot(e.point.vec,n.vec))>t},getPoints:function(){return r},getCenter:function(){return n}}},createPoint:function(e,t,r){return{rad:e[r],point:e,id:t}}},s=r(10),c={clone:n.clone},u={clone:o.clone};function l(e,t){return{x:e,y:t,toVec2:function(){return c.clone([this.x,this.y])},toVec3:function(){return u.clone([this.x,this.y,1])},round:function(){return this.x=this.x>0?Math.floor(this.x+.5):Math.floor(this.x-.5),this.y=this.y>0?Math.floor(this.y+.5):Math.floor(this.y-.5),this}}}function d(e,t){var r=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=8-r;function o(e,r){for(var n=0,o=e;o<=r;o++)n+=t[o];return n}function i(e,r){for(var n=0,o=e;o<=r;o++)n+=o*t[o];return n}return function(){var n,a,c,u,l=[0],d=(1<<r)-1;t=function(e,t){t||(t=8);for(var r=e.data,n=r.length,o=8-t,i=new Int32Array(1<<t);n--;)i[r[n]>>o]++;return i}(e,r);for(var f=1;f<d;f++)0==(c=(n=o(0,f))*(a=o(f+1,d)))&&(c=1),u=i(0,f)*a-i(f+1,d)*n,l[f]=u*u/c;return s.a.maxIndex(l)}()<<n}(e);return function(e,t,r){r||(r=e);for(var n=e.data,o=n.length,i=r.data;o--;)i[o]=n[o]<t?1:0}(e,r,t),r}function f(e,t,r){var n,o,i,s,c=[];function u(e){var t=!1;for(o=0;o<c.length;o++)(i=c[o]).fits(e)&&(i.add(e),t=!0);return t}for(r||(r="rad"),n=0;n<e.length;n++)u(s=a.createPoint(e[n],n,r))||c.push(a.create(s,t));return c}function h(e,t,r){var n,o,i,a,s=0,c=0,u=[];for(n=0;n<t;n++)u[n]={score:0,item:null};for(n=0;n<e.length;n++)if((o=r.apply(this,[e[n]]))>c)for((i=u[s]).score=o,i.item=e[n],c=Number.MAX_VALUE,a=0;a<t;a++)u[a].score<c&&(c=u[a].score,s=a);return u}function p(e,t,r){for(var n,o=0,i=t.x,a=Math.floor(e.length/4),s=t.x/2,c=0,u=t.x;i<a;){for(n=0;n<s;n++)r[c]=(.299*e[4*o+0]+.587*e[4*o+1]+.114*e[4*o+2]+(.299*e[4*(o+1)+0]+.587*e[4*(o+1)+1]+.114*e[4*(o+1)+2])+(.299*e[4*i+0]+.587*e[4*i+1]+.114*e[4*i+2])+(.299*e[4*(i+1)+0]+.587*e[4*(i+1)+1]+.114*e[4*(i+1)+2]))/4,c++,o+=2,i+=2;o+=u,i+=u}}function g(e,t,r){var n=e.length/4|0;if(r&&!0===r.singleChannel)for(var o=0;o<n;o++)t[o]=e[4*o+0];else for(var i=0;i<n;i++)t[i]=.299*e[4*i+0]+.587*e[4*i+1]+.114*e[4*i+2]}function m(e,t){for(var r=e.data,n=e.size.x,o=t.data,i=0,a=n,s=r.length,c=n/2,u=0;a<s;){for(var l=0;l<c;l++)o[u]=Math.floor((r[i]+r[i+1]+r[a]+r[a+1])/4),u++,i+=2,a+=2;i+=n,a+=n}}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[0,0,0],r=e[0],n=e[1],o=e[2],i=o*n,a=i*(1-Math.abs(r/60%2-1)),s=o-i,c=0,u=0,l=0;return r<60?(c=i,u=a):r<120?(c=a,u=i):r<180?(u=i,l=a):r<240?(u=a,l=i):r<300?(c=a,l=i):r<360&&(c=i,l=a),t[0]=255*(c+s)|0,t[1]=255*(u+s)|0,t[2]=255*(l+s)|0,t}function v(e){for(var t=[],r=[],n=1;n<Math.sqrt(e)+1;n++)e%n==0&&(r.push(n),n!==e/n&&t.unshift(Math.floor(e/n)));return r.concat(t)}function b(e,t){var r,n=v(t.x),o=v(t.y),i=Math.max(t.x,t.y),a=function(e,t){for(var r=0,n=0,o=[];r<e.length&&n<t.length;)e[r]===t[n]?(o.push(e[r]),r++,n++):e[r]>t[n]?n++:r++;return o}(n,o),s=[8,10,15,20,32,60,80],c={"x-small":5,small:4,medium:3,large:2,"x-large":1},u=c[e]||c.medium,l=s[u],d=Math.floor(i/l);function f(e){for(var t=0,r=e[Math.floor(e.length/2)];t<e.length-1&&e[t]<d;)t++;return t>0&&(r=Math.abs(e[t]-d)>Math.abs(e[t-1]-d)?e[t-1]:e[t]),d/r<s[u+1]/s[u]&&d/r>s[u-1]/s[u]?{x:r,y:r}:null}return(r=f(a))||(r=f(v(i)))||(r=f(v(d*l))),r}var w={top:function(e,t){return"%"===e.unit?Math.floor(t.height*(e.value/100)):null},right:function(e,t){return"%"===e.unit?Math.floor(t.width-t.width*(e.value/100)):null},bottom:function(e,t){return"%"===e.unit?Math.floor(t.height-t.height*(e.value/100)):null},left:function(e,t){return"%"===e.unit?Math.floor(t.width*(e.value/100)):null}};function _(e,t,r){var n={width:e,height:t},o=Object.keys(r).reduce(function(e,t){var o=function(e){return{value:parseFloat(e),unit:(e.indexOf("%"),e.length,"%")}}(r[t]),i=w[t](o,n);return e[t]=i,e},{});return{sx:o.left,sy:o.top,sw:o.right-o.left,sh:o.bottom-o.top}}},function(e,t,r){"use strict";t.a={drawRect:function(e,t,r,n){r.strokeStyle=n.color,r.fillStyle=n.color,r.lineWidth=n.lineWidth||1,r.beginPath(),r.strokeRect(e.x,e.y,t.x,t.y)},drawPath:function(e,t,r,n){r.strokeStyle=n.color,r.fillStyle=n.color,r.lineWidth=n.lineWidth,r.beginPath(),r.moveTo(e[0][t.x],e[0][t.y]);for(var o=1;o<e.length;o++)r.lineTo(e[o][t.x],e[o][t.y]);r.closePath(),r.stroke()},drawImage:function(e,t,r){var n=r.getImageData(0,0,t.x,t.y),o=n.data,i=o.length,a=e.length;if(i/a!=4)return!1;for(;a--;){var s=e[a];o[--i]=255,o[--i]=s,o[--i]=s,o[--i]=s}return r.putImageData(n,0,0),!0}}},function(e,t,r){"use strict";t.a={init:function(e,t){for(var r=e.length;r--;)e[r]=t},shuffle:function(e){for(var t=e.length-1;t>=0;t--){var r=Math.floor(Math.random()*t),n=e[t];e[t]=e[r],e[r]=n}return e},toPointList:function(e){var t=e.reduce(function(e,t){var r="[".concat(t.join(","),"]");return e.push(r),e},[]);return"[".concat(t.join(",\r\n"),"]")},threshold:function(e,t,r){return e.reduce(function(n,o){return r.apply(e,[o])>=t&&n.push(o),n},[])},maxIndex:function(e){for(var t=0,r=0;r<e.length;r++)e[r]>e[t]&&(t=r);return t},max:function(e){for(var t=0,r=0;r<e.length;r++)e[r]>t&&(t=e[r]);return t},sum:function(e){for(var t=e.length,r=0;t--;)r+=e[t];return r}}},function(e,t,r){"use strict";var n=r(82),o=r.n(n),i=r(3),a=r.n(i),s=r(4),c=r.n(s),u=r(0),l=r.n(u),d=r(7),f=r(8),h=r(10),p={clone:d.clone};function g(e){if(e<0)throw new Error("expected positive number, received ".concat(e))}var m=function(){function e(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Uint8Array,o=arguments.length>3?arguments[3]:void 0;a()(this,e),l()(this,"data",void 0),l()(this,"size",void 0),l()(this,"indexMapping",void 0),r?this.data=r:(this.data=new n(t.x*t.y),o&&h.a.init(this.data,0)),this.size=t}return c()(e,[{key:"inImageWithBorder",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return g(t),e.x>=0&&e.y>=0&&e.x<this.size.x+2*t&&e.y<this.size.y+2*t}},{key:"subImageAsCopy",value:function(e,t){g(t.x),g(t.y);for(var r=e.size,n=r.x,o=r.y,i=0;i<n;i++)for(var a=0;a<o;a++)e.data[a*n+i]=this.data[(t.y+a)*this.size.x+t.x+i];return e}},{key:"get",value:function(e,t){return this.data[t*this.size.x+e]}},{key:"getSafe",value:function(e,t){if(!this.indexMapping){this.indexMapping={x:[],y:[]};for(var r=0;r<this.size.x;r++)this.indexMapping.x[r]=r,this.indexMapping.x[r+this.size.x]=r;for(var n=0;n<this.size.y;n++)this.indexMapping.y[n]=n,this.indexMapping.y[n+this.size.y]=n}return this.data[this.indexMapping.y[t+this.size.y]*this.size.x+this.indexMapping.x[e+this.size.x]]}},{key:"set",value:function(e,t,r){return this.data[t*this.size.x+e]=r,delete this.indexMapping,this}},{key:"zeroBorder",value:function(){for(var e=this.size,t=e.x,r=e.y,n=0;n<t;n++)this.data[n]=this.data[(r-1)*t+n]=0;for(var o=1;o<r-1;o++)this.data[o*t]=this.data[o*t+(t-1)]=0;return delete this.indexMapping,this}},{key:"moments",value:function(e){var t,r,n,o,i,a,s,c,u,l,d=this.data,f=this.size.y,h=this.size.x,g=[],m=[],y=Math.PI,v=y/4;if(e<=0)return m;for(i=0;i<e;i++)g[i]={m00:0,m01:0,m10:0,m11:0,m02:0,m20:0,theta:0,rad:0};for(r=0;r<f;r++)for(o=r*r,t=0;t<h;t++)(n=d[r*h+t])>0&&((a=g[n-1]).m00+=1,a.m01+=r,a.m10+=t,a.m11+=t*r,a.m02+=o,a.m20+=t*t);for(i=0;i<e;i++)a=g[i],isNaN(a.m00)||0===a.m00||(c=a.m10/a.m00,u=a.m01/a.m00,s=a.m11/a.m00-c*u,l=(a.m02/a.m00-u*u-(a.m20/a.m00-c*c))/(2*s),l=.5*Math.atan(l)+(s>=0?v:-v)+y,a.theta=(180*l/y+90)%180-90,a.theta<0&&(a.theta+=180),a.rad=l>y?l-y:l,a.vec=p.clone([Math.cos(l),Math.sin(l)]),m.push(a));return m}},{key:"getAsRGBA",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new Uint8ClampedArray(4*this.size.x*this.size.y),r=0;r<this.size.y;r++)for(var n=0;n<this.size.x;n++){var o=r*this.size.x+n,i=this.get(n,r)*e;t[4*o+0]=i,t[4*o+1]=i,t[4*o+2]=i,t[4*o+3]=255}return t}},{key:"show",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=e.getContext("2d");if(!r)throw new Error("Unable to get canvas context");var n=r.getImageData(0,0,e.width,e.height),o=this.getAsRGBA(t);e.width=this.size.x,e.height=this.size.y;var i=new ImageData(o,n.width,n.height);r.putImageData(i,0,0)}},{key:"overlay",value:function(e,t,r){var n=t<0||t>360?360:t,i=[0,1,1],a=[0,0,0],s=[255,255,255],c=[0,0,0],u=e.getContext("2d");if(!u)throw new Error("Unable to get canvas context");for(var l=u.getImageData(r.x,r.y,this.size.x,this.size.y),d=l.data,h=this.data.length;h--;){i[0]=this.data[h]*n;var p=4*h,g=i[0]<=0?s:i[0]>=360?c:Object(f.g)(i,a),m=o()(g,3);d[p]=m[0],d[p+1]=m[1],d[p+2]=m[2],d[p+3]=255}u.putImageData(l,r.x,r.y)}}]),e}();t.a=m},function(e,t,r){e.exports=r(227)},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t){var r=Array.isArray;e.exports=r},function(e,t,r){var n=r(88),o=r(143)(function(e,t,r){n(e,t,r)});e.exports=o},function(e,t,r){var n=r(226);function o(t,r,i){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=o=Reflect.get:e.exports=o=function(e,t,r){var o=n(e,t);if(o){var i=Object.getOwnPropertyDescriptor(o,t);return i.get?i.get.call(r):i.value}},o(t,r,i||t)}e.exports=o},function(e,t,r){var n=r(44),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){function r(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=r=function(e){return typeof e}:e.exports=r=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(t)}e.exports=r},function(e,t){function r(e,t,r,n,o,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(n,o)}e.exports=function(e){return function(){var t=this,n=arguments;return new Promise(function(o,i){var a=e.apply(t,n);function s(e){r(a,o,i,s,c,"next",e)}function c(e){r(a,o,i,s,c,"throw",e)}s(void 0)})}}},function(e,t,r){"use strict";t.a={searchDirections:[[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1],[-1,0],[-1,1]],create:function(e,t){var r,n=e.data,o=t.data,i=this.searchDirections,a=e.size.x;function s(e,t,s,c){var u,l,d;for(u=0;u<7;u++){if(l=e.cy+i[e.dir][0],d=e.cx+i[e.dir][1],n[r=l*a+d]===t&&(0===o[r]||o[r]===s))return o[r]=s,e.cy=l,e.cx=d,!0;0===o[r]&&(o[r]=c),e.dir=(e.dir+1)%8}return!1}function c(e,t,r){return{dir:r,x:e,y:t,next:null,prev:null}}return{trace:function(e,t,r,n){return s(e,t,r,n)},contourTracing:function(e,t,r,n,o){return function(e,t,r,n,o){var i,a,u,l=null,d={cx:t,cy:e,dir:0};if(s(d,n,r,o)){i=l=c(t,e,d.dir),u=d.dir,(a=c(d.cx,d.cy,0)).prev=i,i.next=a,a.next=null,i=a;do{d.dir=(d.dir+6)%8,s(d,n,r,o),u!==d.dir?(i.dir=d.dir,(a=c(d.cx,d.cy,0)).prev=i,i.next=a,a.next=null,i=a):(i.dir=u,i.x=d.cx,i.y=d.cy),u=d.dir}while(d.cx!==t||d.cy!==e);l.prev=i.prev,i.prev.next=l}return l}(e,t,r,n,o)}}}}},function(e,t,r){var n=r(27),o=r(101),i=r(102),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},function(e,t,r){"use strict";(function(e){var n,o,i,a,s,c,u,l,d,f,h,p,g=r(7),m=r(34),y=r(11),v=r(8),b=r(10),w=r(9),_=r(85),S=r(21),R=r(86),x={ctx:{binary:null},dom:{binary:null}},E={x:0,y:0};function C(e){var t,r,o,i,s,c,u,l=d.size.x,f=d.size.y,h=-d.size.x,p=-d.size.y;for(t=0,r=0;r<e.length;r++)t+=(i=e[r]).rad,n.debug.showPatches&&w.a.drawRect(i.pos,a.size,x.ctx.binary,{color:"red"});for((t=(180*(t/=e.length)/Math.PI+90)%180-90)<0&&(t+=180),t=(180-t)*Math.PI/180,s=m.copy(m.create(),[Math.cos(t),Math.sin(t),-Math.sin(t),Math.cos(t)]),r=0;r<e.length;r++){for(i=e[r],o=0;o<4;o++)g.transformMat2(i.box[o],i.box[o],s);n.debug.boxFromPatches.showTransformed&&w.a.drawPath(i.box,{x:0,y:1},x.ctx.binary,{color:"#99ff00",lineWidth:2})}for(r=0;r<e.length;r++)for(i=e[r],o=0;o<4;o++)i.box[o][0]<l&&(l=i.box[o][0]),i.box[o][0]>h&&(h=i.box[o][0]),i.box[o][1]<f&&(f=i.box[o][1]),i.box[o][1]>p&&(p=i.box[o][1]);for(c=[[l,f],[h,f],[h,p],[l,p]],n.debug.boxFromPatches.showTransformedBox&&w.a.drawPath(c,{x:0,y:1},x.ctx.binary,{color:"#ff0000",lineWidth:2}),u=n.halfSample?2:1,s=m.invert(s,s),o=0;o<4;o++)g.transformMat2(c[o],c[o],s);for(n.debug.boxFromPatches.showBB&&w.a.drawPath(c,{x:0,y:1},x.ctx.binary,{color:"#ff0000",lineWidth:2}),o=0;o<4;o++)g.scale(c[o],c[o],u);return c}function O(e,t){d.subImageAsCopy(a,Object(v.h)(e,t)),p.skeletonize(),n.debug.showSkeleton&&i.overlay(x.dom.binary,360,Object(v.h)(e,t))}function T(e,t,r,n){var o,i,s,c,u=[],l=[],d=Math.ceil(f.x/3);if(e.length>=2){for(o=0;o<e.length;o++)e[o].m00>d&&u.push(e[o]);if(u.length>=2){for(s=function(e){var t=Object(v.b)(e,.9),r=Object(v.j)(t,1,function(e){return e.getPoints().length}),n=[],o=[];if(1===r.length){n=r[0].item.getPoints();for(var i=0;i<n.length;i++)o.push(n[i].point)}return o}(u),i=0,o=0;o<s.length;o++)i+=s[o].rad;s.length>1&&s.length>=u.length/4*3&&s.length>e.length/4&&(i/=s.length,c={index:t[1]*E.x+t[0],pos:{x:r,y:n},box:[g.clone([r,n]),g.clone([r+a.size.x,n]),g.clone([r+a.size.x,n+a.size.y]),g.clone([r,n+a.size.y])],moments:s,rad:i,vec:g.clone([Math.cos(i),Math.sin(i)])},l.push(c))}}return l}t.a={init:function(t,r){n=r,h=t,function(){o=n.halfSample?new y.a({x:h.size.x/2|0,y:h.size.y/2|0}):h,f=Object(v.a)(n.patchSize,o.size),E.x=o.size.x/f.x|0,E.y=o.size.y/f.y|0,d=new y.a(o.size,void 0,Uint8Array,!1),s=new y.a(f,void 0,Array,!0);var t=new ArrayBuffer(65536);a=new y.a(f,new Uint8Array(t,0,f.x*f.y)),i=new y.a(f,new Uint8Array(t,f.x*f.y*3,f.x*f.y),void 0,!0),p=Object(R.a)("undefined"!=typeof window?window:"undefined"!=typeof self?self:e,{size:f.x},t),l=new y.a({x:o.size.x/a.size.x|0,y:o.size.y/a.size.y|0},void 0,Array,!0),c=new y.a(l.size,void 0,void 0,!0),u=new y.a(l.size,void 0,Int32Array,!0)}(),n.useWorker||"undefined"==typeof document||(x.dom.binary=document.createElement("canvas"),x.dom.binary.className="binaryBuffer",!0===n.debug.showCanvas&&document.querySelector("#debug").appendChild(x.dom.binary),x.ctx.binary=x.dom.binary.getContext("2d"),x.dom.binary.width=d.size.x,x.dom.binary.height=d.size.y)},locate:function(){n.halfSample&&Object(v.f)(h,o),Object(v.i)(o,d),d.zeroBorder(),n.debug.showCanvas&&d.show(x.dom.binary,255);var e=function(){var e,t,r,o,c,u,l,d=[];for(e=0;e<E.x;e++)for(t=0;t<E.y;t++)O(r=a.size.x*e,o=a.size.y*t),i.zeroBorder(),b.a.init(s.data,0),u=_.a.create(i,s).rasterize(0),n.debug.showLabels&&s.overlay(x.dom.binary,Math.floor(360/u.count),{x:r,y:o}),c=s.moments(u.count),d=d.concat(T(c,[e,t],r,o));if(n.debug.showFoundPatches)for(e=0;e<d.length;e++)l=d[e],w.a.drawRect(l.pos,a.size,x.ctx.binary,{color:"#99ff00",lineWidth:2});return d}();if(e.length<E.x*E.y*.05)return null;var t=function(e){var t,r,o=0,i=.95,s=0,d=[0,1,1],f=[0,0,0];function h(){var e;for(e=0;e<u.data.length;e++)if(0===u.data[e]&&1===c.data[e])return e;return u.length}function p(e){var t,r,n,a,s,d=e%u.size.x,f=e/u.size.x|0;if(e<u.data.length)for(n=l.data[e],u.data[e]=o,s=0;s<S.a.searchDirections.length;s++)r=f+S.a.searchDirections[s][0],t=d+S.a.searchDirections[s][1],a=r*u.size.x+t,0!==c.data[a]?0===u.data[a]&&Math.abs(g.dot(l.data[a].vec,n.vec))>i&&p(a):u.data[a]=Number.MAX_VALUE}for(b.a.init(c.data,0),b.a.init(u.data,0),b.a.init(l.data,null),t=0;t<e.length;t++)r=e[t],l.data[r.index]=r,c.data[r.index]=1;for(c.zeroBorder();(s=h())<u.data.length;)o++,p(s);if(n.debug.showPatchLabels)for(t=0;t<u.data.length;t++)u.data[t]>0&&u.data[t]<=o&&(r=l.data[t],d[0]=u.data[t]/(o+1)*360,Object(v.g)(d,f),w.a.drawRect(r.pos,a.size,x.ctx.binary,{color:"rgb(".concat(f.join(","),")"),lineWidth:2}));return o}(e);if(t<1)return null;var r=function(e){var t,r,n=[];for(t=0;t<e;t++)n.push(0);for(r=u.data.length;r--;)u.data[r]>0&&n[u.data[r]-1]++;return(n=n.map(function(e,t){return{val:e,label:t+1}})).sort(function(e,t){return t.val-e.val}),n.filter(function(e){return e.val>=5})}(t);return 0===r.length?null:function(e,t){var r,o,i,s,c,d=[],f=[],h=[0,1,1],p=[0,0,0];for(r=0;r<e.length;r++){for(i=u.data.length,d.length=0;i--;)u.data[i]===e[r].label&&(s=l.data[i],d.push(s));if((c=C(d))&&(f.push(c),n.debug.showRemainingPatchLabels))for(o=0;o<d.length;o++)s=d[o],h[0]=e[r].label/(t+1)*360,Object(v.g)(h,p),w.a.drawRect(s.pos,a.size,x.ctx.binary,{color:"rgb(".concat(p.join(","),")"),lineWidth:2})}return f}(r,t)},checkImageConstraints:function(e,t){var r,n,o=e.getWidth(),i=e.getHeight(),a=t.halfSample?.5:1;e.getConfig().area&&(n=Object(v.d)(o,i,e.getConfig().area),e.setTopRight({x:n.sx,y:n.sy}),e.setCanvasSize({x:o,y:i}),o=n.sw,i=n.sh);var s={x:Math.floor(o*a),y:Math.floor(i*a)};if(r=Object(v.a)(t.patchSize,s),console.log("Patch-Size: ".concat(JSON.stringify(r))),e.setWidth(Math.floor(Math.floor(s.x/r.x)*(1/a)*r.x)),e.setHeight(Math.floor(Math.floor(s.y/r.y)*(1/a)*r.y)),e.getWidth()%r.x==0&&e.getHeight()%r.y==0)return!0;throw new Error("Image dimensions do not comply with the current settings: Width (".concat(o," )and height (").concat(i,") must a multiple of ").concat(r.x))}}}).call(this,r(45))},function(e,t,r){var n=r(90),o=r(91),i=r(92),a=r(93),s=r(94);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t,r){var n=r(26);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},function(e,t,r){var n=r(17).Symbol;e.exports=n},function(e,t,r){var n=r(35)(Object,"create");e.exports=n},function(e,t,r){var n=r(115);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},function(e,t,r){var n=r(130),o=r(18),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,c=n(function(){return arguments}())?n:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=c},function(e,t){var r=/^(?:0|[1-9]\d*)$/;e.exports=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&r.test(e))&&e>-1&&e%1==0&&e<t}},function(e,t,r){var n=r(14),o=r(231),i=r(232),a=r(235);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:i(a(e))}},function(e,t,r){var n=r(223),o=r(224),i=r(59),a=r(225);e.exports=function(e){return n(e)||o(e)||i(e)||a()}},function(e,t,r){e.exports={determinant:r(247),transpose:r(248),multiply:r(249),identity:r(250),adjoint:r(251),rotate:r(252),invert:r(253),create:r(254),scale:r(255),copy:r(256),frob:r(257),ldu:r(258)}},function(e,t,r){var n=r(100),o=r(106);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},function(e,t,r){var n=r(22),o=r(13);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(e,t,r){var n=r(48);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){var n=r(36),o=r(40);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},function(e,t){e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},function(e,t,r){var n=r(22),o=r(18);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},function(e,t,r){var n=r(41);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},function(e,t,r){var n=r(35)(r(17),"Map");e.exports=n},function(e,t,r){(function(t){var r="object"==typeof t&&t&&t.Object===Object&&t;e.exports=r}).call(this,r(45))},function(e,t){var r;r=function(){return this}();try{r=r||new Function("return this")()}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){var n=r(107),o=r(114),i=r(116),a=r(117),s=r(118);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t,r){var n=r(37),o=r(26);e.exports=function(e,t,r){(void 0===r||o(e[t],r))&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t,r){var n=r(35),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},function(e,t,r){var n=r(129)(Object.getPrototypeOf,Object);e.exports=n},function(e,t){var r=Object.prototype;e.exports=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||r)}},function(e,t,r){(function(e){var n=r(17),o=r(132),i=t&&!t.nodeType&&t,a=i&&"object"==typeof e&&e&&!e.nodeType&&e,s=a&&a.exports===i?n.Buffer:void 0,c=(s?s.isBuffer:void 0)||o;e.exports=c}).call(this,r(38)(e))},function(e,t,r){var n=r(134),o=r(135),i=r(136),a=i&&i.isTypedArray,s=a?o(a):n;e.exports=s},function(e,t){e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},function(e,t,r){var n=r(37),o=r(26),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var a=e[t];i.call(e,t)&&o(a,r)&&(void 0!==r||t in e)||n(e,t,r)}},function(e,t,r){var n=r(139),o=r(141),i=r(39);e.exports=function(e){return i(e)?n(e,!0):o(e)}},function(e,t){e.exports=function(e){return e}},function(e,t,r){var n=r(145),o=Math.max;e.exports=function(e,t,r){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),c=Array(s);++a<s;)c[a]=i[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=i[a];return u[t]=r(c),n(e,this,u)}}},function(e,t,r){var n=r(146),o=r(148)(n);e.exports=o},function(e,t,r){var n=r(60);e.exports=function(e,t){if(e){if("string"==typeof e)return n(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}},function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(2);return e[0]=0,e[1]=0,e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e}},function(e,t){e.exports=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}},function(e,t){e.exports=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n}},function(e,t){e.exports=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)}},function(e,t){e.exports=function(e){var t=e[0],r=e[1];return t*t+r*r}},function(e,t){e.exports=1e-6},function(e,t){e.exports=function(){var e=new Float32Array(3);return e[0]=0,e[1]=0,e[2]=0,e}},function(e,t){e.exports=function(e,t,r){var n=new Float32Array(3);return n[0]=e,n[1]=t,n[2]=r,n}},function(e,t){e.exports=function(e,t){var r=t[0],n=t[1],o=t[2],i=r*r+n*n+o*o;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i,e[2]=t[2]*i),e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e}},function(e,t){e.exports=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return Math.sqrt(r*r+n*n+o*o)}},function(e,t){e.exports=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],o=t[2]-e[2];return r*r+n*n+o*o}},function(e,t){e.exports=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)}},function(e,t){e.exports=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n}},function(e,t,r){var n=r(151),o=r(152),i=r(59),a=r(153);e.exports=function(e,t){return n(e)||o(e,t)||i(e,t)||a()}},function(e,t,r){e.exports={EPSILON:r(70),create:r(71),clone:r(189),angle:r(190),fromValues:r(72),copy:r(191),set:r(192),equals:r(193),exactEquals:r(194),add:r(195),subtract:r(75),sub:r(196),multiply:r(76),mul:r(197),divide:r(77),div:r(198),min:r(199),max:r(200),floor:r(201),ceil:r(202),round:r(203),scale:r(204),scaleAndAdd:r(205),distance:r(78),dist:r(206),squaredDistance:r(79),sqrDist:r(207),length:r(80),len:r(208),squaredLength:r(81),sqrLen:r(209),negate:r(210),inverse:r(211),normalize:r(73),dot:r(74),cross:r(212),lerp:r(213),random:r(214),transformMat4:r(215),transformMat3:r(216),transformQuat:r(217),rotateX:r(218),rotateY:r(219),rotateZ:r(220),forEach:r(221)}},function(e,t,r){var n=r(228),o=r(242)(function(e,t){return null==e?{}:n(e,t)});e.exports=o},function(e,t,r){"use strict";var n=r(21),o={createContour2D:function(){return{dir:null,index:null,firstVertex:null,insideContours:null,nextpeer:null,prevpeer:null}},CONTOUR_DIR:{CW_DIR:0,CCW_DIR:1,UNKNOWN_DIR:2},DIR:{OUTSIDE_EDGE:-32767,INSIDE_EDGE:-32766},create:function(e,t){var r=e.data,i=t.data,a=e.size.x,s=e.size.y,c=n.a.create(e,t);return{rasterize:function(e){var t,n,u,l,d,f,h,p,g,m,y,v,b=[],w=0;for(v=0;v<400;v++)b[v]=0;for(b[0]=r[0],g=null,f=1;f<s-1;f++)for(l=0,n=b[0],d=1;d<a-1;d++)if(0===i[y=f*a+d])if((t=r[y])!==n){if(0===l)b[u=w+1]=t,n=t,null!==(h=c.contourTracing(f,d,u,t,o.DIR.OUTSIDE_EDGE))&&(w++,l=u,(p=o.createContour2D()).dir=o.CONTOUR_DIR.CW_DIR,p.index=l,p.firstVertex=h,p.nextpeer=g,p.insideContours=null,null!==g&&(g.prevpeer=p),g=p);else if(null!==(h=c.contourTracing(f,d,o.DIR.INSIDE_EDGE,t,l))){for((p=o.createContour2D()).firstVertex=h,p.insideContours=null,p.dir=0===e?o.CONTOUR_DIR.CCW_DIR:o.CONTOUR_DIR.CW_DIR,p.index=e,m=g;null!==m&&m.index!==l;)m=m.nextpeer;null!==m&&(p.nextpeer=m.insideContours,null!==m.insideContours&&(m.insideContours.prevpeer=p),m.insideContours=p)}}else i[y]=l;else i[y]===o.DIR.OUTSIDE_EDGE||i[y]===o.DIR.INSIDE_EDGE?(l=0,n=i[y]===o.DIR.INSIDE_EDGE?r[y]:b[0]):n=b[l=i[y]];for(m=g;null!==m;)m.index=e,m=m.nextpeer;return{cc:g,count:w}},debug:{drawContour:function(e,t){var r,n,i,a=e.getContext("2d"),s=t;for(a.strokeStyle="red",a.fillStyle="red",a.lineWidth=1,r=null!==s?s.insideContours:null;null!==s;){switch(null!==r?(n=r,r=r.nextpeer):(n=s,r=null!==(s=s.nextpeer)?s.insideContours:null),n.dir){case o.CONTOUR_DIR.CW_DIR:a.strokeStyle="red";break;case o.CONTOUR_DIR.CCW_DIR:a.strokeStyle="blue";break;case o.CONTOUR_DIR.UNKNOWN_DIR:a.strokeStyle="green"}i=n.firstVertex,a.beginPath(),a.moveTo(i.x,i.y);do{i=i.next,a.lineTo(i.x,i.y)}while(i!==n.firstVertex);a.stroke()}}}}}};t.a=o},function(e,t,r){"use strict";t.a=function(e,t,r){"use asm";var n=new e.Uint8Array(r),o=t.size|0,i=e.Math.imul;function a(e,t){e|=0;t|=0;var r=0;var i=0;var a=0;var s=0;var c=0;var u=0;var l=0;var d=0;for(r=1;(r|0)<(o-1|0);r=r+1|0){d=d+o|0;for(i=1;(i|0)<(o-1|0);i=i+1|0){s=d-o|0;c=d+o|0;u=i-1|0;l=i+1|0;a=(n[e+s+u|0]|0)+(n[e+s+l|0]|0)+(n[e+d+i|0]|0)+(n[e+c+u|0]|0)+(n[e+c+l|0]|0)|0;if((a|0)==(5|0)){n[t+d+i|0]=1}else{n[t+d+i|0]=0}}}}function s(e,t,r){e|=0;t|=0;r|=0;var a=0;a=i(o,o)|0;while((a|0)>0){a=a-1|0;n[r+a|0]=(n[e+a|0]|0)-(n[t+a|0]|0)|0}}function c(e,t,r){e|=0;t|=0;r|=0;var a=0;a=i(o,o)|0;while((a|0)>0){a=a-1|0;n[r+a|0]=n[e+a|0]|0|(n[t+a|0]|0)|0}}function u(e){e|=0;var t=0;var r=0;r=i(o,o)|0;while((r|0)>0){r=r-1|0;t=(t|0)+(n[e+r|0]|0)|0}return t|0}function l(e,t){e|=0;t|=0;var r=0;r=i(o,o)|0;while((r|0)>0){r=r-1|0;n[e+r|0]=t}}function d(e,t){e|=0;t|=0;var r=0;var i=0;var a=0;var s=0;var c=0;var u=0;var l=0;var d=0;for(r=1;(r|0)<(o-1|0);r=r+1|0){d=d+o|0;for(i=1;(i|0)<(o-1|0);i=i+1|0){s=d-o|0;c=d+o|0;u=i-1|0;l=i+1|0;a=(n[e+s+u|0]|0)+(n[e+s+l|0]|0)+(n[e+d+i|0]|0)+(n[e+c+u|0]|0)+(n[e+c+l|0]|0)|0;if((a|0)>(0|0)){n[t+d+i|0]=1}else{n[t+d+i|0]=0}}}}function f(e,t){e|=0;t|=0;var r=0;r=i(o,o)|0;while((r|0)>0){r=r-1|0;n[t+r|0]=n[e+r|0]|0}}function h(e){e|=0;var t=0;var r=0;for(t=0;(t|0)<(o-1|0);t=t+1|0){n[e+t|0]=0;n[e+r|0]=0;r=r+o-1|0;n[e+r|0]=0;r=r+1|0}for(t=0;(t|0)<(o|0);t=t+1|0){n[e+r|0]=0;r=r+1|0}}function p(){var e=0;var t=0;var r=0;var n=0;var p=0;var g=0;t=i(o,o)|0;r=t+t|0;n=r+t|0;l(n,0);h(e);do{a(e,t);d(t,r);s(e,r,r);c(n,r,n);f(t,e);p=u(e)|0;g=(p|0)==0|0}while(!g)}return{skeletonize:p}}},function(e,t,r){e.exports=r(259)},function(e,t,r){var n=r(89),o=r(47),i=r(119),a=r(121),s=r(13),c=r(55),u=r(53);e.exports=function e(t,r,l,d,f){t!==r&&i(r,function(i,c){if(f||(f=new n),s(i))a(t,r,c,l,e,d,f);else{var h=d?d(u(t,c),i,c+"",t,r,f):void 0;void 0===h&&(h=i),o(t,c,h)}},c)}},function(e,t,r){var n=r(24),o=r(95),i=r(96),a=r(97),s=r(98),c=r(99);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=c,e.exports=u},function(e,t){e.exports=function(){this.__data__=[],this.size=0}},function(e,t,r){var n=r(25),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0||(r==t.length-1?t.pop():o.call(t,r,1),--this.size,0))}},function(e,t,r){var n=r(25);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},function(e,t,r){var n=r(25);e.exports=function(e){return n(this.__data__,e)>-1}},function(e,t,r){var n=r(25);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},function(e,t,r){var n=r(24);e.exports=function(){this.__data__=new n,this.size=0}},function(e,t){e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},function(e,t){e.exports=function(e){return this.__data__.get(e)}},function(e,t){e.exports=function(e){return this.__data__.has(e)}},function(e,t,r){var n=r(24),o=r(43),i=r(46);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(a)}return r.set(e,t),this.size=r.size,this}},function(e,t,r){var n=r(36),o=r(103),i=r(13),a=r(105),s=/^\[object .+?Constructor\]$/,c=Function.prototype,u=Object.prototype,l=c.toString,d=u.hasOwnProperty,f=RegExp("^"+l.call(d).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?f:s).test(a(e))}},function(e,t,r){var n=r(27),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var o=a.call(e);return n&&(t?e[s]=r:delete e[s]),o}},function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},function(e,t,r){var n,o=r(104),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},function(e,t,r){var n=r(17)["__core-js_shared__"];e.exports=n},function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},function(e,t,r){var n=r(108),o=r(24),i=r(43);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},function(e,t,r){var n=r(109),o=r(110),i=r(111),a=r(112),s=r(113);function c(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}c.prototype.clear=n,c.prototype.delete=o,c.prototype.get=i,c.prototype.has=a,c.prototype.set=s,e.exports=c},function(e,t,r){var n=r(28);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},function(e,t,r){var n=r(28),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},function(e,t,r){var n=r(28),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},function(e,t,r){var n=r(28);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},function(e,t,r){var n=r(29);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},function(e,t,r){var n=r(29);e.exports=function(e){return n(this,e).get(e)}},function(e,t,r){var n=r(29);e.exports=function(e){return n(this,e).has(e)}},function(e,t,r){var n=r(29);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},function(e,t,r){var n=r(120)();e.exports=n},function(e,t){e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var c=a[e?s:++o];if(!1===r(i[c],c,i))break}return t}}},function(e,t,r){var n=r(47),o=r(122),i=r(123),a=r(126),s=r(127),c=r(30),u=r(14),l=r(131),d=r(51),f=r(36),h=r(13),p=r(133),g=r(52),m=r(53),y=r(137);e.exports=function(e,t,r,v,b,w,_){var S=m(e,r),R=m(t,r),x=_.get(R);if(x)n(e,r,x);else{var E=w?w(S,R,r+"",e,t,_):void 0,C=void 0===E;if(C){var O=u(R),T=!O&&d(R),A=!O&&!T&&g(R);E=R,O||T||A?u(S)?E=S:l(S)?E=a(S):T?(C=!1,E=o(R,!0)):A?(C=!1,E=i(R,!0)):E=[]:p(R)||c(R)?(E=S,c(S)?E=y(S):h(S)&&!f(S)||(E=s(R))):C=!1}C&&(_.set(R,E),b(E,R,v,w,_),_.delete(R)),n(e,r,E)}}},function(e,t,r){(function(e){var n=r(17),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o?n.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}}).call(this,r(38)(e))},function(e,t,r){var n=r(124);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},function(e,t,r){var n=r(125);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},function(e,t,r){var n=r(17).Uint8Array;e.exports=n},function(e,t){e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},function(e,t,r){var n=r(128),o=r(49),i=r(50);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(o(e))}},function(e,t,r){var n=r(13),o=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(o)return o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},function(e,t){e.exports=function(e,t){return function(r){return e(t(r))}}},function(e,t,r){var n=r(22),o=r(18);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},function(e,t,r){var n=r(39),o=r(18);e.exports=function(e){return o(e)&&n(e)}},function(e,t){e.exports=function(){return!1}},function(e,t,r){var n=r(22),o=r(49),i=r(18),a=Function.prototype,s=Object.prototype,c=a.toString,u=s.hasOwnProperty,l=c.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=n(e))return!1;var t=o(e);if(null===t)return!0;var r=u.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&c.call(r)==l}},function(e,t,r){var n=r(22),o=r(40),i=r(18),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[n(e)]}},function(e,t){e.exports=function(e){return function(t){return e(t)}}},function(e,t,r){(function(e){var n=r(44),o=t&&!t.nodeType&&t,i=o&&"object"==typeof e&&e&&!e.nodeType&&e,a=i&&i.exports===o&&n.process,s=function(){try{return i&&i.require&&i.require("util").types||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s}).call(this,r(38)(e))},function(e,t,r){var n=r(138),o=r(55);e.exports=function(e){return n(e,o(e))}},function(e,t,r){var n=r(54),o=r(37);e.exports=function(e,t,r,i){var a=!r;r||(r={});for(var s=-1,c=t.length;++s<c;){var u=t[s],l=i?i(r[u],e[u],u,r,e):void 0;void 0===l&&(l=e[u]),a?o(r,u,l):n(r,u,l)}return r}},function(e,t,r){var n=r(140),o=r(30),i=r(14),a=r(51),s=r(31),c=r(52),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),l=!r&&o(e),d=!r&&!l&&a(e),f=!r&&!l&&!d&&c(e),h=r||l||d||f,p=h?n(e.length,String):[],g=p.length;for(var m in e)!t&&!u.call(e,m)||h&&("length"==m||d&&("offset"==m||"parent"==m)||f&&("buffer"==m||"byteLength"==m||"byteOffset"==m)||s(m,g))||p.push(m);return p}},function(e,t){e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},function(e,t,r){var n=r(13),o=r(50),i=r(142),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=o(e),r=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&r.push(s);return r}},function(e,t){e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},function(e,t,r){var n=r(144),o=r(149);e.exports=function(e){return n(function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var c=r[n];c&&e(t,c,n,a)}return t})}},function(e,t,r){var n=r(56),o=r(57),i=r(58);e.exports=function(e,t){return i(o(e,t,n),e+"")}},function(e,t){e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},function(e,t,r){var n=r(147),o=r(48),i=r(56),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i;e.exports=a},function(e,t){e.exports=function(e){return function(){return e}}},function(e,t){var r=Date.now;e.exports=function(e){var t=0,n=0;return function(){var o=r(),i=16-(o-n);if(n=o,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}},function(e,t,r){var n=r(26),o=r(39),i=r(31),a=r(13);e.exports=function(e,t,r){if(!a(r))return!1;var s=typeof t;return!!("number"==s?o(r)&&i(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},function(e,t){"undefined"!=typeof window&&(window.requestAnimationFrame||(window.requestAnimationFrame=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)})),"function"!=typeof Math.imul&&(Math.imul=function(e,t){var r=65535&e,n=65535&t;return r*n+((e>>>16&65535)*n+r*(t>>>16&65535)<<16>>>0)|0}),"function"!=typeof Object.assign&&(Object.assign=function(e){"use strict";if(null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),r=1;r<arguments.length;r++){var n=arguments[r];if(null!==n)for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t})},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e){var t=new Float32Array(2);return t[0]=e[0],t[1]=e[1],t}},function(e,t){e.exports=function(e,t){var r=new Float32Array(2);return r[0]=e,r[1]=t,r}},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e}},function(e,t){e.exports=function(e,t,r){return e[0]=t,e[1]=r,e}},function(e,t,r){e.exports=function(e,t){var r=e[0],o=e[1],i=t[0],a=t[1];return Math.abs(r-i)<=n*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(o-a)<=n*Math.max(1,Math.abs(o),Math.abs(a))};var n=r(61)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}},function(e,t,r){e.exports=r(63)},function(e,t,r){e.exports=r(64)},function(e,t,r){e.exports=r(65)},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e}},function(e,t){e.exports=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}},function(e,t){e.exports=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}},function(e,t){e.exports=function(e,t,r){var n=Math.cos(r),o=Math.sin(r),i=t[0],a=t[1];return e[0]=i*n-a*o,e[1]=i*o+a*n,e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}},function(e,t){e.exports=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}},function(e,t,r){e.exports=r(66)},function(e,t,r){e.exports=r(67)},function(e,t,r){e.exports=r(68)},function(e,t,r){e.exports=r(69)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e}},function(e,t){e.exports=function(e,t){var r=t[0],n=t[1],o=r*r+n*n;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o),e}},function(e,t){e.exports=function(e,t){return e[0]*t[0]+e[1]*t[1]}},function(e,t){e.exports=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e}},function(e,t){e.exports=function(e,t,r,n){var o=t[0],i=t[1];return e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i),e}},function(e,t){e.exports=function(e,t){t=t||1;var r=2*Math.random()*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1];return e[0]=r[0]*n+r[2]*o,e[1]=r[1]*n+r[3]*o,e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1];return e[0]=r[0]*n+r[2]*o+r[4],e[1]=r[1]*n+r[3]*o+r[5],e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1];return e[0]=r[0]*n+r[3]*o+r[6],e[1]=r[1]*n+r[4]*o+r[7],e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1];return e[0]=r[0]*n+r[4]*o+r[12],e[1]=r[1]*n+r[5]*o+r[13],e}},function(e,t,r){e.exports=function(e,t,r,o,i,a){var s,c;for(t||(t=2),r||(r=0),c=o?Math.min(o*t+r,e.length):e.length,s=r;s<c;s+=t)n[0]=e[s],n[1]=e[s+1],i(n,n,a),e[s]=n[0],e[s+1]=n[1];return e};var n=r(62)()},function(e,t){e.exports=function(e,t,r){var n=t[0]*t[0]+t[1]*t[1];if(n>r*r){var o=Math.sqrt(n);e[0]=t[0]/o*r,e[1]=t[1]/o*r}else e[0]=t[0],e[1]=t[1];return e}},function(e,t){e.exports=function(e){var t=new Float32Array(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(e,t,r){e.exports=function(e,t){var r=n(e[0],e[1],e[2]),a=n(t[0],t[1],t[2]);o(r,r),o(a,a);var s=i(r,a);return s>1?0:Math.acos(s)};var n=r(72),o=r(73),i=r(74)},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}},function(e,t){e.exports=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}},function(e,t,r){e.exports=function(e,t){var r=e[0],o=e[1],i=e[2],a=t[0],s=t[1],c=t[2];return Math.abs(r-a)<=n*Math.max(1,Math.abs(r),Math.abs(a))&&Math.abs(o-s)<=n*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-c)<=n*Math.max(1,Math.abs(i),Math.abs(c))};var n=r(70)},function(e,t){e.exports=function(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}},function(e,t,r){e.exports=r(75)},function(e,t,r){e.exports=r(76)},function(e,t,r){e.exports=r(77)},function(e,t){e.exports=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e}},function(e,t){e.exports=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.floor(t[0]),e[1]=Math.floor(t[1]),e[2]=Math.floor(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.ceil(t[0]),e[1]=Math.ceil(t[1]),e[2]=Math.ceil(t[2]),e}},function(e,t){e.exports=function(e,t){return e[0]=Math.round(t[0]),e[1]=Math.round(t[1]),e[2]=Math.round(t[2]),e}},function(e,t){e.exports=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}},function(e,t){e.exports=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}},function(e,t,r){e.exports=r(78)},function(e,t,r){e.exports=r(79)},function(e,t,r){e.exports=r(80)},function(e,t,r){e.exports=r(81)},function(e,t){e.exports=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}},function(e,t){e.exports=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=r[0],s=r[1],c=r[2];return e[0]=o*c-i*s,e[1]=i*a-n*c,e[2]=n*s-o*a,e}},function(e,t){e.exports=function(e,t,r,n){var o=t[0],i=t[1],a=t[2];return e[0]=o+n*(r[0]-o),e[1]=i+n*(r[1]-i),e[2]=a+n*(r[2]-a),e}},function(e,t){e.exports=function(e,t){t=t||1;var r=2*Math.random()*Math.PI,n=2*Math.random()-1,o=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*o,e[1]=Math.sin(r)*o,e[2]=n*t,e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=r[3]*n+r[7]*o+r[11]*i+r[15];return a=a||1,e[0]=(r[0]*n+r[4]*o+r[8]*i+r[12])/a,e[1]=(r[1]*n+r[5]*o+r[9]*i+r[13])/a,e[2]=(r[2]*n+r[6]*o+r[10]*i+r[14])/a,e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2];return e[0]=n*r[0]+o*r[3]+i*r[6],e[1]=n*r[1]+o*r[4]+i*r[7],e[2]=n*r[2]+o*r[5]+i*r[8],e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=r[0],s=r[1],c=r[2],u=r[3],l=u*n+s*i-c*o,d=u*o+c*n-a*i,f=u*i+a*o-s*n,h=-a*n-s*o-c*i;return e[0]=l*u+h*-a+d*-c-f*-s,e[1]=d*u+h*-s+f*-a-l*-c,e[2]=f*u+h*-c+l*-s-d*-a,e}},function(e,t){e.exports=function(e,t,r,n){var o=r[1],i=r[2],a=t[1]-o,s=t[2]-i,c=Math.sin(n),u=Math.cos(n);return e[0]=t[0],e[1]=o+a*u-s*c,e[2]=i+a*c+s*u,e}},function(e,t){e.exports=function(e,t,r,n){var o=r[0],i=r[2],a=t[0]-o,s=t[2]-i,c=Math.sin(n),u=Math.cos(n);return e[0]=o+s*c+a*u,e[1]=t[1],e[2]=i+s*u-a*c,e}},function(e,t){e.exports=function(e,t,r,n){var o=r[0],i=r[1],a=t[0]-o,s=t[1]-i,c=Math.sin(n),u=Math.cos(n);return e[0]=o+a*u-s*c,e[1]=i+a*c+s*u,e[2]=t[2],e}},function(e,t,r){e.exports=function(e,t,r,o,i,a){var s,c;for(t||(t=3),r||(r=0),c=o?Math.min(o*t+r,e.length):e.length,s=r;s<c;s+=t)n[0]=e[s],n[1]=e[s+1],n[2]=e[s+2],i(n,n,a),e[s]=n[0],e[s+1]=n[1],e[s+2]=n[2];return e};var n=r(71)()},function(e,t){function r(t,n){return e.exports=r=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},r(t,n)}e.exports=r},function(e,t,r){var n=r(60);e.exports=function(e){if(Array.isArray(e))return n(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,r){var n=r(2);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=n(e)););return e}},function(e,t,r){var n=function(e){"use strict";var t,r=Object.prototype,n=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",s=o.toStringTag||"@@toStringTag";function c(e,t,r,n){var o=t&&t.prototype instanceof g?t:g,i=Object.create(o.prototype),a=new O(n||[]);return i._invoke=function(e,t,r){var n=l;return function(o,i){if(n===f)throw new Error("Generator is already running");if(n===h){if("throw"===o)throw i;return A()}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var s=x(a,r);if(s){if(s===p)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(n===l)throw n=h,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n=f;var c=u(e,t,r);if("normal"===c.type){if(n=r.done?h:d,c.arg===p)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n=h,r.method="throw",r.arg=c.arg)}}}(e,r,a),i}function u(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}e.wrap=c;var l="suspendedStart",d="suspendedYield",f="executing",h="completed",p={};function g(){}function m(){}function y(){}var v={};v[i]=function(){return this};var b=Object.getPrototypeOf,w=b&&b(b(T([])));w&&w!==r&&n.call(w,i)&&(v=w);var _=y.prototype=g.prototype=Object.create(v);function S(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function R(e,t){var r;this._invoke=function(o,i){function a(){return new t(function(r,a){!function r(o,i,a,s){var c=u(e[o],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==typeof d&&n.call(d,"__await")?t.resolve(d.__await).then(function(e){r("next",e,a,s)},function(e){r("throw",e,a,s)}):t.resolve(d).then(function(e){l.value=e,a(l)},function(e){return r("throw",e,a,s)})}s(c.arg)}(o,i,r,a)})}return r=r?r.then(a,a):a()}}function x(e,r){var n=e.iterator[r.method];if(n===t){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=t,x(e,r),"throw"===r.method))return p;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return p}var o=u(n,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,p;var i=o.arg;return i?i.done?(r[e.resultName]=i.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,p):i:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,p)}function E(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function O(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(E,this),this.reset(!0)}function T(e){if(e){var r=e[i];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,a=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}return{next:A}}function A(){return{value:t,done:!0}}return m.prototype=_.constructor=y,y.constructor=m,y[s]=m.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===m||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,y):(e.__proto__=y,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(_),e},e.awrap=function(e){return{__await:e}},S(R.prototype),R.prototype[a]=function(){return this},e.AsyncIterator=R,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new R(c(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then(function(e){return e.done?e.value:a.next()})},S(_),_[s]="Generator",_[i]=function(){return this},_.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var r in e)t.push(r);return t.reverse(),function r(){for(;t.length;){var n=t.pop();if(n in e)return r.value=n,r.done=!1,r}return r.done=!0,r}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(C),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return s.type="throw",s.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],s=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var c=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=e,a.arg=t,i?(this.method="next",this.next=i.finallyLoc,p):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),p},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),C(r),p}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var n=r.completion;if("throw"===n.type){var o=n.arg;C(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),p}},e}(e.exports);try{regeneratorRuntime=n}catch(e){Function("r","regeneratorRuntime = r")(n)}},function(e,t,r){var n=r(229),o=r(239);e.exports=function(e,t){return n(e,t,function(t,r){return o(e,r)})}},function(e,t,r){var n=r(230),o=r(238),i=r(32);e.exports=function(e,t,r){for(var a=-1,s=t.length,c={};++a<s;){var u=t[a],l=n(e,u);r(l,u)&&o(c,i(u,e),l)}return c}},function(e,t,r){var n=r(32),o=r(42);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[o(t[r++])];return r&&r==i?e:void 0}},function(e,t,r){var n=r(14),o=r(41),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||a.test(e)||!i.test(e)||null!=t&&e in Object(t)}},function(e,t,r){var n=r(233),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,function(e,r,n,o){t.push(n?o.replace(i,"$1"):r||e)}),t});e.exports=a},function(e,t,r){var n=r(234);e.exports=function(e){var t=n(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}},function(e,t,r){var n=r(46),o="Expected a function";function i(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(o);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(i.Cache||n),r}i.Cache=n,e.exports=i},function(e,t,r){var n=r(236);e.exports=function(e){return null==e?"":n(e)}},function(e,t,r){var n=r(27),o=r(237),i=r(14),a=r(41),s=n?n.prototype:void 0,c=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},function(e,t,r){var n=r(54),o=r(32),i=r(31),a=r(13),s=r(42);e.exports=function(e,t,r,c){if(!a(e))return e;for(var u=-1,l=(t=o(t,e)).length,d=l-1,f=e;null!=f&&++u<l;){var h=s(t[u]),p=r;if("__proto__"===h||"constructor"===h||"prototype"===h)return e;if(u!=d){var g=f[h];void 0===(p=c?c(g,h,f):void 0)&&(p=a(g)?g:i(t[u+1])?[]:{})}n(f,h,p),f=f[h]}return e}},function(e,t,r){var n=r(240),o=r(241);e.exports=function(e,t){return null!=e&&o(e,t,n)}},function(e,t){e.exports=function(e,t){return null!=e&&t in Object(e)}},function(e,t,r){var n=r(32),o=r(30),i=r(14),a=r(31),s=r(40),c=r(42);e.exports=function(e,t,r){for(var u=-1,l=(t=n(t,e)).length,d=!1;++u<l;){var f=c(t[u]);if(!(d=null!=e&&r(e,f)))break;e=e[f]}return d||++u!=l?d:!!(l=null==e?0:e.length)&&s(l)&&a(f,l)&&(i(e)||o(e))}},function(e,t,r){var n=r(243),o=r(57),i=r(58);e.exports=function(e){return i(o(e,void 0,n),e+"")}},function(e,t,r){var n=r(244);e.exports=function(e){return null!=e&&e.length?n(e,1):[]}},function(e,t,r){var n=r(245),o=r(246);e.exports=function e(t,r,i,a,s){var c=-1,u=t.length;for(i||(i=o),s||(s=[]);++c<u;){var l=t[c];r>0&&i(l)?r>1?e(l,r-1,i,a,s):n(s,l):a||(s[s.length]=l)}return s}},function(e,t){e.exports=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},function(e,t,r){var n=r(27),o=r(30),i=r(14),a=n?n.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(a&&e&&e[a])}},function(e,t){e.exports=function(e){return e[0]*e[3]-e[2]*e[1]}},function(e,t){e.exports=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=r[0],c=r[1],u=r[2],l=r[3];return e[0]=n*s+i*c,e[1]=o*s+a*c,e[2]=n*u+i*l,e[3]=o*u+a*l,e}},function(e,t){e.exports=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}},function(e,t){e.exports=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=Math.sin(r),c=Math.cos(r);return e[0]=n*c+i*s,e[1]=o*c+a*s,e[2]=n*-s+i*c,e[3]=o*-s+a*c,e}},function(e,t){e.exports=function(e,t){var r=t[0],n=t[1],o=t[2],i=t[3],a=r*i-o*n;return a?(a=1/a,e[0]=i*a,e[1]=-n*a,e[2]=-o*a,e[3]=r*a,e):null}},function(e,t){e.exports=function(){var e=new Float32Array(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e}},function(e,t){e.exports=function(e,t,r){var n=t[0],o=t[1],i=t[2],a=t[3],s=r[0],c=r[1];return e[0]=n*s,e[1]=o*s,e[2]=i*c,e[3]=a*c,e}},function(e,t){e.exports=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}},function(e,t){e.exports=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))}},function(e,t){e.exports=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]}},function(e,t,r){"use strict";r.r(t),r.d(t,"BarcodeDecoder",function(){return be}),r.d(t,"BarcodeReader",function(){return A}),r.d(t,"CameraAccess",function(){return qe}),r.d(t,"ImageDebug",function(){return h.a}),r.d(t,"ImageWrapper",function(){return s.a}),r.d(t,"ResultCollector",function(){return je});var n=r(19),o=r.n(n),i=r(15),a=r.n(i),s=(r(150),r(11)),c={},u=1,l=-1;c.getBarcodeLine=function(e,t,r){var n,o,i,a,s,c=0|t.x,u=0|t.y,l=0|r.x,d=0|r.y,f=Math.abs(d-u)>Math.abs(l-c),h=[],p=e.data,g=e.size.x,m=255,y=0;function v(e,t){s=p[t*g+e],m=s<m?s:m,y=s>y?s:y,h.push(s)}f&&(i=c,c=u,u=i,i=l,l=d,d=i),c>l&&(i=c,c=l,l=i,i=u,u=d,d=i);var b=l-c,w=Math.abs(d-u);n=b/2|0,o=u;var _=u<d?1:-1;for(a=c;a<l;a++)f?v(o,a):v(a,o),(n-=w)<0&&(o+=_,n+=b);return{line:h,min:m,max:y}},c.toBinaryLine=function(e){var t,r,n,o,i,a,s=e.min,c=e.max,d=e.line,f=s+(c-s)/2,h=[],p=(c-s)/12,g=-p;for(n=d[0]>f?u:l,h.push({pos:0,val:d[0]}),i=0;i<d.length-2;i++)n!==(o=(t=d[i+1]-d[i])+(r=d[i+2]-d[i+1])<g&&d[i+1]<1.5*f?l:t+r>p&&d[i+1]>.5*f?u:n)&&(h.push({pos:i,val:d[i]}),n=o);for(h.push({pos:d.length,val:d[d.length-1]}),a=h[0].pos;a<h[1].pos;a++)d[a]=d[a]>f?0:1;for(i=1;i<h.length-1;i++)for(p=h[i+1].val>h[i].val?h[i].val+(h[i+1].val-h[i].val)/3*2|0:h[i+1].val+(h[i].val-h[i+1].val)/3|0,a=h[i].pos;a<h[i+1].pos;a++)d[a]=d[a]>p?0:1;return{line:d,threshold:p}},c.debug={printFrequency:function(e,t){var r,n=t.getContext("2d");for(t.width=e.length,t.height=256,n.beginPath(),n.strokeStyle="blue",r=0;r<e.length;r++)n.moveTo(r,255),n.lineTo(r,255-e[r]);n.stroke(),n.closePath()},printPattern:function(e,t){var r,n=t.getContext("2d");for(t.width=e.length,n.fillColor="black",r=0;r<e.length;r++)1===e[r]&&n.fillRect(r,0,1,100)}};var d,f=c,h=r(9),p=r(3),g=r.n(p),m=r(4),y=r.n(m),v=r(1),b=r.n(v),w=r(6),_=r.n(w),S=r(5),R=r.n(S),x=r(2),E=r.n(x),C=r(0),O=r.n(C),T=r(10);!function(e){e[e.Forward=1]="Forward",e[e.Reverse=-1]="Reverse"}(d||(d={}));var A=function(){function e(t,r){return g()(this,e),O()(this,"_row",[]),O()(this,"config",{}),O()(this,"supplements",[]),O()(this,"SINGLE_CODE_ERROR",0),O()(this,"FORMAT","unknown"),O()(this,"CONFIG_KEYS",{}),this._row=[],this.config=t||{},r&&(this.supplements=r),this}return y()(e,[{key:"_nextUnset",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t<e.length;t++)if(!e[t])return t;return e.length}},{key:"_matchPattern",value:function(e,t,r){var n,o=0,i=0,a=0,s=0,c=0,u=0;r=r||this.SINGLE_CODE_ERROR||1;for(var l=0;l<e.length;l++)a+=e[l],s+=t[l];if(a<s)return Number.MAX_VALUE;r*=n=a/s;for(var d=0;d<e.length;d++){if(c=e[d],u=t[d]*n,(i=Math.abs(c-u)/u)>r)return Number.MAX_VALUE;o+=i}return o/s}},{key:"_nextSet",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;t<e.length;t++)if(e[t])return t;return e.length}},{key:"_correctBars",value:function(e,t,r){for(var n=r.length,o=0;n--;)(o=e[r[n]]*(1-(1-t)/2))>1&&(e[r[n]]=o)}},{key:"decodePattern",value:function(e){this._row=e;var t=this._decode();return null===t?(this._row.reverse(),(t=this._decode())&&(t.direction=d.Reverse,t.start=this._row.length-t.start,t.end=this._row.length-t.end)):t.direction=d.Forward,t&&(t.format=this.FORMAT),t}},{key:"_matchRange",value:function(e,t,r){var n;for(n=e=e<0?0:e;n<t;n++)if(this._row[n]!==r)return!1;return!0}},{key:"_fillCounters",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._nextUnset(this._row),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._row.length,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=[],o=0;n[o]=0;for(var i=e;i<t;i++)this._row[i]^(r?1:0)?n[o]++:(n[++o]=1,r=!r);return n}},{key:"_toCounters",value:function(e,t){var r=t.length,n=this._row.length,o=!this._row[e],i=0;T.a.init(t,0);for(var a=e;a<n;a++)if(this._row[a]^(o?1:0))t[i]++;else{if(++i===r)break;t[i]=1,o=!o}return t}}],[{key:"Exception",get:function(){return{StartNotFoundException:"Start-Info was not found!",CodeNotFoundException:"Code could not be found!",PatternNotFoundException:"Pattern could not be found!"}}}]),e}();var P=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"CODE_SHIFT",98),O()(b()(e),"CODE_C",99),O()(b()(e),"CODE_B",100),O()(b()(e),"CODE_A",101),O()(b()(e),"START_CODE_A",103),O()(b()(e),"START_CODE_B",104),O()(b()(e),"START_CODE_C",105),O()(b()(e),"STOP_CODE",106),O()(b()(e),"CODE_PATTERN",[[2,1,2,2,2,2],[2,2,2,1,2,2],[2,2,2,2,2,1],[1,2,1,2,2,3],[1,2,1,3,2,2],[1,3,1,2,2,2],[1,2,2,2,1,3],[1,2,2,3,1,2],[1,3,2,2,1,2],[2,2,1,2,1,3],[2,2,1,3,1,2],[2,3,1,2,1,2],[1,1,2,2,3,2],[1,2,2,1,3,2],[1,2,2,2,3,1],[1,1,3,2,2,2],[1,2,3,1,2,2],[1,2,3,2,2,1],[2,2,3,2,1,1],[2,2,1,1,3,2],[2,2,1,2,3,1],[2,1,3,2,1,2],[2,2,3,1,1,2],[3,1,2,1,3,1],[3,1,1,2,2,2],[3,2,1,1,2,2],[3,2,1,2,2,1],[3,1,2,2,1,2],[3,2,2,1,1,2],[3,2,2,2,1,1],[2,1,2,1,2,3],[2,1,2,3,2,1],[2,3,2,1,2,1],[1,1,1,3,2,3],[1,3,1,1,2,3],[1,3,1,3,2,1],[1,1,2,3,1,3],[1,3,2,1,1,3],[1,3,2,3,1,1],[2,1,1,3,1,3],[2,3,1,1,1,3],[2,3,1,3,1,1],[1,1,2,1,3,3],[1,1,2,3,3,1],[1,3,2,1,3,1],[1,1,3,1,2,3],[1,1,3,3,2,1],[1,3,3,1,2,1],[3,1,3,1,2,1],[2,1,1,3,3,1],[2,3,1,1,3,1],[2,1,3,1,1,3],[2,1,3,3,1,1],[2,1,3,1,3,1],[3,1,1,1,2,3],[3,1,1,3,2,1],[3,3,1,1,2,1],[3,1,2,1,1,3],[3,1,2,3,1,1],[3,3,2,1,1,1],[3,1,4,1,1,1],[2,2,1,4,1,1],[4,3,1,1,1,1],[1,1,1,2,2,4],[1,1,1,4,2,2],[1,2,1,1,2,4],[1,2,1,4,2,1],[1,4,1,1,2,2],[1,4,1,2,2,1],[1,1,2,2,1,4],[1,1,2,4,1,2],[1,2,2,1,1,4],[1,2,2,4,1,1],[1,4,2,1,1,2],[1,4,2,2,1,1],[2,4,1,2,1,1],[2,2,1,1,1,4],[4,1,3,1,1,1],[2,4,1,1,1,2],[1,3,4,1,1,1],[1,1,1,2,4,2],[1,2,1,1,4,2],[1,2,1,2,4,1],[1,1,4,2,1,2],[1,2,4,1,1,2],[1,2,4,2,1,1],[4,1,1,2,1,2],[4,2,1,1,1,2],[4,2,1,2,1,1],[2,1,2,1,4,1],[2,1,4,1,2,1],[4,1,2,1,2,1],[1,1,1,1,4,3],[1,1,1,3,4,1],[1,3,1,1,4,1],[1,1,4,1,1,3],[1,1,4,3,1,1],[4,1,1,1,1,3],[4,1,1,3,1,1],[1,1,3,1,4,1],[1,1,4,1,3,1],[3,1,1,1,4,1],[4,1,1,1,3,1],[2,1,1,4,1,2],[2,1,1,2,1,4],[2,1,1,2,3,2],[2,3,3,1,1,1,2]]),O()(b()(e),"SINGLE_CODE_ERROR",.64),O()(b()(e),"AVG_CODE_ERROR",.3),O()(b()(e),"FORMAT","code_128"),O()(b()(e),"MODULE_INDICES",{bar:[0,2,4],space:[1,3,5]}),e}return y()(r,[{key:"_decodeCode",value:function(e,t){for(var r={error:Number.MAX_VALUE,code:-1,start:e,end:e,correction:{bar:1,space:1}},n=[0,0,0,0,0,0],o=e,i=!this._row[o],a=0,s=o;s<this._row.length;s++)if(this._row[s]^(i?1:0))n[a]++;else{if(a===n.length-1){t&&this._correct(n,t);for(var c=0;c<this.CODE_PATTERN.length;c++){var u=this._matchPattern(n,this.CODE_PATTERN[c]);u<r.error&&(r.code=c,r.error=u)}return r.end=s,-1===r.code||r.error>this.AVG_CODE_ERROR?null:(this.CODE_PATTERN[r.code]&&(r.correction.bar=this.calculateCorrection(this.CODE_PATTERN[r.code],n,this.MODULE_INDICES.bar),r.correction.space=this.calculateCorrection(this.CODE_PATTERN[r.code],n,this.MODULE_INDICES.space)),r)}n[++a]=1,i=!i}return null}},{key:"_correct",value:function(e,t){this._correctBars(e,t.bar,this.MODULE_INDICES.bar),this._correctBars(e,t.space,this.MODULE_INDICES.space)}},{key:"_findStart",value:function(){for(var e=[0,0,0,0,0,0],t=this._nextSet(this._row),r={error:Number.MAX_VALUE,code:-1,start:0,end:0,correction:{bar:1,space:1}},n=!1,o=0,i=t;i<this._row.length;i++)if(this._row[i]^(n?1:0))e[o]++;else{if(o===e.length-1){for(var a=e.reduce(function(e,t){return e+t},0),s=this.START_CODE_A;s<=this.START_CODE_C;s++){var c=this._matchPattern(e,this.CODE_PATTERN[s]);c<r.error&&(r.code=s,r.error=c)}if(r.error<this.AVG_CODE_ERROR)return r.start=i-a,r.end=i,r.correction.bar=this.calculateCorrection(this.CODE_PATTERN[r.code],e,this.MODULE_INDICES.bar),r.correction.space=this.calculateCorrection(this.CODE_PATTERN[r.code],e,this.MODULE_INDICES.space),r;for(var u=0;u<4;u++)e[u]=e[u+2];e[4]=0,e[5]=0,o--}else o++;e[o]=1,n=!n}return null}},{key:"_decode",value:function(e,t){var r=this,n=this._findStart();if(null===n)return null;var o={code:n.code,start:n.start,end:n.end,correction:{bar:n.correction.bar,space:n.correction.space}},i=[];i.push(o);for(var a=o.code,s=function(e){switch(o.code){case r.START_CODE_A:return r.CODE_A;case r.START_CODE_B:return r.CODE_B;case r.START_CODE_C:return r.CODE_C;default:return null}}(),c=!1,u=!1,l=u,d=!0,f=0,h=[],p=[];!c;){if(l=u,u=!1,null!==(o=this._decodeCode(o.end,o.correction)))switch(o.code!==this.STOP_CODE&&(d=!0),o.code!==this.STOP_CODE&&(h.push(o.code),a+=++f*o.code),i.push(o),s){case this.CODE_A:if(o.code<64)p.push(String.fromCharCode(32+o.code));else if(o.code<96)p.push(String.fromCharCode(o.code-64));else switch(o.code!==this.STOP_CODE&&(d=!1),o.code){case this.CODE_SHIFT:u=!0,s=this.CODE_B;break;case this.CODE_B:s=this.CODE_B;break;case this.CODE_C:s=this.CODE_C;break;case this.STOP_CODE:c=!0}break;case this.CODE_B:if(o.code<96)p.push(String.fromCharCode(32+o.code));else switch(o.code!==this.STOP_CODE&&(d=!1),o.code){case this.CODE_SHIFT:u=!0,s=this.CODE_A;break;case this.CODE_A:s=this.CODE_A;break;case this.CODE_C:s=this.CODE_C;break;case this.STOP_CODE:c=!0}break;case this.CODE_C:if(o.code<100)p.push(o.code<10?"0"+o.code:o.code);else switch(o.code!==this.STOP_CODE&&(d=!1),o.code){case this.CODE_A:s=this.CODE_A;break;case this.CODE_B:s=this.CODE_B;break;case this.STOP_CODE:c=!0}}else c=!0;l&&(s=s===this.CODE_A?this.CODE_B:this.CODE_A)}return null===o?null:(o.end=this._nextUnset(this._row,o.end),this._verifyTrailingWhitespace(o)?(a-=f*h[h.length-1])%103!==h[h.length-1]?null:p.length?(d&&p.splice(p.length-1,1),{code:p.join(""),start:n.start,end:o.end,codeset:s,startInfo:n,decodedCodes:i,endInfo:o,format:this.FORMAT}):null:null)}},{key:"_verifyTrailingWhitespace",value:function(e){var t;return(t=e.end+(e.end-e.start)/2)<this._row.length&&this._matchRange(e.end,t,0)?e:null}},{key:"calculateCorrection",value:function(e,t,r){for(var n=r.length,o=0,i=0;n--;)i+=e[r[n]],o+=t[r[n]];return i/o}}]),r}(A);function D(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function I(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?D(Object(r),!0).forEach(function(t){O()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):D(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var k=[1,1,1],M=[1,1,1,1,1],L=[1,1,2],q=[[3,2,1,1],[2,2,2,1],[2,1,2,2],[1,4,1,1],[1,1,3,2],[1,2,3,1],[1,1,1,4],[1,3,1,2],[1,2,1,3],[3,1,1,2],[1,1,2,3],[1,2,2,2],[2,2,1,2],[1,1,4,1],[2,3,1,1],[1,3,2,1],[4,1,1,1],[2,1,3,1],[3,1,2,1],[2,1,1,3]],j=[0,11,13,14,19,25,28,21,22,26],N=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(e,n){var o;return g()(this,r),o=t.call(this,a()({supplements:[]},e),n),O()(b()(o),"FORMAT","ean_13"),O()(b()(o),"SINGLE_CODE_ERROR",.7),O()(b()(o),"STOP_PATTERN",[1,1,1]),o}return y()(r,[{key:"_findPattern",value:function(e,t,r,n){var o=new Array(e.length).fill(0),i={error:Number.MAX_VALUE,start:0,end:0},a=0;t||(t=this._nextSet(this._row));for(var s=!1,c=t;c<this._row.length;c++)if(this._row[c]^(r?1:0))o[a]+=1;else{if(a===o.length-1){var u=this._matchPattern(o,e);if(u<.48&&i.error&&u<i.error)return s=!0,i.error=u,i.start=c-o.reduce(function(e,t){return e+t},0),i.end=c,i;if(n){for(var l=0;l<o.length-2;l++)o[l]=o[l+2];o[o.length-2]=0,o[o.length-1]=0,a--}}else a++;o[a]=1,r=!r}return s?i:null}},{key:"_decodeCode",value:function(e,t){var r=[0,0,0,0],n=e,o={error:Number.MAX_VALUE,code:-1,start:e,end:e},i=!this._row[n],a=0;t||(t=q.length);for(var s=n;s<this._row.length;s++)if(this._row[s]^(i?1:0))r[a]++;else{if(a===r.length-1){for(var c=0;c<t;c++){var u=this._matchPattern(r,q[c]);o.end=s,u<o.error&&(o.code=c,o.error=u)}return o.error>.48?null:o}r[++a]=1,i=!i}return null}},{key:"_findStart",value:function(){for(var e=this._nextSet(this._row),t=null;!t;){if(!(t=this._findPattern(k,e,!1,!0)))return null;var r=t.start-(t.end-t.start);if(r>=0&&this._matchRange(r,t.start,0))return t;e=t.end,t=null}return null}},{key:"_calculateFirstDigit",value:function(e){for(var t=0;t<j.length;t++)if(e===j[t])return t;return null}},{key:"_decodePayload",value:function(e,t,r){for(var n=I({},e),o=0,i=0;i<6;i++){if(!(n=this._decodeCode(n.end)))return null;n.code>=10?(n.code-=10,o|=1<<5-i):o|=0<<5-i,t.push(n.code),r.push(n)}var a=this._calculateFirstDigit(o);if(null===a)return null;t.unshift(a);var s=this._findPattern(M,n.end,!0,!1);if(null===s||!s.end)return null;r.push(s);for(var c=0;c<6;c++){if(!(s=this._decodeCode(s.end,10)))return null;r.push(s),t.push(s.code)}return s}},{key:"_verifyTrailingWhitespace",value:function(e){var t=e.end+(e.end-e.start);return t<this._row.length&&this._matchRange(e.end,t,0)?e:null}},{key:"_findEnd",value:function(e,t){var r=this._findPattern(this.STOP_PATTERN,e,t,!1);return null!==r?this._verifyTrailingWhitespace(r):null}},{key:"_checksum",value:function(e){for(var t=0,r=e.length-2;r>=0;r-=2)t+=e[r];t*=3;for(var n=e.length-1;n>=0;n-=2)t+=e[n];return t%10==0}},{key:"_decodeExtensions",value:function(e){var t=this._nextSet(this._row,e),r=this._findPattern(L,t,!1,!1);if(null===r)return null;for(var n=0;n<this.supplements.length;n++)try{var o=this.supplements[n]._decode(this._row,r.end);if(null!==o)return{code:o.code,start:t,startInfo:r,end:o.end,decodedCodes:o.decodedCodes,format:this.supplements[n].FORMAT}}catch(e){console.error("* decodeExtensions error in ",this.supplements[n],": ",e)}return null}},{key:"_decode",value:function(e,t){var r=new Array,n=new Array,o={},i=this._findStart();if(!i)return null;var a={start:i.start,end:i.end};if(n.push(a),!(a=this._decodePayload(a,r,n)))return null;if(!(a=this._findEnd(a.end,!1)))return null;if(n.push(a),!this._checksum(r))return null;if(this.supplements.length>0){var s=this._decodeExtensions(a.end);if(!s)return null;if(!s.decodedCodes)return null;var c=s.decodedCodes[s.decodedCodes.length-1],u={start:c.start+((c.end-c.start)/2|0),end:c.end};if(!this._verifyTrailingWhitespace(u))return null;o={supplement:s,code:r.join("")+s.code}}return I(I({code:r.join(""),start:i.start,end:a.end,startInfo:i,decodedCodes:n},o),{},{format:this.FORMAT})}}]),r}(A),W=r(33),U=r.n(W);var B=new Uint16Array(U()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. *$/+%").map(function(e){return e.charCodeAt(0)})),z=new Uint16Array([52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,148,168,162,138,42]),F=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","code_39"),e}return y()(r,[{key:"_findStart",value:function(){for(var e=this._nextSet(this._row),t=e,r=new Uint16Array([0,0,0,0,0,0,0,0,0]),n=0,o=!1,i=e;i<this._row.length;i++)if(this._row[i]^(o?1:0))r[n]++;else{if(n===r.length-1){if(148===this._toPattern(r)){var a=Math.floor(Math.max(0,t-(i-t)/4));if(this._matchRange(a,t,0))return{start:t,end:i}}t+=r[0]+r[1];for(var s=0;s<7;s++)r[s]=r[s+2];r[7]=0,r[8]=0,n--}else n++;r[n]=1,o=!o}return null}},{key:"_toPattern",value:function(e){for(var t=e.length,r=0,n=t,o=0;n>3;){r=this._findNextWidth(e,r),n=0;for(var i=0,a=0;a<t;a++)e[a]>r&&(i|=1<<t-1-a,n++,o+=e[a]);if(3===n){for(var s=0;s<t&&n>0;s++)if(e[s]>r&&(n--,2*e[s]>=o))return-1;return i}}return-1}},{key:"_findNextWidth",value:function(e,t){for(var r=Number.MAX_VALUE,n=0;n<e.length;n++)e[n]<r&&e[n]>t&&(r=e[n]);return r}},{key:"_patternToChar",value:function(e){for(var t=0;t<z.length;t++)if(z[t]===e)return String.fromCharCode(B[t]);return null}},{key:"_verifyTrailingWhitespace",value:function(e,t,r){var n=T.a.sum(r);return 3*(t-e-n)>=n}},{key:"_decode",value:function(e,t){var r=new Uint16Array([0,0,0,0,0,0,0,0,0]),n=[];if(!(t=this._findStart()))return null;var o,i,a=this._nextSet(this._row,t.end);do{r=this._toCounters(a,r);var s=this._toPattern(r);if(s<0)return null;if(null===(o=this._patternToChar(s)))return null;n.push(o),i=a,a+=T.a.sum(r),a=this._nextSet(this._row,a)}while("*"!==o);return n.pop(),n.length&&this._verifyTrailingWhitespace(i,a,r)?{code:n.join(""),start:t.start,end:a,startInfo:t,decodedCodes:n,format:this.FORMAT}:null}}]),r}(A),$=r(16),V=r.n($);var G=/[IOQ]/g,H=/[A-Z0-9]{17}/,Y=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","code_39_vin"),e}return y()(r,[{key:"_checkChecksum",value:function(e){return!!e}},{key:"_decode",value:function(e,t){var n=V()(E()(r.prototype),"_decode",this).call(this,e,t);if(!n)return null;var o=n.code;return o?(o=o.replace(G,"")).match(H)?this._checkChecksum(o)?(n.code=o,n):null:(console.log("Failed AZ09 pattern code:",o),null):null}}]),r}(F);var X=[48,49,50,51,52,53,54,55,56,57,45,36,58,47,46,43,65,66,67,68],J=[3,6,9,96,18,66,33,36,48,72,12,24,69,81,84,21,26,41,11,14],Q=[26,41,11,14],Z=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"_counters",[]),O()(b()(e),"FORMAT","codabar"),e}return y()(r,[{key:"_computeAlternatingThreshold",value:function(e,t){for(var r=Number.MAX_VALUE,n=0,o=0,i=e;i<t;i+=2)(o=this._counters[i])>n&&(n=o),o<r&&(r=o);return(r+n)/2|0}},{key:"_toPattern",value:function(e){var t=e+7;if(t>this._counters.length)return-1;for(var r=this._computeAlternatingThreshold(e,t),n=this._computeAlternatingThreshold(e+1,t),o=64,i=0,a=0,s=0;s<7;s++)i=0==(1&s)?r:n,this._counters[e+s]>i&&(a|=o),o>>=1;return a}},{key:"_isStartEnd",value:function(e){for(var t=0;t<Q.length;t++)if(Q[t]===e)return!0;return!1}},{key:"_sumCounters",value:function(e,t){for(var r=0,n=e;n<t;n++)r+=this._counters[n];return r}},{key:"_findStart",value:function(){for(var e=this._nextUnset(this._row),t=1;t<this._counters.length;t++){var r=this._toPattern(t);if(-1!==r&&this._isStartEnd(r))return{start:e+=this._sumCounters(0,t),end:e+this._sumCounters(t,t+8),startCounter:t,endCounter:t+8}}return null}},{key:"_patternToChar",value:function(e){for(var t=0;t<J.length;t++)if(J[t]===e)return String.fromCharCode(X[t]);return null}},{key:"_calculatePatternLength",value:function(e){for(var t=0,r=e;r<e+7;r++)t+=this._counters[r];return t}},{key:"_verifyWhitespace",value:function(e,t){return(e-1<=0||this._counters[e-1]>=this._calculatePatternLength(e)/2)&&(t+8>=this._counters.length||this._counters[t+7]>=this._calculatePatternLength(t)/2)}},{key:"_charToPattern",value:function(e){for(var t=e.charCodeAt(0),r=0;r<X.length;r++)if(X[r]===t)return J[r];return 0}},{key:"_thresholdResultPattern",value:function(e,t){for(var r,n={space:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}},bar:{narrow:{size:0,counts:0,min:0,max:Number.MAX_VALUE},wide:{size:0,counts:0,min:0,max:Number.MAX_VALUE}}},o=t,i=0;i<e.length;i++){r=this._charToPattern(e[i]);for(var a=6;a>=0;a--){var s=2==(1&a)?n.bar:n.space,c=1==(1&r)?s.wide:s.narrow;c.size+=this._counters[o+a],c.counts++,r>>=1}o+=8}return["space","bar"].forEach(function(e){var t=n[e];t.wide.min=Math.floor((t.narrow.size/t.narrow.counts+t.wide.size/t.wide.counts)/2),t.narrow.max=Math.ceil(t.wide.min),t.wide.max=Math.ceil((2*t.wide.size+1.5)/t.wide.counts)}),n}},{key:"_validateResult",value:function(e,t){for(var r,n=this._thresholdResultPattern(e,t),o=t,i=0;i<e.length;i++){r=this._charToPattern(e[i]);for(var a=6;a>=0;a--){var s=0==(1&a)?n.bar:n.space,c=1==(1&r)?s.wide:s.narrow,u=this._counters[o+a];if(u<c.min||u>c.max)return!1;r>>=1}o+=8}return!0}},{key:"_decode",value:function(e,t){if(this._counters=this._fillCounters(),!(t=this._findStart()))return null;var r,n=t.startCounter,o=[];do{if((r=this._toPattern(n))<0)return null;var i=this._patternToChar(r);if(null===i)return null;if(o.push(i),n+=8,o.length>1&&this._isStartEnd(r))break}while(n<this._counters.length);if(o.length-2<4||!this._isStartEnd(r))return null;if(!this._verifyWhitespace(t.startCounter,n-8))return null;if(!this._validateResult(o,t.startCounter))return null;n=n>this._counters.length?this._counters.length:n;var a=t.start+this._sumCounters(t.startCounter,n-8);return{code:o.join(""),start:t.start,end:a,startInfo:t,decodedCodes:o,format:this.FORMAT}}}]),r}(A);var K=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","upc_a"),e}return y()(r,[{key:"_decode",value:function(e,t){var r=N.prototype._decode.call(this);return r&&r.code&&13===r.code.length&&"0"===r.code.charAt(0)?(r.code=r.code.substring(1),r):null}}]),r}(N);var ee=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","ean_8"),e}return y()(r,[{key:"_decodePayload",value:function(e,t,r){for(var n=e,o=0;o<4;o++){if(!(n=this._decodeCode(n.end,10)))return null;t.push(n.code),r.push(n)}if(null===(n=this._findPattern(M,n.end,!0,!1)))return null;r.push(n);for(var i=0;i<4;i++){if(!(n=this._decodeCode(n.end,10)))return null;r.push(n),t.push(n.code)}return n}}]),r}(N);var te=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","ean_2"),e}return y()(r,[{key:"_decode",value:function(e,t){e&&(this._row=e);var r=0,n=t,o=this._row.length,i=[],a=[],s=null;if(void 0===n)return null;for(var c=0;c<2&&n<o;c++){if(!(s=this._decodeCode(n)))return null;a.push(s),i.push(s.code%10),s.code>=10&&(r|=1<<1-c),1!==c&&(n=this._nextSet(this._row,s.end),n=this._nextUnset(this._row,n))}if(2!==i.length||parseInt(i.join(""))%4!==r)return null;var u=this._findStart();return{code:i.join(""),decodedCodes:a,end:s.end,format:this.FORMAT,startInfo:u,start:u.start}}}]),r}(N);var re=[24,20,18,17,12,6,3,10,9,5],ne=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","ean_5"),e}return y()(r,[{key:"_decode",value:function(e,t){if(void 0===t)return null;e&&(this._row=e);for(var r=0,n=t,o=this._row.length,i=null,a=[],s=[],c=0;c<5&&n<o;c++){if(!(i=this._decodeCode(n)))return null;s.push(i),a.push(i.code%10),i.code>=10&&(r|=1<<4-c),4!==c&&(n=this._nextSet(this._row,i.end),n=this._nextUnset(this._row,n))}if(5!==a.length)return null;if(function(e){for(var t=e.length,r=0,n=t-2;n>=0;n-=2)r+=e[n];r*=3;for(var o=t-1;o>=0;o-=2)r+=e[o];return(r*=3)%10}(a)!==function(e){for(var t=0;t<10;t++)if(e===re[t])return t;return null}(r))return null;var u=this._findStart();return{code:a.join(""),decodedCodes:s,end:i.end,format:this.FORMAT,startInfo:u,start:u.start}}}]),r}(N);function oe(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}var ie=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"CODE_FREQUENCY",[[56,52,50,49,44,38,35,42,41,37],[7,11,13,14,19,25,28,21,22,26]]),O()(b()(e),"STOP_PATTERN",[1/6*7,1/6*7,1/6*7,1/6*7,1/6*7,1/6*7]),O()(b()(e),"FORMAT","upc_e"),e}return y()(r,[{key:"_decodePayload",value:function(e,t,r){for(var n=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oe(Object(r),!0).forEach(function(t){O()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oe(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}({},e),o=0,i=0;i<6;i++){if(!(n=this._decodeCode(n.end)))return null;n.code>=10&&(n.code=n.code-10,o|=1<<5-i),t.push(n.code),r.push(n)}return this._determineParity(o,t)?n:null}},{key:"_determineParity",value:function(e,t){for(var r=0;r<this.CODE_FREQUENCY.length;r++)for(var n=0;n<this.CODE_FREQUENCY[r].length;n++)if(e===this.CODE_FREQUENCY[r][n])return t.unshift(r),t.push(n),!0;return!1}},{key:"_convertToUPCA",value:function(e){var t=[e[0]],r=e[e.length-2];return(t=r<=2?t.concat(e.slice(1,3)).concat([r,0,0,0,0]).concat(e.slice(3,6)):3===r?t.concat(e.slice(1,4)).concat([0,0,0,0,0]).concat(e.slice(4,6)):4===r?t.concat(e.slice(1,5)).concat([0,0,0,0,0,e[5]]):t.concat(e.slice(1,6)).concat([0,0,0,0,r])).push(e[e.length-1]),t}},{key:"_checksum",value:function(e){return V()(E()(r.prototype),"_checksum",this).call(this,this._convertToUPCA(e))}},{key:"_findEnd",value:function(e,t){return V()(E()(r.prototype),"_findEnd",this).call(this,e,!0)}},{key:"_verifyTrailingWhitespace",value:function(e){var t=e.end+(e.end-e.start)/2;return t<this._row.length&&this._matchRange(e.end,t,0)?e:null}}]),r}(N);var ae=1,se=3,ce=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(e){var n;return g()(this,r),n=t.call(this,a()({normalizeBarSpaceWidth:!1},e)),O()(b()(n),"barSpaceRatio",[1,1]),O()(b()(n),"SINGLE_CODE_ERROR",.78),O()(b()(n),"AVG_CODE_ERROR",.38),O()(b()(n),"START_PATTERN",[ae,ae,ae,ae]),O()(b()(n),"STOP_PATTERN",[ae,ae,se]),O()(b()(n),"CODE_PATTERN",[[ae,ae,se,se,ae],[se,ae,ae,ae,se],[ae,se,ae,ae,se],[se,se,ae,ae,ae],[ae,ae,se,ae,se],[se,ae,se,ae,ae],[ae,se,se,ae,ae],[ae,ae,ae,se,se],[se,ae,ae,se,ae],[ae,se,ae,se,ae]]),O()(b()(n),"MAX_CORRECTION_FACTOR",5),O()(b()(n),"FORMAT","i2of5"),e.normalizeBarSpaceWidth&&(n.SINGLE_CODE_ERROR=.38,n.AVG_CODE_ERROR=.09),n.config=e,R()(n,b()(n))}return y()(r,[{key:"_matchPattern",value:function(e,t){if(this.config.normalizeBarSpaceWidth){for(var r=[0,0],n=[0,0],o=[0,0],i=this.MAX_CORRECTION_FACTOR,a=1/i,s=0;s<e.length;s++)r[s%2]+=e[s],n[s%2]+=t[s];o[0]=n[0]/r[0],o[1]=n[1]/r[1],o[0]=Math.max(Math.min(o[0],i),a),o[1]=Math.max(Math.min(o[1],i),a),this.barSpaceRatio=o;for(var c=0;c<e.length;c++)e[c]*=this.barSpaceRatio[c%2]}return A.prototype._matchPattern.call(this,e,t)}},{key:"_findPattern",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=new Array(e.length).fill(0),i=0,a={error:Number.MAX_VALUE,code:-1,start:0,end:0},s=this.AVG_CODE_ERROR;r=r||!1,n=n||!1,t||(t=this._nextSet(this._row));for(var c=t;c<this._row.length;c++)if(this._row[c]^(r?1:0))o[i]++;else{if(i===o.length-1){var u=o.reduce(function(e,t){return e+t},0),l=this._matchPattern(o,e);if(l<s)return a.error=l,a.start=c-u,a.end=c,a;if(!n)return null;for(var d=0;d<o.length-2;d++)o[d]=o[d+2];o[o.length-2]=0,o[o.length-1]=0,i--}else i++;o[i]=1,r=!r}return null}},{key:"_findStart",value:function(){for(var e=0,t=this._nextSet(this._row),r=null,n=1;!r;){if(!(r=this._findPattern(this.START_PATTERN,t,!1,!0)))return null;if(n=Math.floor((r.end-r.start)/4),(e=r.start-10*n)>=0&&this._matchRange(e,r.start,0))return r;t=r.end,r=null}return null}},{key:"_verifyTrailingWhitespace",value:function(e){var t=e.end+(e.end-e.start)/2;return t<this._row.length&&this._matchRange(e.end,t,0)?e:null}},{key:"_findEnd",value:function(){this._row.reverse();var e=this._findPattern(this.STOP_PATTERN);if(this._row.reverse(),null===e)return null;var t=e.start;return e.start=this._row.length-e.end,e.end=this._row.length-t,null!==e?this._verifyTrailingWhitespace(e):null}},{key:"_decodePair",value:function(e){for(var t=[],r=0;r<e.length;r++){var n=this._decodeCode(e[r]);if(!n)return null;t.push(n)}return t}},{key:"_decodeCode",value:function(e){for(var t=this.AVG_CODE_ERROR,r={error:Number.MAX_VALUE,code:-1,start:0,end:0},n=0;n<this.CODE_PATTERN.length;n++){var o=this._matchPattern(e,this.CODE_PATTERN[n]);o<r.error&&(r.code=n,r.error=o)}return r.error<t?r:null}},{key:"_decodePayload",value:function(e,t,r){for(var n=0,o=e.length,i=[[0,0,0,0,0],[0,0,0,0,0]],a=null;n<o;){for(var s=0;s<5;s++)i[0][s]=e[n]*this.barSpaceRatio[0],i[1][s]=e[n+1]*this.barSpaceRatio[1],n+=2;if(!(a=this._decodePair(i)))return null;for(var c=0;c<a.length;c++)t.push(a[c].code+""),r.push(a[c])}return a}},{key:"_verifyCounterLength",value:function(e){return e.length%10==0}},{key:"_decode",value:function(e,t){var r=new Array,n=new Array,o=this._findStart();if(!o)return null;n.push(o);var i=this._findEnd();if(!i)return null;var a=this._fillCounters(o.end,i.start,!1);return this._verifyCounterLength(a)&&this._decodePayload(a,r,n)?r.length%2!=0||r.length<6?null:(n.push(i),{code:r.join(""),start:o.start,end:i.end,startInfo:o,decodedCodes:n,format:this.FORMAT}):null}}]),r}(A);var ue=[3,1,3,1,1,1],le=[3,1,1,1,3],de=[[1,1,3,3,1],[3,1,1,1,3],[1,3,1,1,3],[3,3,1,1,1],[1,1,3,1,3],[3,1,3,1,1],[1,3,3,1,1],[1,1,1,3,3],[3,1,1,3,1],[1,3,1,3,1]],fe=ue.reduce(function(e,t){return e+t},0),he=function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"barSpaceRatio",[1,1]),O()(b()(e),"FORMAT","2of5"),O()(b()(e),"SINGLE_CODE_ERROR",.78),O()(b()(e),"AVG_CODE_ERROR",.3),e}return y()(r,[{key:"_findPattern",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=[],i=0,a={error:Number.MAX_VALUE,code:-1,start:0,end:0},s=0,c=0,u=this.AVG_CODE_ERROR;t||(t=this._nextSet(this._row));for(var l=0;l<e.length;l++)o[l]=0;for(var d=t;d<this._row.length;d++)if(this._row[d]^(r?1:0))o[i]++;else{if(i===o.length-1){s=0;for(var f=0;f<o.length;f++)s+=o[f];if((c=this._matchPattern(o,e))<u)return a.error=c,a.start=d-s,a.end=d,a;if(!n)return null;for(var h=0;h<o.length-2;h++)o[h]=o[h+2];o[o.length-2]=0,o[o.length-1]=0,i--}else i++;o[i]=1,r=!r}return null}},{key:"_findStart",value:function(){for(var e=null,t=this._nextSet(this._row),r=1,n=0;!e;){if(!(e=this._findPattern(ue,t,!1,!0)))return null;if(r=Math.floor((e.end-e.start)/fe),(n=e.start-5*r)>=0&&this._matchRange(n,e.start,0))return e;t=e.end,e=null}return e}},{key:"_verifyTrailingWhitespace",value:function(e){var t=e.end+(e.end-e.start)/2;return t<this._row.length&&this._matchRange(e.end,t,0)?e:null}},{key:"_findEnd",value:function(){this._row.reverse();var e=this._nextSet(this._row),t=this._findPattern(le,e,!1,!0);if(this._row.reverse(),null===t)return null;var r=t.start;return t.start=this._row.length-t.end,t.end=this._row.length-r,null!==t?this._verifyTrailingWhitespace(t):null}},{key:"_verifyCounterLength",value:function(e){return e.length%10==0}},{key:"_decodeCode",value:function(e){for(var t=this.AVG_CODE_ERROR,r={error:Number.MAX_VALUE,code:-1,start:0,end:0},n=0;n<de.length;n++){var o=this._matchPattern(e,de[n]);o<r.error&&(r.code=n,r.error=o)}return r.error<t?r:null}},{key:"_decodePayload",value:function(e,t,r){for(var n=0,o=e.length,i=[0,0,0,0,0],a=null;n<o;){for(var s=0;s<5;s++)i[s]=e[n]*this.barSpaceRatio[0],n+=2;if(!(a=this._decodeCode(i)))return null;t.push("".concat(a.code)),r.push(a)}return a}},{key:"_decode",value:function(e,t){var r=this._findStart();if(!r)return null;var n=this._findEnd();if(!n)return null;var o=this._fillCounters(r.end,n.start,!1);if(!this._verifyCounterLength(o))return null;var i=[];i.push(r);var a=[];return this._decodePayload(o,a,i)?a.length<5?null:(i.push(n),{code:a.join(""),start:r.start,end:n.end,startInfo:r,decodedCodes:i,format:this.FORMAT}):null}}]),r}(A);var pe=new Uint16Array(U()("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%abcd*").map(function(e){return e.charCodeAt(0)})),ge=new Uint16Array([276,328,324,322,296,292,290,336,274,266,424,420,418,404,402,394,360,356,354,308,282,344,332,326,300,278,436,434,428,422,406,410,364,358,310,314,302,468,466,458,366,374,430,294,474,470,306,350]);var me,ye=/[AEIO]/g,ve={code_128_reader:P,ean_reader:N,ean_5_reader:ne,ean_2_reader:te,ean_8_reader:ee,code_39_reader:F,code_39_vin_reader:Y,codabar_reader:Z,upc_reader:K,upc_e_reader:ie,i2of5_reader:ce,"2of5_reader":he,code_93_reader:function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","code_93"),e}return y()(r,[{key:"_patternToChar",value:function(e){for(var t=0;t<ge.length;t++)if(ge[t]===e)return String.fromCharCode(pe[t]);return null}},{key:"_toPattern",value:function(e){for(var t=e.length,r=e.reduce(function(e,t){return e+t},0),n=0,o=0;o<t;o++){var i=Math.round(9*e[o]/r);if(i<1||i>4)return-1;if(0==(1&o))for(var a=0;a<i;a++)n=n<<1|1;else n<<=i}return n}},{key:"_findStart",value:function(){for(var e=this._nextSet(this._row),t=e,r=new Uint16Array([0,0,0,0,0,0]),n=0,o=!1,i=e;i<this._row.length;i++)if(this._row[i]^(o?1:0))r[n]++;else{if(n===r.length-1){if(350===this._toPattern(r)){var a=Math.floor(Math.max(0,t-(i-t)/4));if(this._matchRange(a,t,0))return{start:t,end:i}}t+=r[0]+r[1];for(var s=0;s<4;s++)r[s]=r[s+2];r[4]=0,r[5]=0,n--}else n++;r[n]=1,o=!o}return null}},{key:"_verifyEnd",value:function(e,t){return!(e===t||!this._row[t])}},{key:"_decodeExtended",value:function(e){for(var t=e.length,r=[],n=0;n<t;n++){var o=e[n];if(o>="a"&&o<="d"){if(n>t-2)return null;var i=e[++n],a=i.charCodeAt(0),s=void 0;switch(o){case"a":if(!(i>="A"&&i<="Z"))return null;s=String.fromCharCode(a-64);break;case"b":if(i>="A"&&i<="E")s=String.fromCharCode(a-38);else if(i>="F"&&i<="J")s=String.fromCharCode(a-11);else if(i>="K"&&i<="O")s=String.fromCharCode(a+16);else if(i>="P"&&i<="S")s=String.fromCharCode(a+43);else{if(!(i>="T"&&i<="Z"))return null;s=String.fromCharCode(127)}break;case"c":if(i>="A"&&i<="O")s=String.fromCharCode(a-32);else{if("Z"!==i)return null;s=":"}break;case"d":if(!(i>="A"&&i<="Z"))return null;s=String.fromCharCode(a+32);break;default:return console.warn("* code_93_reader _decodeExtended hit default case, this may be an error",s),null}r.push(s)}else r.push(o)}return r}},{key:"_matchCheckChar",value:function(e,t,r){var n=e.slice(0,t),o=n.length,i=n.reduce(function(e,t,n){return e+((-1*n+(o-1))%r+1)*pe.indexOf(t.charCodeAt(0))},0);return pe[i%47]===e[t].charCodeAt(0)}},{key:"_verifyChecksums",value:function(e){return this._matchCheckChar(e,e.length-2,20)&&this._matchCheckChar(e,e.length-1,15)}},{key:"_decode",value:function(e,t){if(!(t=this._findStart()))return null;var r,n,o=new Uint16Array([0,0,0,0,0,0]),i=[],a=this._nextSet(this._row,t.end);do{o=this._toCounters(a,o);var s=this._toPattern(o);if(s<0)return null;if(null===(n=this._patternToChar(s)))return null;i.push(n),r=a,a+=T.a.sum(o),a=this._nextSet(this._row,a)}while("*"!==n);return i.pop(),i.length&&this._verifyEnd(r,a)&&this._verifyChecksums(i)?(i=i.slice(0,i.length-2),null===(i=this._decodeExtended(i))?null:{code:i.join(""),start:t.start,end:a,startInfo:t,decodedCodes:i,format:this.FORMAT}):null}}]),r}(A),code_32_reader:function(e){_()(r,e);var t=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}();return function(){var r,n=E()(e);if(t){var o=E()(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return R()(this,r)}}(r);function r(){var e;g()(this,r);for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return e=t.call.apply(t,[this].concat(o)),O()(b()(e),"FORMAT","code_32_reader"),e}return y()(r,[{key:"_decodeCode32",value:function(e){if(/[^0-9BCDFGHJKLMNPQRSTUVWXYZ]/.test(e))return null;for(var t=0,r=0;r<e.length;r++)t=32*t+"0123456789BCDFGHJKLMNPQRSTUVWXYZ".indexOf(e[r]);var n=""+t;return n.length<9&&(n=("000000000"+n).slice(-9)),"A"+n}},{key:"_checkChecksum",value:function(e){return!!e}},{key:"_decode",value:function(e,t){var n=V()(E()(r.prototype),"_decode",this).call(this,e,t);if(!n)return null;var o=n.code;if(!o)return null;if(o=o.replace(ye,""),!this._checkChecksum(o))return null;var i=this._decodeCode32(o);return i?(n.code=i,n):null}}]),r}(F)},be={registerReader:function(e,t){ve[e]=t},create:function(e,t){var r={ctx:{frequency:null,pattern:null,overlay:null},dom:{frequency:null,pattern:null,overlay:null}},n=[];function i(){e.readers.forEach(function(e){var t,r={},i=[];"object"===o()(e)?(t=e.format,r=e.config):"string"==typeof e&&(t=e),console.log("Before registering reader: ",t),r.supplements&&(i=r.supplements.map(function(e){return new ve[e]}));try{var a=new ve[t](r,i);n.push(a)}catch(e){throw console.error("* Error constructing reader ",t,e),e}}),console.log("Registered Readers: ".concat(n.map(function(e){return JSON.stringify({format:e.FORMAT,config:e.config})}).join(", ")))}function a(o){var i,a=null,s=f.getBarcodeLine(t,o[0],o[1]);for(e.debug.showFrequency&&(h.a.drawPath(o,{x:"x",y:"y"},r.ctx.overlay,{color:"red",lineWidth:3}),f.debug.printFrequency(s.line,r.dom.frequency)),f.toBinaryLine(s),e.debug.showPattern&&f.debug.printPattern(s.line,r.dom.pattern),i=0;i<n.length&&null===a;i++)a=n[i].decodePattern(s.line);return null===a?null:{codeResult:a,barcodeLine:s}}function s(n){var o,i,s=r.ctx.overlay;e.debug.drawBoundingBox&&s&&h.a.drawPath(n,{x:0,y:1},s,{color:"blue",lineWidth:2});var c=function(e){return Math.sqrt(Math.pow(Math.abs(e[1].y-e[0].y),2)+Math.pow(Math.abs(e[1].x-e[0].x),2))}(o=function(e){return[{x:(e[1][0]-e[0][0])/2+e[0][0],y:(e[1][1]-e[0][1])/2+e[0][1]},{x:(e[3][0]-e[2][0])/2+e[2][0],y:(e[3][1]-e[2][1])/2+e[2][1]}]}(n)),u=Math.atan2(o[1].y-o[0].y,o[1].x-o[0].x);return null===(o=function(e,r,n){function o(t){var n=t*Math.sin(r),o=t*Math.cos(r);e[0].y-=n,e[0].x-=o,e[1].y+=n,e[1].x+=o}for(o(n);n>1&&(!t.inImageWithBorder(e[0])||!t.inImageWithBorder(e[1]));)o(-(n-=Math.ceil(n/2)));return e}(o,u,Math.floor(.1*c)))?null:(null===(i=a(o))&&(i=function(e,t,r){var n,o,i,s=Math.sqrt(Math.pow(e[1][0]-e[0][0],2)+Math.pow(e[1][1]-e[0][1],2)),c=null,u=Math.sin(r),l=Math.cos(r);for(n=1;n<16&&null===c;n++)i={y:(o=s/16*n*(n%2==0?-1:1))*u,x:o*l},t[0].y+=i.x,t[0].x-=i.y,t[1].y+=i.x,t[1].x-=i.y,c=a(t);return c}(n,o,u)),null===i?null:(i&&e.debug.drawScanline&&s&&h.a.drawPath(o,{x:"x",y:"y"},s,{color:"red",lineWidth:3}),{codeResult:i.codeResult,line:o,angle:u,pattern:i.barcodeLine.line,threshold:i.barcodeLine.threshold}))}return function(){if("undefined"!=typeof document){var e=document.querySelector("#debug.detection");r.dom.frequency=document.querySelector("canvas.frequency"),r.dom.frequency||(r.dom.frequency=document.createElement("canvas"),r.dom.frequency.className="frequency",e&&e.appendChild(r.dom.frequency)),r.ctx.frequency=r.dom.frequency.getContext("2d"),r.dom.pattern=document.querySelector("canvas.patternBuffer"),r.dom.pattern||(r.dom.pattern=document.createElement("canvas"),r.dom.pattern.className="patternBuffer",e&&e.appendChild(r.dom.pattern)),r.ctx.pattern=r.dom.pattern.getContext("2d"),r.dom.overlay=document.querySelector("canvas.drawingBuffer"),r.dom.overlay&&(r.ctx.overlay=r.dom.overlay.getContext("2d"))}}(),i(),function(){if("undefined"!=typeof document){var t,n=[{node:r.dom.frequency,prop:e.debug.showFrequency},{node:r.dom.pattern,prop:e.debug.showPattern}];for(t=0;t<n.length;t++)!0===n[t].prop?n[t].node.style.display="block":n[t].node.style.display="none"}}(),{decodeFromBoundingBox:function(e){return s(e)},decodeFromBoundingBoxes:function(t){var r,n,o=[],i=e.multiple;for(r=0;r<t.length;r++){var a=t[r];if((n=s(a)||{}).box=a,i)o.push(n);else if(n.codeResult)return n}if(i)return{barcodes:o}},decodeFromImage:function(e){return function(e){for(var t=null,r=0;r<n.length&&null===t;r++)t=n[r].decodeImage?n[r].decodeImage(e):null;return t}(e)},registerReader:function(e,t){if(ve[e])throw new Error("cannot register existing reader",e);ve[e]=t},setReaders:function(t){e.readers=t,n.length=0,i()}}}},we=function(){var e={};function t(t){return e[t]||(e[t]={subscribers:[]}),e[t]}function r(e,t){e.async?setTimeout(function(){e.callback(t)},4):e.callback(t)}function n(e,r,n){var o;if("function"==typeof r)o={callback:r,async:n};else if(!(o=r).callback)throw new Error("Callback was not specified on options");t(e).subscribers.push(o)}return{subscribe:function(e,t,r){return n(e,t,r)},publish:function(e,n){var o=t(e),i=o.subscribers;i.filter(function(e){return!!e.once}).forEach(function(e){r(e,n)}),o.subscribers=i.filter(function(e){return!e.once}),o.subscribers.forEach(function(e){r(e,n)})},once:function(e,t){n(e,{callback:t,async:arguments.length>2&&void 0!==arguments[2]&&arguments[2],once:!0})},unsubscribe:function(r,n){if(r){var o=t(r);o.subscribers=o&&n?o.subscribers.filter(function(e){return e.callback!==n}):[]}else e={}}}}(),_e=r(12),Se=r.n(_e),Re=r(20),xe=r.n(Re),Ee=r(84),Ce=r.n(Ee),Oe="This may mean that the user has declined camera access, or the browser does not support media APIs. If you are running in iOS, you must use Safari.";function Te(){try{return navigator.mediaDevices.enumerateDevices()}catch(t){var e=new Error("enumerateDevices is not defined. ".concat(Oe));return e.code=-1,Promise.reject(e)}}function Ae(e){try{return navigator.mediaDevices.getUserMedia(e)}catch(e){var t=new Error("getUserMedia is not defined. ".concat(Oe));return t.code=-1,Promise.reject(t)}}function Pe(e){return new Promise(function(t,r){var n=10;!function o(){n>0?e.videoWidth>10&&e.videoHeight>10?(console.log("* dev: checkVideo found ".concat(e.videoWidth,"px x ").concat(e.videoHeight,"px")),t()):window.setTimeout(o,500):r(new Error("Unable to play video stream. Is webcam working?")),n--}()})}function De(e,t){return function(){return xe()(Se.a.mark(function e(t,r){var n;return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Ae(r);case 2:if(n=e.sent,me=n,!t){e.next=11;break}return t.setAttribute("autoplay","true"),t.setAttribute("muted","true"),t.setAttribute("playsinline","true"),t.srcObject=n,t.addEventListener("loadedmetadata",function(){t.play()}),e.abrupt("return",Pe(t));case 11:return e.abrupt("return",Promise.resolve());case 12:case"end":return e.stop()}},e)})).apply(this,arguments)}.apply(this,arguments)}function Ie(){var e=function(e){var t=Ce()(e,["width","height","facingMode","aspectRatio","deviceId"]);return void 0!==e.minAspectRatio&&e.minAspectRatio>0&&(t.aspectRatio=e.minAspectRatio,console.log("WARNING: Constraint 'minAspectRatio' is deprecated; Use 'aspectRatio' instead")),void 0!==e.facing&&(t.facingMode=e.facing,console.log("WARNING: Constraint 'facing' is deprecated. Use 'facingMode' instead'")),t}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{});return e&&e.deviceId&&e.facingMode&&delete e.facingMode,Promise.resolve({audio:!1,video:e})}function ke(){return(ke=xe()(Se.a.mark(function e(){var t;return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Te();case 2:return t=e.sent,e.abrupt("return",t.filter(function(e){return"videoinput"===e.kind}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Me(){if(!me)return null;var e=me.getVideoTracks();return e&&null!=e&&e.length?e[0]:null}var Le={requestedVideoElement:null,request:function(e,t){return xe()(Se.a.mark(function r(){var n;return Se.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return Le.requestedVideoElement=e,r.next=3,Ie(t);case 3:return n=r.sent,r.abrupt("return",De(e,n));case 5:case"end":return r.stop()}},r)}))()},release:function(){var e=me&&me.getVideoTracks();return null!==Le.requestedVideoElement&&Le.requestedVideoElement.pause(),new Promise(function(t){setTimeout(function(){e&&e.length&&e[0].stop(),me=null,Le.requestedVideoElement=null,t()},0)})},enumerateVideoDevices:function(){return ke.apply(this,arguments)},getActiveStreamLabel:function(){var e=Me();return e?e.label:""},getActiveTrack:Me},qe=Le,je={create:function(e){var t,r=document.createElement("canvas"),n=r.getContext("2d"),o=[],i=null!==(t=e.capacity)&&void 0!==t?t:20,a=!0===e.capture;function s(t){return!!i&&t&&!function(e,t){return t&&t.some(function(t){return Object.keys(t).every(function(r){return t[r]===e[r]})})}(t,e.blacklist)&&function(e,t){return"function"!=typeof t||t(e)}(t,e.filter)}return{addResult:function(e,t,c){var u={};s(c)&&(i--,u.codeResult=c,a&&(r.width=t.x,r.height=t.y,h.a.drawImage(e,t,n),u.frame=r.toDataURL()),o.push(u))},getResults:function(){return o}}}},Ne={inputStream:{name:"Live",type:"LiveStream",constraints:{width:640,height:480,facingMode:"environment"},area:{top:"0%",right:"0%",left:"0%",bottom:"0%"},singleChannel:!1},locate:!0,numOfWorkers:0,decoder:{readers:["code_128_reader"],debug:{drawBoundingBox:!1,showFrequency:!1,drawScanline:!1,showPattern:!1}},locator:{halfSample:!0,patchSize:"medium",debug:{showCanvas:!1,showPatches:!1,showFoundPatches:!1,showSkeleton:!1,showLabels:!1,showPatchLabels:!1,showRemainingPatchLabels:!1,boxFromPatches:{showTransformed:!1,showTransformedBox:!1,showBB:!1}}}},We=r(7),Ue=function e(){g()(this,e),O()(this,"config",void 0),O()(this,"inputStream",void 0),O()(this,"framegrabber",void 0),O()(this,"inputImageWrapper",void 0),O()(this,"stopped",!1),O()(this,"boxSize",void 0),O()(this,"resultCollector",void 0),O()(this,"decoder",void 0),O()(this,"workerPool",[]),O()(this,"onUIThread",!0),O()(this,"canvasContainer",new ze)},Be=function e(){g()(this,e),O()(this,"image",void 0),O()(this,"overlay",void 0)},ze=function e(){g()(this,e),O()(this,"ctx",void 0),O()(this,"dom",void 0),this.ctx=new Be,this.dom=new Be},Fe=r(23);function $e(e){if("undefined"==typeof document)return null;if(e instanceof HTMLElement&&e.nodeName&&1===e.nodeType)return e;var t="string"==typeof e?e:"#interactive.viewport";return document.querySelector(t)}function Ve(e,t){var r=function(e,t){var r=document.querySelector(e);return r||((r=document.createElement("canvas")).className=t),r}(e,t),n=r.getContext("2d");return{canvas:r,context:n}}var Ge={274:"orientation"},He=Object.keys(Ge).map(function(e){return Ge[e]});function Ye(e){return new Promise(function(t){var r=new FileReader;r.onload=function(e){return t(e.target.result)},r.readAsArrayBuffer(e)})}function Xe(e,t,r){if("Exif"!==function(e,t,r){for(var n="",o=t;o<t+4;o++)n+=String.fromCharCode(e.getUint8(o));return n}(e,t))return!1;var n,o=t+6;if(18761===e.getUint16(o))n=!1;else{if(19789!==e.getUint16(o))return!1;n=!0}if(42!==e.getUint16(o+2,!n))return!1;var i=e.getUint32(o+4,!n);return!(i<8)&&function(e,t,r,n,o){for(var i=e.getUint16(r,!o),a={},s=0;s<i;s++){var c=r+12*s+2,u=n[e.getUint16(c,!o)];u&&(a[u]=Je(e,c,t,r,o))}return a}(e,o,o+i,r,n)}function Je(e,t,r,n,o){var i=e.getUint16(t+2,!o),a=e.getUint32(t+4,!o);switch(i){case 3:if(1===a)return e.getUint16(t+8,!o)}return null}var Qe={};function Ze(e,t){e.onload=function(){t.loaded(this)}}Qe.load=function(e,t,r,n,o){var i,a,s,c=new Array(n),u=new Array(c.length);if(!1===o)c[0]=e;else for(i=0;i<c.length;i++)s=r+i,c[i]="".concat(e,"image-").concat("00".concat(s).slice(-3),".jpg");for(u.notLoaded=[],u.addImage=function(e){u.notLoaded.push(e)},u.loaded=function(r){for(var n=u.notLoaded,i=0;i<n.length;i++)if(n[i]===r){n.splice(i,1);for(var a=0;a<c.length;a++){var s=c[a].substr(c[a].lastIndexOf("/"));if(-1!==r.src.lastIndexOf(s)){u[a]={img:r};break}}break}0===n.length&&(console.log("Images loaded"),!1===o?function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:He;return/^blob:/i.test(e)?(t=e,new Promise(function(e,r){var n=new XMLHttpRequest;n.open("GET",t,!0),n.responseType="blob",n.onreadystatechange=function(){n.readyState!==XMLHttpRequest.DONE||200!==n.status&&0!==n.status||e(this.response)},n.onerror=r,n.send()})).then(Ye).then(function(e){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:He,r=new DataView(e),n=e.byteLength,o=t.reduce(function(e,t){var r=Object.keys(Ge).filter(function(e){return Ge[e]===t})[0];return r&&(e[r]=t),e},{}),i=2;if(255!==r.getUint8(0)||216!==r.getUint8(1))return!1;for(;i<n;){if(255!==r.getUint8(i))return!1;if(225===r.getUint8(i+1))return Xe(r,i+4,o);i+=2+r.getUint16(i+2)}return!1}(e,r)}):Promise.resolve(null)}(e,["orientation"]).then(function(e){u[0].tags=e,t(u)}).catch(function(e){console.log(e),t(u)}):t(u))},i=0;i<c.length;i++)a=new Image,u.addImage(a),Ze(a,u),a.src=c[i]};var Ke=Qe,et={createVideoStream:function(e){var t,r,n=null,o=["canrecord","ended"],i={},a={x:0,y:0,type:"Point"},s={x:0,y:0,type:"XYSize"},c={getRealWidth:function(){return e.videoWidth},getRealHeight:function(){return e.videoHeight},getWidth:function(){return t},getHeight:function(){return r},setWidth:function(e){t=e},setHeight:function(e){r=e},setInputStream:function(e){n=e,this.setAttribute("src",void 0!==e.src?e.src:"")},ended:function(){return e.ended},getConfig:function(){return n},setAttribute:function(t,r){e&&e.setAttribute(t,r)},pause:function(){e.pause()},play:function(){e.play()},setCurrentTime:function(e){var t;"LiveStream"!==(null===(t=n)||void 0===t?void 0:t.type)&&this.setAttribute("currentTime",e.toString())},addEventListener:function(t,r,n){-1!==o.indexOf(t)?(i[t]||(i[t]=[]),i[t].push(r)):e.addEventListener(t,r,n)},clearEventHandlers:function(){o.forEach(function(t){var r=i[t];r&&r.length>0&&r.forEach(function(r){e.removeEventListener(t,r)})})},trigger:function(o,a){var u,l,d,f,h,p=i[o];if("canrecord"===o&&(f=e.videoWidth,h=e.videoHeight,t=null!==(l=n)&&void 0!==l&&l.size?f/h>1?n.size:Math.floor(f/h*n.size):f,r=null!==(d=n)&&void 0!==d&&d.size?f/h>1?Math.floor(h/f*n.size):n.size:h,s.x=t,s.y=r),p&&p.length>0)for(u=0;u<p.length;u++)p[u].apply(c,a)},setTopRight:function(e){a.x=e.x,a.y=e.y},getTopRight:function(){return a},setCanvasSize:function(e){s.x=e.x,s.y=e.y},getCanvasSize:function(){return s},getFrame:function(){return e}};return c},createLiveStream:function(e){e&&e.setAttribute("autoplay","true");var t=et.createVideoStream(e);return t.ended=function(){return!1},t},createImageStream:function(){var e,t,r=null,n=0,o=0,i=0,a=!0,s=!1,c=null,u=0,l=null,d=!1,f=["canrecord","ended"],h={},p={x:0,y:0,type:"Point"},g={x:0,y:0,type:"XYSize"};function m(e,t){var r,n=h[e];if(n&&n.length>0)for(r=0;r<n.length;r++)n[r].apply(y,t)}var y={trigger:m,getWidth:function(){return e},getHeight:function(){return t},setWidth:function(t){e=t},setHeight:function(e){t=e},getRealWidth:function(){return n},getRealHeight:function(){return o},setInputStream:function(a){var d;r=a,!1===a.sequence?(l=a.src,u=1):(l=a.src,u=a.length),s=!1,Ke.load(l,function(a){var u,l;if(c=a,a[0].tags&&a[0].tags.orientation)switch(a[0].tags.orientation){case 6:case 8:n=a[0].img.height,o=a[0].img.width;break;default:n=a[0].img.width,o=a[0].img.height}else n=a[0].img.width,o=a[0].img.height;e=null!==(u=r)&&void 0!==u&&u.size?n/o>1?r.size:Math.floor(n/o*r.size):n,t=null!==(l=r)&&void 0!==l&&l.size?n/o>1?Math.floor(o/n*r.size):r.size:o,g.x=e,g.y=t,s=!0,i=0,setTimeout(function(){m("canrecord",[])},0)},1,u,null===(d=r)||void 0===d?void 0:d.sequence)},ended:function(){return d},setAttribute:function(){},getConfig:function(){return r},pause:function(){a=!0},play:function(){a=!1},setCurrentTime:function(e){i=e},addEventListener:function(e,t){-1!==f.indexOf(e)&&(h[e]||(h[e]=[]),h[e].push(t))},clearEventHandlers:function(){Object.keys(h).forEach(function(e){return delete h[e]})},setTopRight:function(e){p.x=e.x,p.y=e.y},getTopRight:function(){return p},setCanvasSize:function(e){g.x=e.x,g.y=e.y},getCanvasSize:function(){return g},getFrame:function(){var e,t;return s?(a||(e=null===(t=c)||void 0===t?void 0:t[i],i<u-1?i++:setTimeout(function(){d=!0,m("ended",[])},0)),e):null}};return y}},tt=et,rt=r(8),nt=Math.PI/180,ot={create:function(e,t){var r,n={},o=e.getConfig(),i=Object(rt.h)(e.getRealWidth(),e.getRealHeight()),a=e.getCanvasSize(),s=Object(rt.h)(e.getWidth(),e.getHeight()),c=e.getTopRight(),u=c.x,l=c.y,d=null,f=null;return(r=t||document.createElement("canvas")).width=a.x,r.height=a.y,d=r.getContext("2d"),f=new Uint8Array(s.x*s.y),console.log("FrameGrabber",JSON.stringify({size:s,topRight:c,videoSize:i,canvasSize:a})),n.attachData=function(e){f=e},n.getData=function(){return f},n.grab=function(){var t,n,i,c=o.halfSample,h=e.getFrame(),p=h,g=0;if(p){if(i=a,(n=r).width!==i.x&&(console.log("WARNING: canvas-size needs to be adjusted"),n.width=i.x),n.height!==i.y&&(console.log("WARNING: canvas-size needs to be adjusted"),n.height=i.y),"ImageStream"===o.type&&(p=h.img,h.tags&&h.tags.orientation))switch(h.tags.orientation){case 6:g=90*nt;break;case 8:g=-90*nt}return 0!==g?(d.translate(a.x/2,a.y/2),d.rotate(g),d.drawImage(p,-a.y/2,-a.x/2,a.y,a.x),d.rotate(-g),d.translate(-a.x/2,-a.y/2)):d.drawImage(p,0,0,a.x,a.y),t=d.getImageData(u,l,s.x,s.y).data,c?Object(rt.e)(t,s,f):Object(rt.c)(t,f,o),!0}return!1},n.getSize=function(){return s},n}},it=ot;function at(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function st(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?at(Object(r),!0).forEach(function(t){O()(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):at(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}var ct=[];function ut(e){return st(st({},e),{},{inputStream:st(st({},e.inputStream),{},{target:null})})}function lt(e){if(e){var t=e().default;if(!t)return void self.postMessage({event:"error",message:"Quagga could not be created"})}var r;function n(e){self.postMessage({event:"processed",imageData:r.data,result:e},[r.data.buffer])}function o(){self.postMessage({event:"initialized",imageData:r.data},[r.data.buffer])}self.onmessage=function(e){if("init"===e.data.cmd){var i=e.data.config;i.numOfWorkers=0,r=new t.ImageWrapper({x:e.data.size.x,y:e.data.size.y},new Uint8Array(e.data.imageData)),t.init(i,o,r),t.onProcessed(n)}else"process"===e.data.cmd?(r.data=new Uint8Array(e.data.imageData),t.start()):"setReaders"===e.data.cmd?t.setReaders(e.data.readers):"registerReader"===e.data.cmd&&t.registerReader(e.data.name,e.data.reader)}}function dt(e,t,r){var n,o,i=("undefined"!=typeof __factorySource__&&(o=__factorySource__),n=new Blob(["("+lt.toString()+")("+o+");"],{type:"text/javascript"}),window.URL.createObjectURL(n)),a={worker:new Worker(i),imageData:new Uint8Array(t.getWidth()*t.getHeight()),busy:!0};a.worker.onmessage=function(e){"initialized"===e.data.event?(URL.revokeObjectURL(i),a.busy=!1,a.imageData=new Uint8Array(e.data.imageData),console.log("Worker initialized"),r(a)):"processed"===e.data.event?(a.imageData=new Uint8Array(e.data.imageData),a.busy=!1):"error"===e.data.event&&console.log("Worker error: "+e.data.message)},a.worker.postMessage({cmd:"init",size:{x:t.getWidth(),y:t.getHeight()},imageData:a.imageData,config:ut(e)},[a.imageData.buffer])}function ft(e,t,r,n){var o=e-ct.length;if(0===o&&n)n();else if(o<0)ct.slice(o).forEach(function(e){e.worker.terminate(),console.log("Worker terminated!")}),ct=ct.slice(0,o),n&&n();else{var i=function(t){ct.push(t),ct.length>=e&&n&&n()};if(t)for(var a=0;a<o;a++)dt(t,r,i)}}function ht(e,t,r){for(var n=e.length;n--;)e[n][0]+=t,e[n][1]+=r}var pt=function(){function e(){var t=this;g()(this,e),O()(this,"context",new Ue),O()(this,"canRecord",function(e){var r;t.context.config&&(Fe.a.checkImageConstraints(t.context.inputStream,null===(r=t.context.config)||void 0===r?void 0:r.locator),t.initCanvas(),t.context.framegrabber=it.create(t.context.inputStream,t.context.canvasContainer.dom.image),void 0===t.context.config.numOfWorkers&&(t.context.config.numOfWorkers=0),ft(t.context.config.numOfWorkers,t.context.config,t.context.inputStream,function(){var r;0===(null===(r=t.context.config)||void 0===r?void 0:r.numOfWorkers)&&t.initializeData(),t.ready(e)}))}),O()(this,"update",function(){if(t.context.onUIThread){var e,r=(o=t.context.framegrabber,ct.length?!!(i=ct.filter(function(e){return!e.busy})[0])&&(o.attachData(i.imageData),o.grab()&&(i.busy=!0,i.worker.postMessage({cmd:"process",imageData:i.imageData},[i.imageData.buffer])),!0):null);r||(t.context.framegrabber.attachData(null===(e=t.context.inputImageWrapper)||void 0===e?void 0:e.data),t.context.framegrabber.grab()&&(r||t.locateAndDecode()))}else{var n;t.context.framegrabber.attachData(null===(n=t.context.inputImageWrapper)||void 0===n?void 0:n.data),t.context.framegrabber.grab(),t.locateAndDecode()}var o,i})}return y()(e,[{key:"initBuffers",value:function(e){if(this.context.config){var t=function(e,t,r){var n=t||new s.a({x:e.getWidth(),y:e.getHeight(),type:"XYSize"});console.log("image wrapper size ".concat(n.size));var o=[Object(We.clone)([0,0]),Object(We.clone)([0,n.size.y]),Object(We.clone)([n.size.x,n.size.y]),Object(We.clone)([n.size.x,0])];return Fe.a.init(n,r),{inputImageWrapper:n,boxSize:o}}(this.context.inputStream,e,this.context.config.locator),r=t.inputImageWrapper,n=t.boxSize;this.context.inputImageWrapper=r,this.context.boxSize=n}}},{key:"initializeData",value:function(e){this.context.config&&(this.initBuffers(e),this.context.decoder=be.create(this.context.config.decoder,this.context.inputImageWrapper))}},{key:"getViewPort",value:function(){return this.context.config&&this.context.config.inputStream?$e(this.context.config.inputStream.target):null}},{key:"ready",value:function(e){this.context.inputStream.play(),e()}},{key:"initCanvas",value:function(){var e=function(e){var t,r,n,o,i=$e(null==e?void 0:null===(t=e.config)||void 0===t?void 0:null===(r=t.inputStream)||void 0===r?void 0:r.target),a=null==e?void 0:null===(n=e.config)||void 0===n?void 0:null===(o=n.inputStream)||void 0===o?void 0:o.type;if(!a)return null;var s=function(e){if("undefined"!=typeof document){var t=Ve("canvas.imgBuffer","imgBuffer"),r=Ve("canvas.drawingBuffer","drawingBuffer");return t.canvas.width=r.canvas.width=e.x,t.canvas.height=r.canvas.height=e.y,{dom:{image:t.canvas,overlay:r.canvas},ctx:{image:t.context,overlay:r.context}}}return null}(e.inputStream.getCanvasSize());if(!s)return{dom:{image:null,overlay:null},ctx:{image:null,overlay:null}};var c=s.dom;return"undefined"!=typeof document&&i&&("ImageStream"!==a||i.contains(c.image)||i.appendChild(c.image),i.contains(c.overlay)||i.appendChild(c.overlay)),s}(this.context);if(e){var t=e.ctx,r=e.dom;this.context.canvasContainer.dom.image=r.image,this.context.canvasContainer.dom.overlay=r.overlay,this.context.canvasContainer.ctx.image=t.image,this.context.canvasContainer.ctx.overlay=t.overlay}}},{key:"initInputStream",value:function(e){if(this.context.config&&this.context.config.inputStream){var t=this.context.config.inputStream,r=t.type,n=t.constraints,o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"LiveStream",t=arguments.length>1?arguments[1]:void 0,r=arguments.length>2?arguments[2]:void 0;switch(e){case"VideoStream":var n=document.createElement("video");return{video:n,inputStream:r.createVideoStream(n)};case"ImageStream":return{inputStream:r.createImageStream()};case"LiveStream":var o=null;return t&&((o=t.querySelector("video"))||(o=document.createElement("video"),t.appendChild(o))),{video:o,inputStream:r.createLiveStream(o)};default:return console.error("* setupInputStream invalid type ".concat(e)),{video:null,inputStream:null}}}(r,this.getViewPort(),tt),i=o.video,a=o.inputStream;"LiveStream"===r&&i&&qe.request(i,n).then(function(){return a.trigger("canrecord")}).catch(function(t){return e(t)}),a.setAttribute("preload","auto"),a.setInputStream(this.context.config.inputStream),a.addEventListener("canrecord",this.canRecord.bind(void 0,e)),this.context.inputStream=a}}},{key:"getBoundingBoxes",value:function(){var e;return null!==(e=this.context.config)&&void 0!==e&&e.locate?Fe.a.locate():[[Object(We.clone)(this.context.boxSize[0]),Object(We.clone)(this.context.boxSize[1]),Object(We.clone)(this.context.boxSize[2]),Object(We.clone)(this.context.boxSize[3])]]}},{key:"transformResult",value:function(e){var t=this,r=this.context.inputStream.getTopRight(),n=r.x,o=r.y;if((0!==n||0!==o)&&(e.barcodes&&e.barcodes.forEach(function(e){return t.transformResult(e)}),e.line&&2===e.line.length&&function(e,t,r){e[0].x+=t,e[0].y+=r,e[1].x+=t,e[1].y+=r}(e.line,n,o),e.box&&ht(e.box,n,o),e.boxes&&e.boxes.length>0))for(var i=0;i<e.boxes.length;i++)ht(e.boxes[i],n,o)}},{key:"addResult",value:function(e,t){var r=this;t&&this.context.resultCollector&&(e.barcodes?e.barcodes.filter(function(e){return e.codeResult}).forEach(function(e){return r.addResult(e,t)}):e.codeResult&&this.context.resultCollector.addResult(t,this.context.inputStream.getCanvasSize(),e.codeResult))}},{key:"hasCodeResult",value:function(e){return!!(e&&(e.barcodes?e.barcodes.some(function(e){return e.codeResult}):e.codeResult))}},{key:"publishResult",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,r=e;e&&this.context.onUIThread&&(this.transformResult(e),this.addResult(e,t),r=e.barcodes||e),we.publish("processed",r),this.hasCodeResult(e)&&we.publish("detected",r)}},{key:"locateAndDecode",value:function(){var e=this.getBoundingBoxes();if(e){var t,r=this.context.decoder.decodeFromBoundingBoxes(e)||{};r.boxes=e,this.publishResult(r,null===(t=this.context.inputImageWrapper)||void 0===t?void 0:t.data)}else{var n,o=this.context.decoder.decodeFromImage(this.context.inputImageWrapper);o?this.publishResult(o,null===(n=this.context.inputImageWrapper)||void 0===n?void 0:n.data):this.publishResult()}}},{key:"startContinuousUpdate",value:function(){var e,t=this,r=null,n=1e3/((null===(e=this.context.config)||void 0===e?void 0:e.frequency)||60);this.context.stopped=!1;var o=this.context;!function e(i){r=r||i,o.stopped||(i>=r&&(r+=n,t.update()),window.requestAnimationFrame(e))}(performance.now())}},{key:"start",value:function(){var e,t;this.context.onUIThread&&"LiveStream"===(null===(e=this.context.config)||void 0===e?void 0:null===(t=e.inputStream)||void 0===t?void 0:t.type)?this.startContinuousUpdate():this.update()}},{key:"stop",value:function(){var e=xe()(Se.a.mark(function e(){var t;return Se.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.context.stopped=!0,ft(0),null===(t=this.context.config)||void 0===t||!t.inputStream||"LiveStream"!==this.context.config.inputStream.type){e.next=6;break}return e.next=5,qe.release();case 5:this.context.inputStream.clearEventHandlers();case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setReaders",value:function(e){this.context.decoder&&this.context.decoder.setReaders(e),function(e){ct.forEach(function(t){return t.worker.postMessage({cmd:"setReaders",readers:e})})}(e)}},{key:"registerReader",value:function(e,t){be.registerReader(e,t),this.context.decoder&&this.context.decoder.registerReader(e,t),function(e,t){ct.forEach(function(r){return r.worker.postMessage({cmd:"registerReader",name:e,reader:t})})}(e,t)}}]),e}(),gt=new pt,mt=gt.context,yt={init:function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:gt;return t||(n=new Promise(function(e,r){t=function(t){t?r(t):e()}})),o.context.config=a()({},Ne,e),o.context.config.numOfWorkers>0&&(o.context.config.numOfWorkers=0),r?(o.context.onUIThread=!1,o.initializeData(r),t&&t()):o.initInputStream(t),n},start:function(){return gt.start()},stop:function(){return gt.stop()},pause:function(){mt.stopped=!0},onDetected:function(e){e&&("function"==typeof e||"object"===o()(e)&&e.callback)?we.subscribe("detected",e):console.trace("* warning: Quagga.onDetected called with invalid callback, ignoring")},offDetected:function(e){we.unsubscribe("detected",e)},onProcessed:function(e){e&&("function"==typeof e||"object"===o()(e)&&e.callback)?we.subscribe("processed",e):console.trace("* warning: Quagga.onProcessed called with invalid callback, ignoring")},offProcessed:function(e){we.unsubscribe("processed",e)},setReaders:function(e){e?gt.setReaders(e):console.trace("* warning: Quagga.setReaders called with no readers, ignoring")},registerReader:function(e,t){e?t?gt.registerReader(e,t):console.trace("* warning: Quagga.registerReader called with no reader, ignoring"):console.trace("* warning: Quagga.registerReader called with no name, ignoring")},registerResultCollector:function(e){e&&"function"==typeof e.addResult&&(mt.resultCollector=e)},get canvas(){return mt.canvasContainer},decodeSingle:function(e,t){var r=this,n=new pt;return(e=a()({inputStream:{type:"ImageStream",sequence:!1,size:800,src:e.src},numOfWorkers:e.debug?0:1,locator:{halfSample:!1}},e)).numOfWorkers>0&&(e.numOfWorkers=0),e.numOfWorkers>0&&("undefined"==typeof Blob||"undefined"==typeof Worker)&&(console.warn("* no Worker and/or Blob support - forcing numOfWorkers to 0"),e.numOfWorkers=0),new Promise(function(o,i){try{r.init(e,function(){we.once("processed",function(e){n.stop(),t&&t.call(null,e),o(e)},!0),n.start()},null,n)}catch(e){i(e)}})},get default(){return yt},BarcodeReader:A,CameraAccess:qe,ImageDebug:h.a,ImageWrapper:s.a,ResultCollector:je};t.default=yt}]).default})},{buffer:"dskh"}],dfhR:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.default=void 0;var n=function(e){return e&&e.__esModule?e:{default:e}}(e("./quagga.js"));class o{constructor(){this.lastResult=null}async init(e){this.target=e.inputStream.target,await new Promise((t,r)=>{n.default.init(e,e=>{if(e)return console.log("BARCODE: Init error: "+e),void r(e);console.log("BARCODE: Init finished"),t()})})}async start(){await this.stop(),n.default.start(),this.callbackDetected=this.detected.bind(this),n.default.onDetected(this.callbackDetected),this.callbackProcessed=null,this.callbackProcessed&&n.default.onProcessed(this.callbackProcessed),this.started=!0}detected(e){e.codeResult&&e.codeResult.code&&(this.lastResult=e.codeResult.code,console.log("BARCODE: Detected: "+this.lastResult+" -- "+JSON.stringify(e.codeResult)),this.promiseScanCancelResolve&&this.promiseScanCancelResolve(this.lastResult),this.promiseScanCancelResolve=null,this.promiseScanCancelReject=null)}processed(e){}async stop(){this.callbackDetected&&(n.default.offDetected(this.callbackDetected),this.callbackDetected=null),this.callbackProcessed&&(n.default.offProcessed(this.callbackProcessed),this.callbackProcessed=null),this.started&&(await n.default.stop(),this.started=!1);const e=this.promiseScanCancelResolve;this.lastResult=null,this.promiseScanCancelResolve=null,this.promiseScanCancelReject=null,e&&e(this.lastResult)}async waitForScanOrCancel(){return new Promise((e,t)=>{this.promiseScanCancelResolve=e,this.promiseScanCancelReject=t})}}r.default=o,o.instance=null,o.cancel=async()=>{o.instance&&await o.instance.stop()},o.scan=async e=>{const t=e&&e.elementSelector?e.elementSelector:"#interactive.viewport";o.instance||(o.instance=new o);const r={inputStream:{name:"Live",type:"LiveStream",constraints:{facingMode:"environment"},target:document.querySelector(t)},decoder:{readers:["code_128_reader"],debug:!1}},n={code_128:"code_128_reader",ean:"ean_reader",ean_8:"ean_8_reader",code_39:"code_39_reader",code_39_vin:"code_39_vin_reader",codabar:"codabar_reader",upc:"upc_reader",upc_e:"upc_e_reader",i2of5:"i2of5_reader","2of5":"2of5_reader",code_93:"code_93_reader"},i=(e&&e.readers?e.readers:"code_128").split(",");if(i.length>0){r.decoder.readers=[];for(const e of i){const t=n[e];if(!t)throw new Exception("Unknown barcode type: "+e);r.decoder.readers.push(t)}}let a=null;try{await o.instance.init(r),await o.instance.start(),a=await o.instance.waitForScanOrCancel()}finally{await o.instance.stop(),document.querySelector(t).innerHTML=""}return a}},{"./quagga.js":"g3U2"}],jOUA:[function(e,t,r){"use strict";var n=e("./util.mjs"),o=c(e("./key_input.mjs")),i=c(e("./device_manager.mjs")),a=c(e("./barcode.mjs")),s=e("./cwa_parse.mjs");function c(e){return e&&e.__esModule?e:{default:e}}window.addEventListener("error",function(e){return document.getElementById("warnings").appendChild(document.createTextNode("⚠️ Unhandled error.")),console.log("ERROR: Unhandled error: "+(e.error&&e.error.message?e.error.message:e.error)),console.log(JSON.stringify(e)),!1}),window.addEventListener("unhandledrejection",function(e){return document.getElementById("warnings").appendChild(document.createTextNode("⚠️ Unhandled promise rejection.")),console.log("ERROR: Unhandled rejection: "+(e.error&&e.error.message?e.error.message:e.error)),console.log(JSON.stringify(e)),!1});let u={},l=!1,d=!1,f=!0,h=!0,p=null,g=!1;function m(){g||((0,n.redirectConsole)("#output"),g=!0),d&&document.querySelector("body").classList.toggle("console",l)}(0,n.watchParameters)(x),l&&m(),"serviceWorker"in navigator&&window.addEventListener("load",async function(){try{const e="service-worker.js",t=await navigator.serviceWorker.register(e);t.onupdatefound=function(){const e=t.installing;e.onstatechange=function(){switch(e.state){case"installed":navigator.serviceWorker.controller?(console.log("SERVICEWORKER: New content available."),confirm("[ServiceWorker] Update available -- reload now?")&&window.location.reload()):console.log("SERVICEWORKER: Now available offline.");break;case"redundant":console.log("SERVICEWORKER: Installing worker was redundant.")}}}}catch(e){console.log("SERVICEWORKER: Error during registration: "+e)}}),window.applicationCache&&applicationCache.addEventListener("updateready",function(){confirm("[AppCache] Update available -- reload now?")&&window.location.reload()});let y=null,v={},b=!1,w=null,_=null,S=!0,R="code_128";function x(e=u){if(u=e,console.log("PARAMS: "+JSON.stringify(e)),void 0!==e.nodebug&&(l=!1),void 0!==e.debug&&(l=!0),l&&m(),void 0!==e.allowserial&&(h=!0),void 0!==e.noserial&&(h=!1),void 0!==e.allowusb&&(f=!0),void 0!==e.nousb&&(f=!1),!d)return;let t=!1;void 0!==e.editable&&(t=!1),void 0!==e.readonly&&(t=!0);for(let e of["#session","#rate","#range","#gyro","#start","#delay","#duration","#stop","#metadata","#minbattery"]){const r=document.querySelector(e);t?r.setAttribute("disabled","true"):r.removeAttribute("disabled")}let r=!0;void 0!==e.details&&(r=!0),void 0!==e.nodetails&&(r=!1),r?document.querySelector("#details").setAttribute("open","true"):document.querySelector("#details").removeAttribute("open");const n={session:null,rate:100,range:8,gyro:0,start:0,stop:168,metadata:""};let o=!1;for(let t of["session","rate","range","gyro","start","stop","metadata","minbattery"])void 0!==e[t]&&(n[t]=e[t]),o|=typeof n[t]!=typeof v[t]||n[t]==v[t];o?(v=n,console.log("PARAMS: Config changed: "+JSON.stringify(n)),E(n)):console.log("PARAMS: Config not changed: "+JSON.stringify(n)),e.config&&_.setValue(e.config),void 0!==e.focus&&(document.querySelector("#code").select(),document.querySelector("#code").focus()),W(document.querySelector("#code").value),document.querySelector("#add_usb_device").setAttribute("style",f?"display: inline;":"display: none;"),document.querySelector("#add_serial_device").setAttribute("style",h?"display: inline;":"display: none;"),navigator.serial||document.querySelector("#add_serial_device").setAttribute("style","display: none;"),document.querySelector("body").classList.toggle("nolog",void 0!==e.nolog),document.querySelector("body").classList.toggle("nologclear",void 0!==e.nologclear),document.querySelector("body").classList.toggle("no-configure",void 0!==e.noconfigure),void 0!==e.diagnostics&&document.querySelector("body").classList.add("diagnostics-open"),document.querySelector("#add_usb_device").setAttribute("style",f?"display: inline;":"display: none;");let i=!0;void 0!==e.noscan&&(i=!1),void 0!==e.scan&&(i=!0),document.querySelector("body").classList.toggle("allow-scan",i),void 0!==e.readers&&(R=e.readers),void 0!==e.autosubmit&&(S=!0),void 0!==e.noautosubmit&&(S=!1),_.setAutoSubmit(S);let a=null;void 0!==e.title&&(a=e.title),a||(a="AX Configure"),document.querySelector("title").innerText=a,document.querySelector("#title").innerText=a}const E=e=>{document.querySelector("#session").value=void 0!==e.session?e.session:"",document.querySelector("#rate").value=void 0!==e.rate?e.rate:"",document.querySelector("#range").value=void 0!==e.range?e.range:"",document.querySelector("#gyro").value=void 0!==e.gyro?e.gyro:"",document.querySelector("#minbattery").value=void 0!==e.minbattery?e.minbattery:"";let t=P(e.start);t?(document.querySelector("#start").value=(0,n.localTimeString)(t,"m")||"",k()):(document.querySelector("#delay").value=e.start||0===e.start?e.start:"",M());let r=D(e.stop,(0,n.localTimeValue)(document.querySelector("#start").value));document.querySelector("#stop").value=null===r?document.querySelector("#start").value:(0,n.localTimeString)(r,"m")||"",L(),document.querySelector("#metadata").value=void 0!==e.metadata?e.metadata:"",C()};const C=()=>{let e=null;try{const t=function(e){const t=[],r=new Date;e.stop.getTime()<r?t.push("Recording interval has already finished."):e.start.getTime()+66e3<r?t.push("Recording interval has already started."):e.start.getTime(),e.start.getTime()>r+18144e5&&t.push("Start time is a long time in the future.");const n=(e.stop.getTime()-e.start.getTime())/1e3;return n<=0&&t.push("Start/stop times do not make an interval."),n*e.rate>158714880&&t.push("Duration is too long (for this rate)."),[6,6.25,12,12.5,25,50,100,200,400,800,1600,3200].includes(e.rate)||t.push("Rate is not valid."),t}(e=j());t&&t.length>0?N("WARNING: "+t.join("; "),!0):N("",!1),console.log("CONFIG-VALID: true"),document.querySelector("body").classList.add("config-valid")}catch(e){N(e,!0),console.log("CONFIG-VALID: false"),document.querySelector("body").classList.remove("config-valid")}const t=e&&!!y&&!F;_.submitEnabled(t)};function O(){const e=document.querySelector("body").classList.contains("running-diagnostic"),t=document.querySelector("body").classList.contains("device-connected"),r=document.querySelector("#diagnostic-text").value.startsWith("{");console.log("DIAGNOSTICS: Update with device: "+t+" and diagnostic: "+r),t&&!e?(document.querySelector("#diagnostic-run").removeAttribute("disabled"),document.querySelector("#diagnostic-data-download").removeAttribute("disabled"),document.querySelector("#diagnostic-reset").removeAttribute("disabled")):(document.querySelector("#diagnostic-run").setAttribute("disabled","true"),document.querySelector("#diagnostic-data-download").setAttribute("disabled","true"),document.querySelector("#diagnostic-reset").setAttribute("disabled","true")),r?(document.querySelector("#diagnostic-copy").removeAttribute("disabled"),document.querySelector("#diagnostic-download").removeAttribute("disabled")):(document.querySelector("#diagnostic-copy").setAttribute("disabled","true"),document.querySelector("#diagnostic-download").setAttribute("disabled","true"))}const T=()=>{let e={deviceType:null,deviceId:"-",battery:"-",state:null,errorState:null};(y=w.getSingleDevice())?(e.deviceId=y.serial||(y.status&&y.status.id&&y.status.id.deviceId?y.status.id.deviceId:"-"),y.status&&y.status.id&&y.status.id.deviceType?e.deviceType=y.status.id.deviceType:y.deviceType&&(e.deviceType=y.deviceType),null!==y.status.battery&&(e.battery=y.status.battery.percent),e.state=y.status.state,e.errorState=y.status.errorState,document.querySelector("body").classList.add("device-connected")):document.querySelector("body").classList.remove("device-connected"),O(),document.querySelector("#device-id").value=e.deviceId+(e.deviceType?" ["+e.deviceType+"]":""),document.querySelector("#battery-meter").value=Number.isNaN(parseInt(e.battery))?0:parseInt(e.battery),document.querySelector("#battery").value=Number.isNaN(parseInt(e.battery))?"-":e.battery+"%",document.querySelector("#state").value=e.state||e.errorState||"-",y&&y.status&&y.status.recordingStarted?document.querySelector("#configure").value="⚠️ Delete device data and reconfigure":y&&y.status&&y.status.recordingConfigured?document.querySelector("#configure").value="🔁 Reconfigure":document.querySelector("#configure").value="Configure",C()},A=async()=>{if(Y(),y=w.getSingleDevice()){console.log("DEVICECHANGED: "+(y.serial?y.serial:"<no serial>")),y.setStatusHandler(T),console.log("DEVICECHANGED: updateStatus...");try{await y.updateStatus(),console.log("STATUS: "+JSON.stringify(y.status))}catch(e){console.log("DEVICECHANGED: ERROR: "+JSON.stringify(e))}}else console.log("DEVICECHANGED: (none)"),b&&(b=!1,B(!0,!0)),await T()},P=e=>{if(!e&&0!==e)return null;if(e&&"[object Date]"===Object.prototype.toString.call(e)&&!isNaN(e))return e;if(/\d\d\d\d-\d\d-\d\d[T ]\d\d:\d\d:\d\d(?:\.\d\d\d)?Z?/.test(e))try{let t;if("Z"==e[e.length-1])t=new Date(e);else{const r=e.split(/\D/).map(e=>parseInt(e));r[1]=r[1]-1,t=new Date(...r)}return t}catch(t){console.log("ERROR: Problem parsing date: "+e)}return null},D=(e,t,r=36e5)=>{if(!e&&0!==e)return null;return P(e)||(t=t||0===t?t:new Date,new Date(t.getTime()+parseFloat(e)*r))},I=()=>""===document.querySelector("#duration").value?null:60*parseFloat(document.querySelector("#duration").value)*60*1e3,k=()=>{(0,n.localTimeValue)(document.querySelector("#start").value),document.querySelector("#delay").value="",q()},M=(e=null)=>{Number(e)===e&&(document.querySelector("#delay").value=e);const t=document.querySelector("#delay").value;if(""!==t.trim()){const e=new Date,r=60*parseFloat(t)*60*1e3;let o;if(r>=0)o=new Date(e.getTime()+r);else{const t=new Date(new Date(e).setHours(0,0,0,0));o=new Date(t.getTime()+-r)}const i=document.querySelector("#start"),a=(0,n.localTimeString)(o,"m");i.value!=a&&(i.value=a,q())}},L=()=>{const e=(0,n.localTimeValue)(document.querySelector("#start").value),t=(0,n.localTimeValue)(document.querySelector("#stop").value);if(null===t||null===e)return void(document.querySelector("#duration").value="");const r=(t.getTime()-e.getTime())/1e3/60/60;document.querySelector("#duration").value=r},q=e=>{if(Number(e)===e){const t=e/1e3/60/60;document.querySelector("#duration").value=t}const t=(0,n.localTimeValue)(document.querySelector("#start").value);if(t){const e=I(),r=new Date(t.getTime()+e);document.querySelector("#stop").value=(0,n.localTimeString)(r,"m")}else document.querySelector("#stop").value=document.querySelector("#start").value},j=()=>{const e={session:""==document.querySelector("#session").value?null:parseInt(document.querySelector("#session").value),rate:parseFloat(document.querySelector("#rate").value),range:parseInt(document.querySelector("#range").value),gyro:parseInt(document.querySelector("#gyro").value),start:(0,n.localTimeValue)(document.querySelector("#start").value),stop:(0,n.localTimeValue)(document.querySelector("#stop").value),metadata:document.querySelector("#metadata").value,minbattery:""==document.querySelector("#minbattery").value?null:parseInt(document.querySelector("#minbattery").value)},t=[];if(("number"!=typeof e.session||isNaN(e.session))&&t.push("session ID not specified"),"object"==typeof e.start&&e.start||t.push("start time not specified"),"object"==typeof e.stop&&e.stop||t.push("stop time not specified"),I()<=0&&t.push("start and stop times do not make a valid interval"),t.length>0)throw"Cannot configure: "+t.join(", ")+".";return e},N=(e,t=!1)=>{document.querySelector("#result").value=t?"⚠️ "+e:e},W=e=>{console.log("CODE: "+e);const t=e.trim().length>0?parseInt("0"+e.replace(/[^0-9]/g,"").slice(-9)):"";document.querySelector("#session").value=t,document.querySelector("#metadata").value=((e,t,r)=>{e.length>0&&"?"==e[0]&&(e=e.slice(1));const n=e.split("&"),o=[];let i=!1;for(let e of n){const n=e.indexOf("="),a=decodeURIComponent(n>=0?e.slice(0,n):e).replace(/\+/g," ");a.length<=0||(a==t?i||(i=!0,null!==r&&o.push(encodeURIComponent(a)+"="+encodeURIComponent(r))):o.push(e))}return i||null===r||o.push(encodeURIComponent(t)+"="+encodeURIComponent(r)),o.join("&")})(document.querySelector("#metadata").value,"_sc",0==e.length?null:e),C()},U=(e,t)=>{let r=[];r.push((0,n.localTimeString)(t.time,"S")),r.push(e),r.push(t.deviceId),r.push(t.session),r.push((0,n.localTimeString)(t.start,"S")),r.push((0,n.localTimeString)(t.stop,"S")),r.push(t.rate),r.push(t.range),r.push('"'+t.metadata.replace(/\"/g,'""')+'"');const o=((e,t)=>{e.length>0&&"?"==e[0]&&(e=e.slice(1));const r=e.split("&");for(let e of r){const r=e.indexOf("="),n=decodeURIComponent(r>=0?e.slice(0,r):e).replace(/\+/g," ");if(!(n.length<=0)&&n==t)return decodeURIComponent(r>=0?e.slice(r+1):"").replace(/\+/g," ")}return null})(t.metadata,"_sc");r.push(t.gyro),r.push('"'+o+'"');const i=r.join(","),a="LOG_"+(new Date).toISOString().slice(0,10).replace(/[^0-9]/g,"");console.log("LOG: "+i),localStorage.setItem(a,(localStorage.getItem(a)||"")+i+"\r\n")},B=(e,t)=>{document.querySelector("body").classList.remove("completed"),b=!1,e&&_.setValue(""),t&&void 0!==u.focus&&(document.querySelector("#code").select(),document.querySelector("#code").focus()),W(document.querySelector("#code").value)},z=()=>{(async()=>{try{console.log("BARCODE: Cancel: Awaiting..."),await a.default.cancel()}catch(e){console.error("BARCODE: Error during cancellation: "+e)}})()};let F=!1;const $=async()=>{if(F)N("(device busy)",!0);else try{document.querySelector("body").classList.add("configuring"),F=!0,z(),document.querySelector("#configure").setAttribute("disabled","true"),document.querySelector("#start-scan").setAttribute("disabled","true"),document.querySelector("#stop-scan").setAttribute("disabled","true"),N("Configuring...",!1);const e=j();console.log(JSON.stringify(e,null,4));try{const t=await y.configure(e);console.log("CONFIG-STATUS: "+JSON.stringify(t));let r="???";y.status&&y.status.id&&y.status.id.deviceType?r=y.status.id.deviceType:y.deviceType&&(r=y.deviceType);const n=((e,t)=>{const r=["minbattery"],n=[];for(let o of Object.keys(e))r.includes(o)||(!o in t?(console.log(`ERROR: Configuration key not found: ${o}`),n.push([{[o]:e[o]},null])):e[o]!=t[o]&&(console.log(`ERROR: Configuration value not matched for '${o}': ${e[o]} != ${t[o]}.`),n.push([{[o]:e[o]},{[o]:t[o]}])));return n})(e,t);0==n.length?(N("ℹ️ Configured",!1),document.querySelector("body").classList.add("completed"),U(r+"-CONFIG-OK",t),b=!0):(N("ℹ️ Configured but mismatched: "+JSON.stringify(n),!0),U(r+"-CONFIG-FAILURE",e))}catch(t){let r="???";y.status&&y.status.id&&y.status.id.deviceType?r=y.status.id.deviceType:y.deviceType&&(r=y.deviceType),console.log("CONFIG-ERROR: "+JSON.stringify(t)),U(r+"-CONFIG-ERROR",e),N(t,!0)}}catch(e){console.log("CONFIGURATION: "+e),N(e,!0)}finally{document.querySelector("body").classList.remove("configuring"),F=!1,document.querySelector("#configure").removeAttribute("disabled"),document.querySelector("#start-scan").removeAttribute("disabled"),document.querySelector("#stop-scan").removeAttribute("disabled")}};let V=null,G=new Date;function H(e,t=null){V=t,G=new Date,document.querySelector(".diagnostic-fieldset legend").innerText="Diagnostic Report"+(V?": "+V:"");const r=e?JSON.stringify(e,null,4):"";console.dir(e);const n=document.querySelector("#diagnostic-text");n.value=r,n.focus(),n.select(),n.scrollTo(0,0),document.querySelector("body").classList.add("diagnostics-open"),O()}function Y(){H(null,null),document.querySelector("#diagnostic-file").value="",void 0===u.diagnostics&&document.querySelector("body").classList.remove("diagnostics-open")}function X(e,t){console.log("FILE-DIAGNOSTICS: ("+t.byteLength+" bytes) -- "+e);const r={};if(r.version=p,r.errors=[],r.time=new Date,r.file={filename:e,length:t.byteLength,source:"file"},t.byteLength>=512)try{r.header=(0,s.parseHeader)(new DataView(t.buffer,0,512))}catch(e){console.dir(e),r.errors.push("Could not parse header: "+JSON.stringify(e))}if(t.byteLength>=1536)try{r.first=(0,s.parseData)(new DataView(t.buffer,1024,512))}catch(e){console.dir(e),r.errors.push("Could not parse first data: "+JSON.stringify(e))}if(t.byteLength>=2048)try{r.last=(0,s.parseData)(new DataView(t.buffer,t.byteLength-512,512))}catch(e){console.dir(e),r.errors.push("Could not parse last data: "+JSON.stringify(e))}H(r,e)}window.addEventListener("DOMContentLoaded",async e=>{d=!0,p=document.querySelector("#version").textContent.split(/[ ]/)[0].trim(),document.querySelector(".version").textContent=p,w=new i.default(f,h),_=new o.default("#code"),await T(),_.start(W,$);for(let e of w.warnings)document.getElementById("warnings").appendChild(document.createTextNode("⚠️ "+e));w.startup(A);const t=document.querySelector("#reconfigure");function r(e){const t=new FileReader;t.onload=async function(t){X(e.name,new Uint8Array(t.target.result))},t.readAsArrayBuffer(e)}t&&t.addEventListener("click",async()=>{B(!1,!0)}),document.querySelector("#configure_new").addEventListener("click",async()=>{B(!0,!0)}),document.querySelector("#add_usb_device").addEventListener("click",async()=>{try{await w.userAddUsbDevice()}catch(e){N(e,!0)}}),document.querySelector("#add_serial_device").addEventListener("click",async()=>{try{await w.userAddSerialDevice()}catch(e){N(e,!0)}}),document.querySelector("#diagnostics-toggle").addEventListener("click",e=>{e.preventDefault(),document.querySelector("body").classList.contains("diagnostics-open")?Y():H(null,null)}),document.querySelector("#diagnostic-run").addEventListener("click",async()=>{try{if(document.querySelector("body").classList.add("running-diagnostic"),O(),y){let e=await y.runDiagnostic();const t=e&&e.id&&e.id.deviceId?e.id.deviceId:"unknown";H(e={version:p,...e},t)}}catch(e){N(e,!0)}finally{document.querySelector("body").classList.remove("running-diagnostic"),O()}}),document.querySelector("#diagnostic-data-download").addEventListener("click",async()=>{function e(e){if(!e)return"-";let t="";return e>=3600&&(t=t+Math.floor(e/60/60)+"h",e-=60*Math.floor(e/60/60)*60),e>=60&&(t=t+Math.floor(e/60)+"m",e-=60*Math.floor(e/60)),t+Math.floor(e)+"s"}const t="Experimental, slow, data download...";try{if(document.querySelector("body").classList.add("running-diagnostic"),!y)throw new Error("No device");window.confirm("Run experimental (very slow) data download from device?")&&(y.updateState(t+" - starting..."),await y.runDownload(r=>{console.log(JSON.stringify(r)),y.updateState(t+" - "+(100*r.proportion).toFixed(3)+"%, after "+e(r.elapsed)+", remaining "+e(r.estimatedRemaining)+".")}),y.updateState(t+" - complete!"))}catch(e){y.updateState(t+" - error"),N("Download error: "+JSON.stringify(e),!0)}finally{document.querySelector("body").classList.remove("running-diagnostic"),O()}}),document.querySelector("#diagnostic-reset").addEventListener("click",async()=>{try{if(document.querySelector("body").classList.add("running-diagnostic"),H("",null),y){const e="CAUTION: You want to DELETE ALL DATA from this device and RESET the device?";if(!window.confirm(e))throw"Reset cancelled";const t="WIPE and RESET the device now?  (Enter ID from device case to reset the device ID, or leave blank to keep the current ID)",r=window.prompt(t,"");if(null===r)throw"Reset cancelled";if(""!==r){const e=parseInt(r);if(e!=r||e<0||e>4294967295)throw"Invalid ID: "+r}await y.runReset(r),H("Device reset"+(r?": "+r:""),null)}}catch(e){N(e,!0)}finally{document.querySelector("body").classList.remove("running-diagnostic"),O()}}),document.querySelector("#diagnostic-copy").addEventListener("click",async()=>{const e=document.querySelector("#diagnostic-text");"clipboard"in navigator?navigator.clipboard.writeText(e.value):(e.focus(),e.select(),e.scrollTo(0,0),document.execCommand("copy"))}),document.querySelector("#diagnostic-download").addEventListener("click",async()=>{const e="diagnostic_"+G.toISOString().replace(/[^0-9]/g,"").substring(0,14)+(V?"_"+V:"")+".txt",t=document.querySelector("#diagnostic-text").value;(0,n.download)(e,t,"text/plain")}),document.querySelector("#diagnostic-file").addEventListener("change",function(e){r(e.target.files[0])}),document.body.addEventListener("dragover",function(e){document.querySelector("body").classList.contains("diagnostics-open")&&e.preventDefault()}),document.body.addEventListener("drop",function(e){if(document.querySelector("body").classList.contains("diagnostics-open")&&e.dataTransfer.files&&e.dataTransfer.files.length>0){e.preventDefault();const t=e.dataTransfer.files[0];document.querySelector("#diagnostic-file").files=e.dataTransfer.files,r(t)}});for(let e of["#delay"]){const t=document.querySelector(e);t.addEventListener("change",M),t.addEventListener("input",M)}for(let e of["#start"]){const t=document.querySelector(e);t.addEventListener("change",k),t.addEventListener("input",k)}for(let e of["#duration"]){const t=document.querySelector(e);t.addEventListener("change",q),t.addEventListener("input",q)}for(let e of["#stop"]){const t=document.querySelector(e);t.addEventListener("change",L),t.addEventListener("input",L)}for(let e of["#session","#rate","#range","#gyro","#delay","#start","#duration","#stop","#metadata","#minbattery"]){const t=document.querySelector(e);t.addEventListener("change",C),t.addEventListener("input",C),t.addEventListener("propertychange",C)}E({session:null,rate:100,range:8,start:0,stop:null,metadata:""}),navigator.usb||document.querySelector("#add_usb_device").setAttribute("disabled","true"),navigator.serial||document.querySelector("#add_serial_device").setAttribute("disabled","true"),document.querySelector("#reset").addEventListener("click",e=>{B(!0,!0),location.reload()}),document.querySelector("#log-download").addEventListener("click",e=>{e.preventDefault();try{const t=Object.keys(localStorage).filter(e=>e.startsWith("LOG_")).sort().map(e=>localStorage.getItem(e)).join(""),r="log_"+(new Date).toISOString().replace(/[^0-9]/g,"")+".csv";(0,n.download)(r,t,"text/csv;charset=utf-8")}catch(e){console.log(e)}}),document.querySelector("#log-clear").addEventListener("click",e=>{e.preventDefault();let t=!1;{const e=prompt("DESTROY data by deleting and clearing all of the configuration logs?  Type DESTROY in capitals to confirm.");null!=e&&("DESTROY"===e?t=!0:alert("Did not delete logs"))}if(t)try{(()=>{const e=Object.keys(localStorage).filter(e=>e.startsWith("LOG_"));for(let t of e)localStorage.removeItem(t)})()}catch(e){console.log(e)}}),document.querySelector("#start-scan").addEventListener("click",async()=>{try{document.querySelector("body").classList.add("scanning");const e=await a.default.scan({readers:R});null!=e?(console.log("SCAN: Result="+e),_.setValue(e)):console.log("SCAN: No result.")}catch(e){console.log("SCAN: Error="+JSON.stringify(e)),N(e,!0)}finally{document.querySelector("body").classList.remove("scanning")}}),document.querySelector("#stop-scan").addEventListener("click",z),x(),setInterval(()=>{M(),w.refreshDevices()},5e3)})},{"./util.mjs":"x7XL","./key_input.mjs":"yzmp","./device_manager.mjs":"bqdr","./barcode.mjs":"dfhR","./cwa_parse.mjs":"bBqM"}]},{},["jOUA"]);</script></head><body> <div class="main"> <header> <h1 id="title">AX Configure</h1> <div id="warnings"><ul> <noscript>⚠️ Scripting not enabled.</noscript> </ul></div> </header> <main> <form> <div class="complete"> <div class="status">✅ Configured &mdash; please disconnect device.</div> <div class="main_button">Reconfigure: <input id="configure_new" class="button link" type="button" value="Afresh" title="New Configuration"> <input id="reconfigure" class="button link" type="button" value="Same" title="Repeat Same Configuration"> </div> </div> <div class="incomplete"> <fieldset> <legend>Configuration</legend> <div id="interactive" class="viewport"></div> <div> <label accesskey="C" for="code">Code: </label> <input id="code" type="text" placeholder="..."> <div class="scan-controls"> <button class="button" type="button" id="start-scan" title="Scan">𝄃𝄀𝄁𝄂</button> <button class="button" type="button" id="stop-scan" title="Cancel Scan">×</button> </div> </div> <details id="details" open> <summary>Details</summary> <div><label for="session">Session ID: </label><input id="session" type="number" placeholder="(none)"></div> <div><label for="rate">Rate: </label> <select id="rate" placeholder=""> <option value="3200">3200 Hz</option> <option value="1600">1600 Hz</option> <option value="800">800 Hz</option> <option value="400">400 Hz</option> <option value="200">200 Hz</option> <option value="100" selected>100 Hz</option> <option value="50">50 Hz</option> <option value="25">25 Hz</option> <option value="12.5">12.5 Hz</option> </select> </div> <div><label for="range">Range: </label> <select id="range" placeholder=""> <option value="16">&PlusMinus;16&#x1D454;</option> <option value="8" selected>&PlusMinus;8&#x1D454;</option> <option value="4">&PlusMinus;4&#x1D454;</option> <option value="2">&PlusMinus;2&#x1D454;</option> </select> </div> <div><label for="gyro">Gyro: </label> <select id="gyro" placeholder=""> <option value="2000">2000 &deg;&#x2215;s</option> <option value="1000">1000 &deg;&#x2215;s</option> <option value="500">500 &deg;&#x2215;s</option> <option value="250">250 &deg;&#x2215;s</option> <option value="0" selected>(none)</option> </select> </div> <div><label for="metadata">Metadata: </label><input id="metadata" type="text" placeholder="(none)"></div> <div><label for="delay">Delay (h): </label><input id="delay" type="number" min="0" placeholder="(hours)" step="any"></div> <div><label for="start">Start: </label><input id="start" type="datetime-local"></div> <div><label for="duration">Duration (h): </label><input id="duration" type="number" min="0" placeholder="(hours)" step="any"></div> <div><label for="stop">Stop: </label><input id="stop" type="datetime-local"></div> <div class="hidden"><label for="minbattery">Min.Batt.: </label><input id="minbattery" type="number" min="0" max="101" placeholder="(%)" step="1"></div> </details> <div><output id="result" value="-"></output></div> </fieldset> </div> <div class="disconnected"> <div class="main_button"> <input class="button" id="add_serial_device" type="button" value="&#x1F517; Connect serial device..." title="Connect to a USB device over its serial interface"> <input class="secondary" id="add_usb_device" type="button" value="&#x1F517; Alternative connect device..." title="Attempt to connect to a USB device directly"> </div> </div> <div class="connected"> <fieldset class="device-fieldset"> <legend>Device</legend> <span class="device-status"> <div><label for="device-id">Id: </label><output id="device-id">-</output></div> <div><label for="battery">Battery: </label><meter id="battery-meter" min="0" max="100" low="30" high="85" optimum="100" value="0"></meter> <output id="battery">-</output></div> <div><label for="state">State: </label><output id="state">-</output></div> </span> </fieldset> </div> <div class="diagnostics"> <fieldset class="diagnostic-fieldset"> <legend>Diagnostic Report</legend> <div class="diagnostic-controls"> <button class="button" type="button" id="diagnostic-run" title="Run Diagnostic on Device">&#x1F5B4; Device Diagnostics</button> <label id="diagnostic-file-selection"> File Diagnostics: <input type="file" class="button" id="diagnostic-file" accept=".cwa" title="Run Diagnostic on Downloaded File"> </label> <button class="secondary" type="button" id="diagnostic-data-download" title="(Experimental, Slow) Data Download">&#x21E9;</button> <button class="secondary" type="button" id="diagnostic-reset" title="Wipe and Reset Device">&#x26A0; Reset</button> </div> <textarea id="diagnostic-text" readonly></textarea> <div class="diagnostic-controls"> <button class="button" type="button" id="diagnostic-copy" title="Copy report to clipboard">&#x2398; Copy Report</button> <button class="button" type="button" id="diagnostic-download" title="Download report">&#x21E9; Download Report</button> </div> </fieldset> </div> <div class="incomplete"> <div class="connected-valid"> <div class="main_button"><input id="configure" class="button" type="submit" value="Configure"></div> </div> </div> </form> </main> <footer> <div> <a href="https://github.com/digitalinteraction/openmovement-axconfig/blob/master/README.md" title="openmovement-axconfig project">ℹ️ Help</a> | <a id="reset" href="#">&#x21BA; Refresh</a> <span class="log-span">| <a id="log-download" href="">&#x21E9; Download Config Log</a> <span class="log-clear-span">| <a id="log-clear" href="">&#x239A; Clear Config Log</a></span> </span> | <a id="diagnostics-toggle" href="#">&#x1F5B3; Diagnostics</a> | <span class="version">-</span> </div> </footer> </div> <output id="output">-</output> </body></html><script type="text/plain" id="version" style="display:none;">
v2024-07-16-13-56-14